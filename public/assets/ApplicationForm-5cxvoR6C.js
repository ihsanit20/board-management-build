import{N as W,r as D,I as M,o as ee,i as te,c as n,a as t,t as r,b as c,y as _,j as u,v,n as ae,p as O,K as G,J as w,F as b,e as g,h as x,l as se,d as o,s as le}from"./index-4YhllknO.js";import{u as ie}from"./application-C4zhPOV1.js";import{u as ne}from"./institute-TdumZPEo.js";import{u as oe}from"./area-CwbiDrub.js";import{u as de}from"./zamat-jOZQWl1Y.js";import{u as re}from"./group-CK3_obeA.js";import{u as ue}from"./center-BLle967Z.js";import{u as pe}from"./fee-Cj_FcQVp.js";function ce(C=new Date,S="YYYY-MM-DD"){const i=C.getFullYear(),h=String(C.getMonth()+1).padStart(2,"0"),k=String(C.getDate()).padStart(2,"0");return S==="YYYY-MM-DD"?`${i}-${h}-${k}`:S==="DD-MM-YYYY"?`${k}-${h}-${i}`:S==="MM-DD-YYYY"?`${h}-${k}-${i}`:`${i}-${h}-${k}`}const me={class:"mx-4"},_e={class:"md:p-8 p-4 card-bg space-y-2"},ve={class:"flex gap-4 justify-center items-center"},fe={class:"flex flex-col items-center space-y-2"},be={class:"title-xl"},ge={class:"flex flex-wrap gap-2 text-center"},ye={class:"md:text-base text-sm"},xe={class:"flex justify-center items-center"},he={class:"flex gap-2 justify-center items-center bg-gray-100 p-4 rounded-lg"},ke={class:"text-red-500"},Ve={class:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-md"},De={class:"col-start-1"},Se=["max"],$e={class:""},Ue=["value"],Ye=["disabled"],Me=["value"],we=["label"],Ce=["value"],ze=["disabled"],je=["value"],Be={key:0},qe=["disabled"],Fe=["value"],Ie={class:"space-y-2"},Ae={class:"grid md:grid-cols-12 gap-4 border rounded p-2"},Ee={class:"flex items-center justify-center"},Ke={class:"text-lg font-semibold mb-2 px-3 py-1 bg-gray-100 rounded-full"},Le={class:"md:col-span-2 grid gap-2"},Ne=["onUpdate:modelValue"],Oe=["onUpdate:modelValue"],Ge={class:"md:col-span-2 grid gap-2"},Te=["onUpdate:modelValue"],Je=["onUpdate:modelValue"],Re={class:"md:col-span-2"},Xe={class:"flex relative"},Ze={key:0,class:"absolute left-2 top-3"},He=["onUpdate:modelValue","onBlur","onKeyup"],Pe=["onChange","onUpdate:modelValue"],Qe={class:"md:col-span-2"},We=["onUpdate:modelValue"],et={class:"md:col-span-2"},tt=["onUpdate:modelValue"],at={class:"flex justify-end md:justify-center items-start"},st=["onClick"],lt={key:0,class:"flex flex-col items-center space-y-2"},it={class:"flex flex-col items-center"},nt={class:"text-xl text-green-600"},ot=["disabled"],dt={class:"flex justify-center"},rt={key:0,class:"text-xl text-green-600"},ut={key:1,class:"text-xl text-red-600"},yt={__name:"ApplicationForm",setup(C){const S=le(),i=W(),h=pe(),k=ie(),V=ne(),F=ue(),E=oe(),K=de(),I=re(),z=D(!1),$=D(""),j=D(""),B=D(""),U=D(""),A=new Date().toISOString().split("T")[0],l=D({application_date:A,exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""}],payment_method:"Offline",total_amount:0}),T=async()=>{var s;V.institutes=[],I.groups=[],F.centers=[],h.fee={},await i.fetchLastExam(),l.value.exam_id=(s=i==null?void 0:i.exam)==null?void 0:s.id,await E.fetchAreas(),await K.fetchZamats()};M(()=>l.value.area_id,async s=>{s&&await V.fetchInstitutes({area_id:s,per_page:"all"})}),M(()=>l.value.zamat_id,async s=>{s&&(l.value.group_id="",await I.fetchGroups(s))}),M(()=>l.value.zamat_id,async s=>{s&&L()}),M(()=>l.value.group_id,async s=>{s&&L()}),M(B,()=>{U.value=""});const L=async()=>{F.fetchCenters({zamat_id:l.value.zamat_id,group_id:l.value.group_id,gender:l.value.gender})};ee(T);const J=()=>{l.value.students.push({registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""})},R=s=>{confirm("ডিলিট নিশ্চিত করুন")&&l.value.students.splice(s,1)},X=()=>{l.value={application_date:A,exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",input_dob:"",date_of_birth:"",para:"",address:""}],payment_method:"Offline",total_amount:0}},Z=async()=>{var s,e;z.value=!0,$.value="",j.value="";try{l.value.total_amount=q.value*(((e=(s=l==null?void 0:l.value)==null?void 0:s.students)==null?void 0:e.length)||0),await k.createApplication(l.value),j.value="আপনার নিবন্ধন সফলভাবে জমা হয়েছে।",X(),S.push("/applications")}catch{$.value="নিবন্ধন জমা দিতে ব্যর্থ হয়েছে।"}finally{z.value=!1}},H=s=>{$.value=s},q=te(()=>{var m,f,y,Y;let s=parseInt(((m=i==null?void 0:i.exam)==null?void 0:m.registration_fee)||0);const e=ce(new Date(l.value.application_date));return e>((f=i==null?void 0:i.exam)==null?void 0:f.reg_final_date)?(H("নিবন্ধন গ্রহণ বন্ধ রয়েছে"),s=0):(e>((y=i==null?void 0:i.exam)==null?void 0:y.reg_last_date)&&(s+=parseInt(((Y=i==null?void 0:i.exam)==null?void 0:Y.late_fee)||0)),s)}),P=async()=>{l.value.area_id="",l.value.institute_id="",V.institutes=[],U.value="";const s=await V.findInstituteByCode(B.value);s?(V.institutes[0]=s,l.value.area_id=s.area_id,l.value.institute_id=s.id):U.value="খুঁজে পাওয়া যায় নি!"},N=s=>{if(/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/.test(s.input_dob)){const[m,f,y]=s.input_dob.split("/");s.date_of_birth=`${y}-${f}-${m}`}else s.date_of_birth="",s.input_dob=""},Q=s=>{if(s.date_of_birth&&/^\d{4}-\d{2}-\d{2}$/.test(s.date_of_birth)){const[e,m,f]=s.date_of_birth.split("-");s.input_dob=`${f}/${m}/${e}`}else s.input_dob=""};return(s,e)=>{var m,f,y,Y;return o(),n("div",me,[t("div",_e,[t("div",ve,[t("div",fe,[t("h2",be,r((f=(m=c(i))==null?void 0:m.exam)==null?void 0:f.name),1),t("div",ge,[t("p",ye,[e[11]||(e[11]=_(" নিবন্ধনের শেষ তারিখ ")),t("b",null,r(new Date((y=c(i).exam)==null?void 0:y.reg_last_date).toLocaleDateString("bn-BD")),1),e[12]||(e[12]=_(" ইং। বিলম্ব ফি সহ নিবন্ধনের চূড়ান্ত তারিখ ")),t("b",null,r(new Date((Y=c(i).exam)==null?void 0:Y.reg_final_date).toLocaleDateString("bn-BD")),1),e[13]||(e[13]=_(" ইং। "))])]),e[14]||(e[14]=t("div",{class:"px-6 bg-sky-700 rounded-full pt-1"},[t("h2",{class:"title-lg text-white"},"নিবন্ধন পত্র")],-1))])]),t("div",xe,[t("div",he,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>B.value=a),type:"search",class:ae(["input-1 text-center",{"border-red-500":!!U.value}]),placeholder:"ইলহাক নাম্বার"},null,2),[[v,B.value]]),t("div",ke,r(U.value),1),t("button",{onClick:P,type:"button",class:"btn-2"},e[15]||(e[15]=[t("i",{class:"fas fa-search"},null,-1),_(" খুঁজুন ")]))])]),t("form",{onSubmit:O(Z,["prevent"]),onKeydown:e[10]||(e[10]=G(O(()=>{},["prevent"]),["enter"])),class:"space-y-4"},[t("div",Ve,[t("div",De,[e[16]||(e[16]=t("label",{class:"block text-gray-700"},"আবেদনের তারিখ",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.application_date=a),type:"date",class:"input-1",max:c(A)},null,8,Se),[[v,l.value.application_date]])]),t("div",$e,[e[18]||(e[18]=t("label",{class:"block text-gray-700"},"অঞ্চল নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.area_id=a),class:"input-1"},[e[17]||(e[17]=t("option",{value:"",disabled:""},"Select Area",-1)),(o(!0),n(b,null,g(c(E).areas,a=>(o(),n("option",{key:a.id,value:a.id},r(a.name),9,Ue))),128))],512),[[w,l.value.area_id]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-gray-700"},"মাদরাসা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.institute_id=a),class:"input-1",disabled:!l.value.area_id,required:""},[e[19]||(e[19]=t("option",{value:"",disabled:""},"Select Institute",-1)),(o(!0),n(b,null,g(c(V).institutes,a=>(o(),n("option",{key:a.id,value:a.id},r(a.institute_code)+" - "+r(a.name),9,Me))),128))],8,Ye),[[w,l.value.institute_id]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-gray-700"},"মারহালা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.zamat_id=a),class:"input-1",required:""},[e[21]||(e[21]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(o(!0),n(b,null,g(c(K).departments,a=>(o(),n("optgroup",{label:a.name,key:a.id},[(o(!0),n(b,null,g(a.zamats,p=>(o(),n("option",{key:p.id,value:p.id},r(p.name),9,Ce))),128))],8,we))),128))],512),[[w,l.value.zamat_id]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-gray-700"},"গ্রুপ নির্বাচন করুন (যদি থাকে)",-1)),u(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.group_id=a),class:"input-1",disabled:!l.value.zamat_id},[e[24]||(e[24]=t("option",{value:"",disabled:""},"Select Group",-1)),(o(!0),n(b,null,g(c(I).groups,a=>(o(),n("option",{key:a.id,value:a.id},[_(r(a.name)+" (",1),(o(!0),n(b,null,g(a.areas,(p,d)=>(o(),n(b,{key:p.id},[d?(o(),n("span",Be,", ")):x("",!0),t("span",null,r(p.name),1)],64))),128)),e[23]||(e[23]=_(") "))],8,je))),128))],8,ze),[[w,l.value.group_id]])]),x("",!0),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-gray-700"},"কেন্দ্র নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.center_id=a),class:"input-1",disabled:!l.value.zamat_id,required:""},[e[28]||(e[28]=t("option",{value:"",disabled:""},"Select Center",-1)),(o(!0),n(b,null,g(c(F).centers,a=>{var p;return o(),n("option",{key:a.id,value:a==null?void 0:a.institute_id},r((p=a==null?void 0:a.institute)==null?void 0:p.name),9,Fe)}),128))],8,qe),[[w,l.value.center_id]])])]),t("div",Ie,[e[38]||(e[38]=se('<div class="flex justify-center"><h4 class="title-lg">পরীক্ষার্থীদের তথ্য</h4></div><div class="hidden md:grid md:grid-cols-12 bg-gray-100 py-2 px-2 text-center divide-x-2 font-medium"><div class="text-center">ক্র</div><div class="col-span-2 text-center">পরীক্ষার্থীর নাম</div><div class="col-span-2">পিতার নাম</div><div class="col-span-2"> জন্ম তারিখ <span class="text-xs">(জন্ম নিবন্ধন অনুসারে)</span></div><div class="col-span-2">পারার বিবরণ <span class="text-xs">(হিফজের ক্ষেত্রে)</span></div><div class="col-span-2">ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)</div><div>ডিলিট</div></div>',2)),(o(!0),n(b,null,g(l.value.students,(a,p)=>(o(),n("div",{key:p},[t("div",Ae,[t("div",Ee,[t("div",Ke,r(p+1),1)]),t("div",Le,[e[30]||(e[30]=t("div",{class:"md:hidden flex font-medium"},"পরীক্ষার্থীর নাম:",-1)),u(t("input",{"onUpdate:modelValue":d=>a.name=d,type:"text",class:"input-1",required:"",placeholder:"বাংলায়"},null,8,Ne),[[v,a.name]]),u(t("input",{"onUpdate:modelValue":d=>a.name_arabic=d,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Oe),[[v,a.name_arabic]])]),t("div",Ge,[e[31]||(e[31]=t("div",{class:"md:hidden flex font-medium"},"পিতার নাম:",-1)),u(t("input",{"onUpdate:modelValue":d=>a.father_name=d,required:"",type:"text",class:"input-1",placeholder:"বাংলায়"},null,8,Te),[[v,a.father_name]]),u(t("input",{"onUpdate:modelValue":d=>a.father_name_arabic=d,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Je),[[v,a.father_name_arabic]])]),t("div",Re,[e[33]||(e[33]=t("p",{class:"md:hidden flex font-medium"},"জন্ম তারিখ (জন্ম নিবন্ধন অনুসারে)",-1)),t("div",Xe,[a.date_of_birth?(o(),n("div",Ze,e[32]||(e[32]=[t("i",{class:"fa fa-check-circle text-green-500"},null,-1)]))):x("",!0),u(t("input",{"onUpdate:modelValue":d=>a.input_dob=d,required:"",type:"text",placeholder:"DD/MM/YYYY",class:"input-1 border-r-0 rounded-r-none text-center",onBlur:d=>N(a),onKeyup:G(d=>N(a),["enter"])},null,40,He),[[v,a.input_dob]]),u(t("input",{onChange:d=>Q(a),"onUpdate:modelValue":d=>a.date_of_birth=d,required:"",type:"date",class:"input-1 w-10 px-2 rounded-l-none"},null,40,Pe),[[v,a.date_of_birth]])])]),t("div",Qe,[e[34]||(e[34]=t("p",{class:"md:hidden flex font-medium"},"পারার বিববরণ (হিফজের ক্ষেত্রে)",-1)),u(t("input",{"onUpdate:modelValue":d=>a.para=d,type:"text",class:"input-1",placeholder:"পারার বিবরণ"},null,8,We),[[v,a.para]])]),t("div",et,[e[35]||(e[35]=t("p",{class:"md:hidden flex font-medium"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)",-1)),u(t("input",{"onUpdate:modelValue":d=>a.address=d,type:"text",class:"input-1",placeholder:"গ্রাম, ডাকঘর, থানা, জেলা"},null,8,tt),[[v,a.address]])]),t("div",at,[t("button",{type:"button",onClick:d=>R(p),class:"btn-4 py-2"},e[36]||(e[36]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,st)])])]))),128)),t("div",{class:"flex justify-center"},[t("button",{type:"button",onClick:J,class:"btn-contrast"},e[37]||(e[37]=[t("i",{class:"fas fa-plus"},null,-1),_(" আরেকজন যুক্ত করুন ")]))])]),e[45]||(e[45]=t("hr",{class:"my-4"},null,-1)),q.value?(o(),n("div",lt,[t("div",it,[t("div",null," প্রতি পরীক্ষার্থীর ফি: "+r(c(i).exam.registration_fee)+" টাকা। বিলম্ব ফি (প্রযোজ্য ক্ষেত্রে): "+r(c(i).exam.late_fee)+" টাকা। ",1),t("div",nt,[e[39]||(e[39]=_(" পরীক্ষার্থীর সংখ্যা:")),t("b",null,r(l.value.students.length),1),e[40]||(e[40]=_(" X ")),t("b",null,r(q.value),1),e[41]||(e[41]=_(" টাকা = ")),t("b",null,r(l.value.students.length*q.value)+" টাকা",1)])]),x("",!0),t("button",{type:"submit",disabled:z.value,class:"btn-2"},r(z.value?"সাবমিট হচ্ছে...":"সাবমিট করুন"),9,ot)])):x("",!0),t("div",dt,[j.value?(o(),n("div",rt,r(j.value),1)):x("",!0),$.value?(o(),n("div",ut,r($.value),1)):x("",!0)])],32)])])}}};export{yt as default};
