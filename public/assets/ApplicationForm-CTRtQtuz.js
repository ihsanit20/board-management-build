import{B as Z,r as k,C,o as ee,i as te,c as o,a as t,t as r,b as m,y as v,j as u,v as b,n as ae,p as L,G as O,D as V,F as c,e as y,h as x,l as se,d as n,s as le}from"./index-B8cc7GvB.js";import{u as ie}from"./application-Bk-Ra2_R.js";import{u as oe}from"./institute-BYjsEgDG.js";import{u as ne}from"./area-Ce8YRMeY.js";import{u as de}from"./zamat-Bx_Q6Y4y.js";import{u as re}from"./group-kLS9MVAi.js";import{u as ue}from"./center-CQFUh__h.js";import{u as pe}from"./fee-DZioI69C.js";import{u as me}from"./para-group-OVKPu2ga.js";import{f as _e}from"./date-Cs-xe4uq.js";const ve={class:"mx-4"},ce={class:"md:p-8 p-4 card-bg space-y-2"},fe={class:"flex gap-4 justify-center items-center"},be={class:"flex flex-col items-center space-y-2"},ye={class:"title-xl"},ge={class:"flex flex-wrap gap-2 text-center"},xe={class:"md:text-base text-sm"},he={class:"flex justify-center items-center"},ke={class:"flex gap-2 justify-center items-center bg-gray-100 p-4 rounded-lg"},Ve={class:"text-red-500"},Se={class:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-md"},Ue={class:"col-start-1"},we=["max"],Ce={class:""},De=["value"],ze=["disabled"],$e=["value"],je=["label"],Be=["value"],Me=["disabled"],qe=["value"],Ge={key:0},Ae=["disabled"],Fe=["value"],Ee={class:"space-y-2"},Ie={class:"grid md:grid-cols-12 gap-4 border rounded p-2"},Le={class:"flex items-center justify-center"},Oe={class:"text-lg font-semibold mb-2 px-3 py-1 bg-gray-100 rounded-full"},Ke={class:"md:col-span-2 grid gap-2"},Ne=["onUpdate:modelValue"],Ye=["onUpdate:modelValue"],Te={class:"md:col-span-2 grid gap-2"},Pe=["onUpdate:modelValue"],Re=["onUpdate:modelValue"],Xe={class:"md:col-span-2"},He={class:"flex relative"},Je={key:0,class:"absolute left-2 top-3"},Qe=["onUpdate:modelValue","onBlur","onKeyup"],We=["onChange","onUpdate:modelValue"],Ze={class:"md:col-span-2"},et=["onUpdate:modelValue","disabled"],tt=["value"],at={class:"md:col-span-2"},st=["onUpdate:modelValue"],lt={class:"flex justify-end md:justify-center items-start"},it=["onClick"],ot={key:0,class:"flex flex-col items-center space-y-2"},nt={class:"flex flex-col items-center"},dt={class:"text-xl text-green-600"},rt=["disabled"],ut={class:"flex justify-center"},pt={key:0,class:"text-xl text-green-600"},mt={key:1,class:"text-xl text-red-600"},St={__name:"ApplicationForm",setup(_t){const K=le(),d=Z(),N=pe(),Y=ie(),h=oe(),B=ue(),A=ne(),F=de(),M=re(),q=me(),D=k(!1),S=k(""),z=k(""),$=k(""),U=k(""),G=new Date().toISOString().split("T")[0],l=k({application_date:G,exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""}],payment_method:"Offline",total_amount:0}),T=async()=>{var s;h.institutes=[],M.groups=[],B.centers=[],N.fee={},await d.fetchLastExam(),l.value.exam_id=(s=d==null?void 0:d.exam)==null?void 0:s.id,await A.fetchAreas(),await F.fetchZamats()};C(()=>l.value.area_id,async s=>{s&&await h.fetchInstitutes({area_id:s,per_page:"all"})}),C(()=>l.value.zamat_id,async s=>{s?(l.value.group_id="",await M.fetchGroups(s),await q.fetchParaGroups({zamat_id:s})):q.paraGroups=[]}),C(()=>l.value.zamat_id,async s=>{s&&E()}),C(()=>l.value.group_id,async s=>{s&&E()}),C($,()=>{U.value=""});const E=async()=>{B.fetchCenters({zamat_id:l.value.zamat_id,group_id:l.value.group_id,gender:l.value.gender})};ee(T);const P=()=>{l.value.students.push({registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""})},R=s=>{confirm("ডিলিট নিশ্চিত করুন")&&l.value.students.splice(s,1)},X=()=>{l.value={application_date:G,exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",input_dob:"",date_of_birth:"",para:"",address:""}],payment_method:"Offline",total_amount:0}},H=async()=>{var s,e;D.value=!0,S.value="",z.value="";try{l.value.total_amount=j.value*(((e=(s=l==null?void 0:l.value)==null?void 0:s.students)==null?void 0:e.length)||0),await Y.createApplication(l.value),z.value="আপনার নিবন্ধন সফলভাবে জমা হয়েছে।",X(),K.push("/applications")}catch{S.value="নিবন্ধন জমা দিতে ব্যর্থ হয়েছে।"}finally{D.value=!1}},J=s=>{S.value=s},j=te(()=>{var _,f,g,w;let s=parseInt(((_=d==null?void 0:d.exam)==null?void 0:_.registration_fee)||0);const e=_e(new Date(l.value.application_date));return e>((f=d==null?void 0:d.exam)==null?void 0:f.reg_final_date)?(J("নিবন্ধন গ্রহণ বন্ধ রয়েছে"),s=0):(e>((g=d==null?void 0:d.exam)==null?void 0:g.reg_last_date)&&(s+=parseInt(((w=d==null?void 0:d.exam)==null?void 0:w.late_fee)||0)),s)}),Q=async()=>{l.value.area_id="",l.value.institute_id="",h.institutes=[],U.value="";const s=await h.findInstituteByCode($.value);s?(h.institutes[0]=s,l.value.area_id=s.area_id,l.value.institute_id=s.id):U.value="খুঁজে পাওয়া যায় নি!"},I=s=>{if(/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/.test(s.input_dob)){const[_,f,g]=s.input_dob.split("/");s.date_of_birth=`${g}-${f}-${_}`}else s.date_of_birth="",s.input_dob=""},W=s=>{if(s.date_of_birth&&/^\d{4}-\d{2}-\d{2}$/.test(s.date_of_birth)){const[e,_,f]=s.date_of_birth.split("-");s.input_dob=`${f}/${_}/${e}`}else s.input_dob=""};return(s,e)=>{var _,f,g,w;return n(),o("div",ve,[t("div",ce,[t("div",fe,[t("div",be,[t("h2",ye,r((f=(_=m(d))==null?void 0:_.exam)==null?void 0:f.name),1),t("div",ge,[t("p",xe,[e[11]||(e[11]=v(" নিবন্ধনের শেষ তারিখ ")),t("b",null,r(new Date((g=m(d).exam)==null?void 0:g.reg_last_date).toLocaleDateString("bn-BD")),1),e[12]||(e[12]=v(" ইং। বিলম্ব ফি সহ নিবন্ধনের চূড়ান্ত তারিখ ")),t("b",null,r(new Date((w=m(d).exam)==null?void 0:w.reg_final_date).toLocaleDateString("bn-BD")),1),e[13]||(e[13]=v(" ইং। "))])]),e[14]||(e[14]=t("div",{class:"px-6 bg-sky-700 rounded-full pt-1"},[t("h2",{class:"title-lg text-white"},"নিবন্ধন পত্র")],-1))])]),t("div",he,[t("div",ke,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>$.value=a),type:"search",class:ae(["input-1 text-center",{"border-red-500":!!U.value}]),placeholder:"ইলহাক নাম্বার"},null,2),[[b,$.value]]),t("div",Ve,r(U.value),1),t("button",{onClick:Q,type:"button",class:"btn-2"},e[15]||(e[15]=[t("i",{class:"fas fa-search"},null,-1),v(" খুঁজুন ")]))])]),t("form",{onSubmit:L(H,["prevent"]),onKeydown:e[10]||(e[10]=O(L(()=>{},["prevent"]),["enter"])),class:"space-y-4"},[t("div",Se,[t("div",Ue,[e[16]||(e[16]=t("label",{class:"block text-gray-700"},"আবেদনের তারিখ",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.application_date=a),type:"date",class:"input-1",max:m(G)},null,8,we),[[b,l.value.application_date]])]),t("div",Ce,[e[18]||(e[18]=t("label",{class:"block text-gray-700"},"অঞ্চল নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.area_id=a),class:"input-1"},[e[17]||(e[17]=t("option",{value:"",disabled:""},"Select Area",-1)),(n(!0),o(c,null,y(m(A).areas,a=>(n(),o("option",{key:a.id,value:a.id},r(a.name),9,De))),128))],512),[[V,l.value.area_id]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-gray-700"},"মাদরাসা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.institute_id=a),class:"input-1",disabled:!l.value.area_id,required:""},[e[19]||(e[19]=t("option",{value:"",disabled:""},"Select Institute",-1)),(n(!0),o(c,null,y(m(h).institutes,a=>(n(),o("option",{key:a.id,value:a.id},r(a.institute_code)+" - "+r(a.name),9,$e))),128))],8,ze),[[V,l.value.institute_id]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-gray-700"},"মারহালা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.zamat_id=a),class:"input-1",required:""},[e[21]||(e[21]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(n(!0),o(c,null,y(m(F).departments,a=>(n(),o("optgroup",{label:a.name,key:a.id},[(n(!0),o(c,null,y(a.zamats,p=>(n(),o("option",{key:p.id,value:p.id},r(p.name),9,Be))),128))],8,je))),128))],512),[[V,l.value.zamat_id]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-gray-700"},"গ্রুপ নির্বাচন করুন (যদি থাকে)",-1)),u(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.group_id=a),class:"input-1",disabled:!l.value.zamat_id},[e[24]||(e[24]=t("option",{value:"",disabled:""},"Select Group",-1)),(n(!0),o(c,null,y(m(M).groups,a=>(n(),o("option",{key:a.id,value:a.id},[v(r(a.name)+" (",1),(n(!0),o(c,null,y(a.areas,(p,i)=>(n(),o(c,{key:p.id},[i?(n(),o("span",Ge,", ")):x("",!0),t("span",null,r(p.name),1)],64))),128)),e[23]||(e[23]=v(") "))],8,qe))),128))],8,Me),[[V,l.value.group_id]])]),x("",!0),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-gray-700"},"কেন্দ্র নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.center_id=a),class:"input-1",disabled:!l.value.zamat_id,required:""},[e[28]||(e[28]=t("option",{value:"",disabled:""},"Select Center",-1)),(n(!0),o(c,null,y(m(B).centers,a=>{var p;return n(),o("option",{key:a.id,value:a==null?void 0:a.institute_id},r((p=a==null?void 0:a.institute)==null?void 0:p.name),9,Fe)}),128))],8,Ae),[[V,l.value.center_id]])])]),t("div",Ee,[e[39]||(e[39]=se('<div class="flex justify-center"><h4 class="title-lg">পরীক্ষার্থীদের তথ্য</h4></div><div class="hidden md:grid md:grid-cols-12 bg-gray-100 py-2 px-2 text-center divide-x-2 font-medium"><div class="text-center">ক্র</div><div class="col-span-2 text-center">পরীক্ষার্থীর নাম</div><div class="col-span-2">পিতার নাম</div><div class="col-span-2"> জন্ম তারিখ <span class="text-xs">(জন্ম নিবন্ধন অনুসারে)</span></div><div class="col-span-2">পারার বিবরণ <span class="text-xs">(হিফজের ক্ষেত্রে)</span></div><div class="col-span-2">ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)</div><div>ডিলিট</div></div>',2)),(n(!0),o(c,null,y(l.value.students,(a,p)=>(n(),o("div",{key:p},[t("div",Ie,[t("div",Le,[t("div",Oe,r(p+1),1)]),t("div",Ke,[e[30]||(e[30]=t("div",{class:"md:hidden flex font-medium"},"পরীক্ষার্থীর নাম:",-1)),u(t("input",{"onUpdate:modelValue":i=>a.name=i,type:"text",class:"input-1",required:"",placeholder:"বাংলায়"},null,8,Ne),[[b,a.name]]),u(t("input",{"onUpdate:modelValue":i=>a.name_arabic=i,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Ye),[[b,a.name_arabic]])]),t("div",Te,[e[31]||(e[31]=t("div",{class:"md:hidden flex font-medium"},"পিতার নাম:",-1)),u(t("input",{"onUpdate:modelValue":i=>a.father_name=i,required:"",type:"text",class:"input-1",placeholder:"বাংলায়"},null,8,Pe),[[b,a.father_name]]),u(t("input",{"onUpdate:modelValue":i=>a.father_name_arabic=i,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Re),[[b,a.father_name_arabic]])]),t("div",Xe,[e[33]||(e[33]=t("p",{class:"md:hidden flex font-medium"},"জন্ম তারিখ (জন্ম নিবন্ধন অনুসারে)",-1)),t("div",He,[a.date_of_birth?(n(),o("div",Je,e[32]||(e[32]=[t("i",{class:"fa fa-check-circle text-green-500"},null,-1)]))):x("",!0),u(t("input",{"onUpdate:modelValue":i=>a.input_dob=i,required:"",type:"text",placeholder:"DD/MM/YYYY",class:"input-1 border-r-0 rounded-r-none text-center",onBlur:i=>I(a),onKeyup:O(i=>I(a),["enter"])},null,40,Qe),[[b,a.input_dob]]),u(t("input",{onChange:i=>W(a),"onUpdate:modelValue":i=>a.date_of_birth=i,required:"",type:"date",class:"input-1 w-10 px-2 rounded-l-none"},null,40,We),[[b,a.date_of_birth]])])]),t("div",Ze,[e[35]||(e[35]=t("p",{class:"md:hidden flex font-medium"},"পারার বিববরণ (হিফজের ক্ষেত্রে)",-1)),u(t("select",{"onUpdate:modelValue":i=>a.para=i,class:"input-1",disabled:!l.value.zamat_id},[e[34]||(e[34]=t("option",{value:"",disabled:""},"পারা নির্বাচন করুন",-1)),(n(!0),o(c,null,y(m(q).paraGroups,i=>(n(),o("option",{key:i.id,value:i.id},r(i.name),9,tt))),128))],8,et),[[V,a.para]])]),t("div",at,[e[36]||(e[36]=t("p",{class:"md:hidden flex font-medium"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)",-1)),u(t("input",{"onUpdate:modelValue":i=>a.address=i,type:"text",class:"input-1",placeholder:"গ্রাম, ডাকঘর, থানা, জেলা"},null,8,st),[[b,a.address]])]),t("div",lt,[t("button",{type:"button",onClick:i=>R(p),class:"btn-4 py-2"},e[37]||(e[37]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,it)])])]))),128)),t("div",{class:"flex justify-center"},[t("button",{type:"button",onClick:P,class:"btn-contrast"},e[38]||(e[38]=[t("i",{class:"fas fa-plus"},null,-1),v(" আরেকজন যুক্ত করুন ")]))])]),e[46]||(e[46]=t("hr",{class:"my-4"},null,-1)),j.value?(n(),o("div",ot,[t("div",nt,[t("div",null," প্রতি পরীক্ষার্থীর ফি: "+r(m(d).exam.registration_fee)+" টাকা। বিলম্ব ফি (প্রযোজ্য ক্ষেত্রে): "+r(m(d).exam.late_fee)+" টাকা। ",1),t("div",dt,[e[40]||(e[40]=v(" পরীক্ষার্থীর সংখ্যা:")),t("b",null,r(l.value.students.length),1),e[41]||(e[41]=v(" X ")),t("b",null,r(j.value),1),e[42]||(e[42]=v(" টাকা = ")),t("b",null,r(l.value.students.length*j.value)+" টাকা",1)])]),x("",!0),t("button",{type:"submit",disabled:D.value,class:"btn-2"},r(D.value?"সাবমিট হচ্ছে...":"সাবমিট করুন"),9,rt)])):x("",!0),t("div",ut,[z.value?(n(),o("div",pt,r(z.value),1)):x("",!0),S.value?(n(),o("div",mt,r(S.value),1)):x("",!0)])],32)])])}}};export{St as default};
