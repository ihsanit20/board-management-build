import{B as ee,r as k,C as D,o as te,i as ae,c as o,a as t,t as r,b as m,k as c,j as u,v as b,n as se,y as L,G as N,D as V,F as _,e as y,h as S,s as le,d as n,p as ie}from"./index-hvT126dx.js";import{u as oe}from"./application-BdJeIiS-.js";import{u as ne}from"./institute-4BQz04_u.js";import{u as de}from"./area-DJ1Rxr2s.js";import{u as re}from"./zamat-H2xY0ueG.js";import{u as ue}from"./group-CDZt7zgm.js";import{u as pe}from"./center-ClmEsGDF.js";import{u as me}from"./fee-BDWdIT0F.js";import{u as ve}from"./para-group-C3PRyVuI.js";import{f as ce}from"./date-Cs-xe4uq.js";const _e={class:"mx-4"},fe={class:"md:p-8 p-4 card-bg space-y-2"},be={class:"flex gap-4 justify-center items-center"},ye={class:"flex flex-col items-center space-y-2"},ge={class:"title-xl"},xe={class:"flex flex-wrap gap-2 text-center"},he={class:"md:text-base text-sm"},ke={class:"flex justify-center items-center"},Ve={class:"flex gap-2 justify-center items-center bg-gray-100 p-4 rounded-lg"},Se={class:"text-red-500"},Ue={class:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-md"},we={class:"col-start-1"},De=["max"],Ce=["value"],ze=["disabled"],$e=["value"],Me=["label"],je=["value"],Be=["disabled"],qe=["value"],Ae={key:0},Ge=["disabled"],Ee=["value"],Fe={class:"space-y-2"},Ie={class:"grid md:grid-cols-12 gap-4 border rounded p-2"},Le={class:"flex items-center justify-center"},Ne={class:"text-lg font-semibold mb-2 px-3 py-1 bg-gray-100 rounded-full"},Oe={class:"md:col-span-2 grid gap-2"},Te=["onUpdate:modelValue"],Ke=["onUpdate:modelValue"],Ye={class:"md:col-span-2 grid gap-2"},Pe=["onUpdate:modelValue"],Xe=["onUpdate:modelValue"],Re={class:"md:col-span-2"},He={class:"flex relative"},Je={key:0,class:"absolute left-2 top-3"},Qe=["onUpdate:modelValue","onBlur","onKeyup"],We=["onChange","onUpdate:modelValue"],Ze={class:"md:col-span-2"},et=["onUpdate:modelValue","disabled"],tt=["value"],at={class:"md:col-span-2"},st=["onUpdate:modelValue"],lt={class:"flex justify-end md:justify-center items-start"},it=["onClick"],ot={key:0,class:"flex flex-col items-center space-y-2"},nt={class:"flex flex-col items-center"},dt={class:"text-xl text-green-600"},rt=["disabled"],ut={class:"flex justify-center"},pt={key:0,class:"text-xl text-green-600"},mt={key:1,class:"text-xl text-red-600"},O=99,St={__name:"ApplicationForm",setup(vt){const T=ie(),d=ee(),K=me(),Y=oe(),x=ne(),j=pe(),G=de(),E=re(),B=ue(),q=ve(),C=k(!1),h=k(""),z=k(""),$=k(""),U=k(""),A=new Date().toISOString().split("T")[0],s=k({application_date:A,exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""}],payment_method:"Offline",total_amount:0}),P=async()=>{var l;x.institutes=[],B.groups=[],j.centers=[],K.fee={},await d.fetchLastExam(),s.value.exam_id=(l=d==null?void 0:d.exam)==null?void 0:l.id,await G.fetchAreas(),await E.fetchZamats()};D(()=>s.value.area_id,async l=>{l&&await x.fetchInstitutes({area_id:l,per_page:"all"})}),D(()=>s.value.zamat_id,async l=>{l?(s.value.group_id="",await B.fetchGroups(l),await q.fetchParaGroups({zamat_id:l})):q.paraGroups=[]}),D(()=>s.value.zamat_id,async l=>{l&&F()}),D(()=>s.value.group_id,async l=>{l&&F()}),D($,()=>{U.value=""});const F=async()=>{j.fetchCenters({zamat_id:s.value.zamat_id,group_id:s.value.group_id,gender:s.value.gender})};te(P);const X=()=>{if(s.value.students.length>=O){alert("সর্বোচ্চ ৯৯ জন পরীক্ষার্থী যোগ করা যাবে।");return}s.value.students.push({registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""})},R=l=>{confirm("ডিলিট নিশ্চিত করুন")&&s.value.students.splice(l,1)},H=()=>{s.value={application_date:A,exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",input_dob:"",date_of_birth:"",para:"",address:""}],payment_method:"Offline",total_amount:0}},J=async()=>{var l,e;if(s.value.students.length>O){h.value="সর্বোচ্চ ৯৯ জন পরীক্ষার্থীর তথ্য জমা দেয়া যাবে।";return}C.value=!0,h.value="",z.value="";try{s.value.total_amount=M.value*(((e=(l=s==null?void 0:s.value)==null?void 0:l.students)==null?void 0:e.length)||0),await Y.createApplication(s.value),z.value="আপনার নিবন্ধন সফলভাবে জমা হয়েছে।",H(),T.push("/applications")}catch{h.value="নিবন্ধন জমা দিতে ব্যর্থ হয়েছে।"}finally{C.value=!1}},Q=l=>{h.value=l},M=ae(()=>{var v,f,g,w;let l=parseInt(((v=d==null?void 0:d.exam)==null?void 0:v.registration_fee)||0);const e=ce(new Date(s.value.application_date));return e>((f=d==null?void 0:d.exam)==null?void 0:f.reg_final_date)?(Q("নিবন্ধন গ্রহণ বন্ধ রয়েছে"),0):(e>((g=d==null?void 0:d.exam)==null?void 0:g.reg_last_date)&&(l+=parseInt(((w=d==null?void 0:d.exam)==null?void 0:w.late_fee)||0)),l)}),W=async()=>{s.value.area_id="",s.value.institute_id="",x.institutes=[],U.value="";const l=await x.findInstituteByCode($.value);l?(x.institutes[0]=l,s.value.area_id=l.area_id,s.value.institute_id=l.id):U.value="খুঁজে পাওয়া যায় নি!"},I=l=>{if(/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/.test(l.input_dob)){const[v,f,g]=l.input_dob.split("/");l.date_of_birth=`${g}-${f}-${v}`}else l.date_of_birth="",l.input_dob=""},Z=l=>{if(l.date_of_birth&&/^\d{4}-\d{2}-\d{2}$/.test(l.date_of_birth)){const[e,v,f]=l.date_of_birth.split("-");l.input_dob=`${f}/${v}/${e}`}else l.input_dob=""};return(l,e)=>{var v,f,g,w;return n(),o("div",_e,[t("div",fe,[t("div",be,[t("div",ye,[t("h2",ge,r((f=(v=m(d))==null?void 0:v.exam)==null?void 0:f.name),1),t("div",xe,[t("p",he,[e[9]||(e[9]=c(" নিবন্ধনের শেষ তারিখ ")),t("b",null,r(new Date((g=m(d).exam)==null?void 0:g.reg_last_date).toLocaleDateString("bn-BD")),1),e[10]||(e[10]=c(" ইং। বিলম্ব ফি সহ নিবন্ধনের চূড়ান্ত তারিখ ")),t("b",null,r(new Date((w=m(d).exam)==null?void 0:w.reg_final_date).toLocaleDateString("bn-BD")),1),e[11]||(e[11]=c(" ইং। "))])]),e[12]||(e[12]=t("div",{class:"px-6 bg-sky-700 rounded-full pt-1"},[t("h2",{class:"title-lg text-white"},"নিবন্ধন পত্র")],-1))])]),t("div",ke,[t("div",Ve,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>$.value=a),type:"search",class:se(["input-1 text-center",{"border-red-500":!!U.value}]),placeholder:"ইলহাক নাম্বার"},null,2),[[b,$.value]]),t("div",Se,r(U.value),1),t("button",{onClick:W,type:"button",class:"btn-2"},e[13]||(e[13]=[t("i",{class:"fas fa-search"},null,-1),c(" খুঁজুন ")]))])]),t("form",{onSubmit:L(J,["prevent"]),onKeydown:e[8]||(e[8]=N(L(()=>{},["prevent"]),["enter"])),class:"space-y-4"},[t("div",Ue,[t("div",we,[e[14]||(e[14]=t("label",{class:"block text-gray-700"},"আবেদনের তারিখ",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.application_date=a),type:"date",class:"input-1",max:m(A)},null,8,De),[[b,s.value.application_date]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-gray-700"},"অঞ্চল নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.area_id=a),class:"input-1"},[e[15]||(e[15]=t("option",{value:"",disabled:""},"Select Area",-1)),(n(!0),o(_,null,y(m(G).areas,a=>(n(),o("option",{key:a.id,value:a.id},r(a.name),9,Ce))),128))],512),[[V,s.value.area_id]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-gray-700"},"মাদরাসা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.institute_id=a),class:"input-1",disabled:!s.value.area_id,required:""},[e[17]||(e[17]=t("option",{value:"",disabled:""},"Select Institute",-1)),(n(!0),o(_,null,y(m(x).institutes,a=>(n(),o("option",{key:a.id,value:a.id},r(a.institute_code)+" - "+r(a.name),9,$e))),128))],8,ze),[[V,s.value.institute_id]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-gray-700"},"মারহালা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>s.value.zamat_id=a),class:"input-1",required:""},[e[19]||(e[19]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(n(!0),o(_,null,y(m(E).departments,a=>(n(),o("optgroup",{label:a.name,key:a.id},[(n(!0),o(_,null,y(a.zamats,p=>(n(),o("option",{key:p.id,value:p.id},r(p.name),9,je))),128))],8,Me))),128))],512),[[V,s.value.zamat_id]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-gray-700"},"গ্রুপ নির্বাচন করুন (যদি থাকে)",-1)),u(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>s.value.group_id=a),class:"input-1",disabled:!s.value.zamat_id},[e[22]||(e[22]=t("option",{value:"",disabled:""},"Select Group",-1)),(n(!0),o(_,null,y(m(B).groups,a=>(n(),o("option",{key:a.id,value:a.id},[c(r(a.name)+" (",1),(n(!0),o(_,null,y(a.areas,(p,i)=>(n(),o(_,{key:p.id},[i?(n(),o("span",Ae,", ")):S("",!0),t("span",null,r(p.name),1)],64))),128)),e[21]||(e[21]=c(") "))],8,qe))),128))],8,Be),[[V,s.value.group_id]])]),S("",!0),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-gray-700"},"কেন্দ্র নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>s.value.center_id=a),class:"input-1",disabled:!s.value.zamat_id,required:""},[e[26]||(e[26]=t("option",{value:"",disabled:""},"Select Center",-1)),(n(!0),o(_,null,y(m(j).centers,a=>{var p;return n(),o("option",{key:a.id,value:a==null?void 0:a.institute_id},r((p=a==null?void 0:a.institute)==null?void 0:p.name),9,Ee)}),128))],8,Ge),[[V,s.value.center_id]])])]),t("div",Fe,[e[37]||(e[37]=le('<div class="flex justify-center"><h4 class="title-lg">পরীক্ষার্থীদের তথ্য</h4></div><div class="text-sm text-gray-600 text-center"> সর্বোচ্চ <b>৯৯</b> জন পরীক্ষার্থী যোগ করা যাবে। </div><div class="hidden md:grid md:grid-cols-12 bg-gray-100 py-2 px-2 text-center divide-x-2 font-medium"><div class="text-center">ক্র</div><div class="col-span-2 text-center">পরীক্ষার্থীর নাম</div><div class="col-span-2">পিতার নাম</div><div class="col-span-2"> জন্ম তারিখ <span class="text-xs">(জন্ম নিবন্ধন অনুসারে)</span></div><div class="col-span-2">পারার বিবরণ <span class="text-xs">(হিফজের ক্ষেত্রে)</span></div><div class="col-span-2">ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)</div><div>ডিলিট</div></div>',3)),(n(!0),o(_,null,y(s.value.students,(a,p)=>(n(),o("div",{key:p},[t("div",Ie,[t("div",Le,[t("div",Ne,r(p+1),1)]),t("div",Oe,[e[28]||(e[28]=t("div",{class:"md:hidden flex font-medium"},"পরীক্ষার্থীর নাম:",-1)),u(t("input",{"onUpdate:modelValue":i=>a.name=i,type:"text",class:"input-1",required:"",placeholder:"বাংলায়"},null,8,Te),[[b,a.name]]),u(t("input",{"onUpdate:modelValue":i=>a.name_arabic=i,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Ke),[[b,a.name_arabic]])]),t("div",Ye,[e[29]||(e[29]=t("div",{class:"md:hidden flex font-medium"},"পিতার নাম:",-1)),u(t("input",{"onUpdate:modelValue":i=>a.father_name=i,required:"",type:"text",class:"input-1",placeholder:"বাংলায়"},null,8,Pe),[[b,a.father_name]]),u(t("input",{"onUpdate:modelValue":i=>a.father_name_arabic=i,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Xe),[[b,a.father_name_arabic]])]),t("div",Re,[e[31]||(e[31]=t("p",{class:"md:hidden flex font-medium"},"জন্ম তারিখ (জন্ম নিবন্ধন অনুসারে)",-1)),t("div",He,[a.date_of_birth?(n(),o("div",Je,e[30]||(e[30]=[t("i",{class:"fa fa-check-circle text-green-500"},null,-1)]))):S("",!0),u(t("input",{"onUpdate:modelValue":i=>a.input_dob=i,required:"",type:"text",placeholder:"DD/MM/YYYY",class:"input-1 border-r-0 rounded-r-none text-center",onBlur:i=>I(a),onKeyup:N(i=>I(a),["enter"])},null,40,Qe),[[b,a.input_dob]]),u(t("input",{onChange:i=>Z(a),"onUpdate:modelValue":i=>a.date_of_birth=i,required:"",type:"date",class:"input-1 w-10 px-2 rounded-l-none"},null,40,We),[[b,a.date_of_birth]])])]),t("div",Ze,[e[33]||(e[33]=t("p",{class:"md:hidden flex font-medium"},"পারার বিববরণ (হিফজের ক্ষেত্রে)",-1)),u(t("select",{"onUpdate:modelValue":i=>a.para=i,class:"input-1",disabled:!s.value.zamat_id},[e[32]||(e[32]=t("option",{value:"",disabled:""},"পারা নির্বাচন করুন",-1)),(n(!0),o(_,null,y(m(q).paraGroups,i=>(n(),o("option",{key:i.id,value:i.id},r(i.name),9,tt))),128))],8,et),[[V,a.para]])]),t("div",at,[e[34]||(e[34]=t("p",{class:"md:hidden flex font-medium"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)",-1)),u(t("input",{"onUpdate:modelValue":i=>a.address=i,type:"text",class:"input-1",placeholder:"গ্রাম, ডাকঘর, থানা, জেলা"},null,8,st),[[b,a.address]])]),t("div",lt,[t("button",{type:"button",onClick:i=>R(p),class:"btn-4 py-2"},e[35]||(e[35]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,it)])])]))),128)),t("div",{class:"flex justify-center"},[t("button",{type:"button",onClick:X,class:"btn-contrast"},e[36]||(e[36]=[t("i",{class:"fas fa-plus"},null,-1),c(" আরেকজন যুক্ত করুন ")]))])]),e[41]||(e[41]=t("hr",{class:"my-4"},null,-1)),M.value?(n(),o("div",ot,[t("div",nt,[t("div",null," প্রতি পরীক্ষার্থীর ফি: "+r(m(d).exam.registration_fee)+" টাকা। বিলম্ব ফি (প্রযোজ্য ক্ষেত্রে): "+r(m(d).exam.late_fee)+" টাকা। ",1),t("div",dt,[e[38]||(e[38]=c(" পরীক্ষার্থীর সংখ্যা:")),t("b",null,r(s.value.students.length),1),e[39]||(e[39]=c(" X ")),t("b",null,r(M.value),1),e[40]||(e[40]=c(" টাকা = ")),t("b",null,r(s.value.students.length*M.value)+" টাকা",1)])]),t("button",{type:"submit",disabled:C.value,class:"btn-2"},r(C.value?"সাবমিট হচ্ছে...":"সাবমিট করুন"),9,rt)])):S("",!0),t("div",ut,[z.value?(n(),o("div",pt,r(z.value),1)):S("",!0),h.value?(n(),o("div",mt,r(h.value),1)):S("",!0)])],32)])])}}};export{St as default};
