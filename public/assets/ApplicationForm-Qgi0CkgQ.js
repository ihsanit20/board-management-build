import{A as Q,r as k,B as w,o as W,i as ee,c as i,a as t,t as r,b as m,y as _,j as u,v,n as te,p as L,D as O,C,F as b,e as y,h as g,l as ae,d as o,s as se}from"./index-DDYxQi1_.js";import{u as le}from"./application-CKLxhUSu.js";import{u as ie}from"./institute-1pyCWCDV.js";import{u as oe}from"./area-OFCYA_8W.js";import{u as ne}from"./zamat-BMRJqU_L.js";import{u as de}from"./group-BF10q5k7.js";import{u as re}from"./center-D2CC6keL.js";import{u as ue}from"./fee-B5GNyEJe.js";import{f as pe}from"./date-Cs-xe4uq.js";const me={class:"mx-4"},ce={class:"md:p-8 p-4 card-bg space-y-2"},_e={class:"flex gap-4 justify-center items-center"},ve={class:"flex flex-col items-center space-y-2"},fe={class:"title-xl"},be={class:"flex flex-wrap gap-2 text-center"},ye={class:"md:text-base text-sm"},xe={class:"flex justify-center items-center"},ge={class:"flex gap-2 justify-center items-center bg-gray-100 p-4 rounded-lg"},he={class:"text-red-500"},ke={class:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-md"},Ve={class:"col-start-1"},Ue=["max"],Se={class:""},we=["value"],Ce=["disabled"],De=["value"],$e=["label"],ze=["value"],je=["disabled"],Be=["value"],Me={key:0},qe=["disabled"],Ae=["value"],Fe={class:"space-y-2"},Ie={class:"grid md:grid-cols-12 gap-4 border rounded p-2"},Ee={class:"flex items-center justify-center"},Le={class:"text-lg font-semibold mb-2 px-3 py-1 bg-gray-100 rounded-full"},Oe={class:"md:col-span-2 grid gap-2"},Ke=["onUpdate:modelValue"],Ne=["onUpdate:modelValue"],Ye={class:"md:col-span-2 grid gap-2"},Ge=["onUpdate:modelValue"],Te=["onUpdate:modelValue"],Re={class:"md:col-span-2"},Xe={class:"flex relative"},Ze={key:0,class:"absolute left-2 top-3"},He=["onUpdate:modelValue","onBlur","onKeyup"],Je=["onChange","onUpdate:modelValue"],Pe={class:"md:col-span-2"},Qe=["onUpdate:modelValue"],We={class:"md:col-span-2"},et=["onUpdate:modelValue"],tt={class:"flex justify-end md:justify-center items-start"},at=["onClick"],st={key:0,class:"flex flex-col items-center space-y-2"},lt={class:"flex flex-col items-center"},it={class:"text-xl text-green-600"},ot=["disabled"],nt={class:"flex justify-center"},dt={key:0,class:"text-xl text-green-600"},rt={key:1,class:"text-xl text-red-600"},gt={__name:"ApplicationForm",setup(ut){const K=se(),n=Q(),N=ue(),Y=le(),h=ie(),B=re(),A=oe(),F=ne(),M=de(),D=k(!1),V=k(""),$=k(""),z=k(""),U=k(""),q=new Date().toISOString().split("T")[0],l=k({application_date:q,exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""}],payment_method:"Offline",total_amount:0}),G=async()=>{var s;h.institutes=[],M.groups=[],B.centers=[],N.fee={},await n.fetchLastExam(),l.value.exam_id=(s=n==null?void 0:n.exam)==null?void 0:s.id,await A.fetchAreas(),await F.fetchZamats()};w(()=>l.value.area_id,async s=>{s&&await h.fetchInstitutes({area_id:s,per_page:"all"})}),w(()=>l.value.zamat_id,async s=>{s&&(l.value.group_id="",await M.fetchGroups(s))}),w(()=>l.value.zamat_id,async s=>{s&&I()}),w(()=>l.value.group_id,async s=>{s&&I()}),w(z,()=>{U.value=""});const I=async()=>{B.fetchCenters({zamat_id:l.value.zamat_id,group_id:l.value.group_id,gender:l.value.gender})};W(G);const T=()=>{l.value.students.push({registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""})},R=s=>{confirm("ডিলিট নিশ্চিত করুন")&&l.value.students.splice(s,1)},X=()=>{l.value={application_date:q,exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",input_dob:"",date_of_birth:"",para:"",address:""}],payment_method:"Offline",total_amount:0}},Z=async()=>{var s,e;D.value=!0,V.value="",$.value="";try{l.value.total_amount=j.value*(((e=(s=l==null?void 0:l.value)==null?void 0:s.students)==null?void 0:e.length)||0),await Y.createApplication(l.value),$.value="আপনার নিবন্ধন সফলভাবে জমা হয়েছে।",X(),K.push("/applications")}catch{V.value="নিবন্ধন জমা দিতে ব্যর্থ হয়েছে।"}finally{D.value=!1}},H=s=>{V.value=s},j=ee(()=>{var c,f,x,S;let s=parseInt(((c=n==null?void 0:n.exam)==null?void 0:c.registration_fee)||0);const e=pe(new Date(l.value.application_date));return e>((f=n==null?void 0:n.exam)==null?void 0:f.reg_final_date)?(H("নিবন্ধন গ্রহণ বন্ধ রয়েছে"),s=0):(e>((x=n==null?void 0:n.exam)==null?void 0:x.reg_last_date)&&(s+=parseInt(((S=n==null?void 0:n.exam)==null?void 0:S.late_fee)||0)),s)}),J=async()=>{l.value.area_id="",l.value.institute_id="",h.institutes=[],U.value="";const s=await h.findInstituteByCode(z.value);s?(h.institutes[0]=s,l.value.area_id=s.area_id,l.value.institute_id=s.id):U.value="খুঁজে পাওয়া যায় নি!"},E=s=>{if(/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/.test(s.input_dob)){const[c,f,x]=s.input_dob.split("/");s.date_of_birth=`${x}-${f}-${c}`}else s.date_of_birth="",s.input_dob=""},P=s=>{if(s.date_of_birth&&/^\d{4}-\d{2}-\d{2}$/.test(s.date_of_birth)){const[e,c,f]=s.date_of_birth.split("-");s.input_dob=`${f}/${c}/${e}`}else s.input_dob=""};return(s,e)=>{var c,f,x,S;return o(),i("div",me,[t("div",ce,[t("div",_e,[t("div",ve,[t("h2",fe,r((f=(c=m(n))==null?void 0:c.exam)==null?void 0:f.name),1),t("div",be,[t("p",ye,[e[11]||(e[11]=_(" নিবন্ধনের শেষ তারিখ ")),t("b",null,r(new Date((x=m(n).exam)==null?void 0:x.reg_last_date).toLocaleDateString("bn-BD")),1),e[12]||(e[12]=_(" ইং। বিলম্ব ফি সহ নিবন্ধনের চূড়ান্ত তারিখ ")),t("b",null,r(new Date((S=m(n).exam)==null?void 0:S.reg_final_date).toLocaleDateString("bn-BD")),1),e[13]||(e[13]=_(" ইং। "))])]),e[14]||(e[14]=t("div",{class:"px-6 bg-sky-700 rounded-full pt-1"},[t("h2",{class:"title-lg text-white"},"নিবন্ধন পত্র")],-1))])]),t("div",xe,[t("div",ge,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>z.value=a),type:"search",class:te(["input-1 text-center",{"border-red-500":!!U.value}]),placeholder:"ইলহাক নাম্বার"},null,2),[[v,z.value]]),t("div",he,r(U.value),1),t("button",{onClick:J,type:"button",class:"btn-2"},e[15]||(e[15]=[t("i",{class:"fas fa-search"},null,-1),_(" খুঁজুন ")]))])]),t("form",{onSubmit:L(Z,["prevent"]),onKeydown:e[10]||(e[10]=O(L(()=>{},["prevent"]),["enter"])),class:"space-y-4"},[t("div",ke,[t("div",Ve,[e[16]||(e[16]=t("label",{class:"block text-gray-700"},"আবেদনের তারিখ",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.application_date=a),type:"date",class:"input-1",max:m(q)},null,8,Ue),[[v,l.value.application_date]])]),t("div",Se,[e[18]||(e[18]=t("label",{class:"block text-gray-700"},"অঞ্চল নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.area_id=a),class:"input-1"},[e[17]||(e[17]=t("option",{value:"",disabled:""},"Select Area",-1)),(o(!0),i(b,null,y(m(A).areas,a=>(o(),i("option",{key:a.id,value:a.id},r(a.name),9,we))),128))],512),[[C,l.value.area_id]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-gray-700"},"মাদরাসা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.institute_id=a),class:"input-1",disabled:!l.value.area_id,required:""},[e[19]||(e[19]=t("option",{value:"",disabled:""},"Select Institute",-1)),(o(!0),i(b,null,y(m(h).institutes,a=>(o(),i("option",{key:a.id,value:a.id},r(a.institute_code)+" - "+r(a.name),9,De))),128))],8,Ce),[[C,l.value.institute_id]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-gray-700"},"মারহালা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.zamat_id=a),class:"input-1",required:""},[e[21]||(e[21]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(o(!0),i(b,null,y(m(F).departments,a=>(o(),i("optgroup",{label:a.name,key:a.id},[(o(!0),i(b,null,y(a.zamats,p=>(o(),i("option",{key:p.id,value:p.id},r(p.name),9,ze))),128))],8,$e))),128))],512),[[C,l.value.zamat_id]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-gray-700"},"গ্রুপ নির্বাচন করুন (যদি থাকে)",-1)),u(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.group_id=a),class:"input-1",disabled:!l.value.zamat_id},[e[24]||(e[24]=t("option",{value:"",disabled:""},"Select Group",-1)),(o(!0),i(b,null,y(m(M).groups,a=>(o(),i("option",{key:a.id,value:a.id},[_(r(a.name)+" (",1),(o(!0),i(b,null,y(a.areas,(p,d)=>(o(),i(b,{key:p.id},[d?(o(),i("span",Me,", ")):g("",!0),t("span",null,r(p.name),1)],64))),128)),e[23]||(e[23]=_(") "))],8,Be))),128))],8,je),[[C,l.value.group_id]])]),g("",!0),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-gray-700"},"কেন্দ্র নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.center_id=a),class:"input-1",disabled:!l.value.zamat_id,required:""},[e[28]||(e[28]=t("option",{value:"",disabled:""},"Select Center",-1)),(o(!0),i(b,null,y(m(B).centers,a=>{var p;return o(),i("option",{key:a.id,value:a==null?void 0:a.institute_id},r((p=a==null?void 0:a.institute)==null?void 0:p.name),9,Ae)}),128))],8,qe),[[C,l.value.center_id]])])]),t("div",Fe,[e[38]||(e[38]=ae('<div class="flex justify-center"><h4 class="title-lg">পরীক্ষার্থীদের তথ্য</h4></div><div class="hidden md:grid md:grid-cols-12 bg-gray-100 py-2 px-2 text-center divide-x-2 font-medium"><div class="text-center">ক্র</div><div class="col-span-2 text-center">পরীক্ষার্থীর নাম</div><div class="col-span-2">পিতার নাম</div><div class="col-span-2"> জন্ম তারিখ <span class="text-xs">(জন্ম নিবন্ধন অনুসারে)</span></div><div class="col-span-2">পারার বিবরণ <span class="text-xs">(হিফজের ক্ষেত্রে)</span></div><div class="col-span-2">ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)</div><div>ডিলিট</div></div>',2)),(o(!0),i(b,null,y(l.value.students,(a,p)=>(o(),i("div",{key:p},[t("div",Ie,[t("div",Ee,[t("div",Le,r(p+1),1)]),t("div",Oe,[e[30]||(e[30]=t("div",{class:"md:hidden flex font-medium"},"পরীক্ষার্থীর নাম:",-1)),u(t("input",{"onUpdate:modelValue":d=>a.name=d,type:"text",class:"input-1",required:"",placeholder:"বাংলায়"},null,8,Ke),[[v,a.name]]),u(t("input",{"onUpdate:modelValue":d=>a.name_arabic=d,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Ne),[[v,a.name_arabic]])]),t("div",Ye,[e[31]||(e[31]=t("div",{class:"md:hidden flex font-medium"},"পিতার নাম:",-1)),u(t("input",{"onUpdate:modelValue":d=>a.father_name=d,required:"",type:"text",class:"input-1",placeholder:"বাংলায়"},null,8,Ge),[[v,a.father_name]]),u(t("input",{"onUpdate:modelValue":d=>a.father_name_arabic=d,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Te),[[v,a.father_name_arabic]])]),t("div",Re,[e[33]||(e[33]=t("p",{class:"md:hidden flex font-medium"},"জন্ম তারিখ (জন্ম নিবন্ধন অনুসারে)",-1)),t("div",Xe,[a.date_of_birth?(o(),i("div",Ze,e[32]||(e[32]=[t("i",{class:"fa fa-check-circle text-green-500"},null,-1)]))):g("",!0),u(t("input",{"onUpdate:modelValue":d=>a.input_dob=d,required:"",type:"text",placeholder:"DD/MM/YYYY",class:"input-1 border-r-0 rounded-r-none text-center",onBlur:d=>E(a),onKeyup:O(d=>E(a),["enter"])},null,40,He),[[v,a.input_dob]]),u(t("input",{onChange:d=>P(a),"onUpdate:modelValue":d=>a.date_of_birth=d,required:"",type:"date",class:"input-1 w-10 px-2 rounded-l-none"},null,40,Je),[[v,a.date_of_birth]])])]),t("div",Pe,[e[34]||(e[34]=t("p",{class:"md:hidden flex font-medium"},"পারার বিববরণ (হিফজের ক্ষেত্রে)",-1)),u(t("input",{"onUpdate:modelValue":d=>a.para=d,type:"text",class:"input-1",placeholder:"পারার বিবরণ"},null,8,Qe),[[v,a.para]])]),t("div",We,[e[35]||(e[35]=t("p",{class:"md:hidden flex font-medium"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)",-1)),u(t("input",{"onUpdate:modelValue":d=>a.address=d,type:"text",class:"input-1",placeholder:"গ্রাম, ডাকঘর, থানা, জেলা"},null,8,et),[[v,a.address]])]),t("div",tt,[t("button",{type:"button",onClick:d=>R(p),class:"btn-4 py-2"},e[36]||(e[36]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,at)])])]))),128)),t("div",{class:"flex justify-center"},[t("button",{type:"button",onClick:T,class:"btn-contrast"},e[37]||(e[37]=[t("i",{class:"fas fa-plus"},null,-1),_(" আরেকজন যুক্ত করুন ")]))])]),e[45]||(e[45]=t("hr",{class:"my-4"},null,-1)),j.value?(o(),i("div",st,[t("div",lt,[t("div",null," প্রতি পরীক্ষার্থীর ফি: "+r(m(n).exam.registration_fee)+" টাকা। বিলম্ব ফি (প্রযোজ্য ক্ষেত্রে): "+r(m(n).exam.late_fee)+" টাকা। ",1),t("div",it,[e[39]||(e[39]=_(" পরীক্ষার্থীর সংখ্যা:")),t("b",null,r(l.value.students.length),1),e[40]||(e[40]=_(" X ")),t("b",null,r(j.value),1),e[41]||(e[41]=_(" টাকা = ")),t("b",null,r(l.value.students.length*j.value)+" টাকা",1)])]),g("",!0),t("button",{type:"submit",disabled:D.value,class:"btn-2"},r(D.value?"সাবমিট হচ্ছে...":"সাবমিট করুন"),9,ot)])):g("",!0),t("div",nt,[$.value?(o(),i("div",dt,r($.value),1)):g("",!0),V.value?(o(),i("div",rt,r(V.value),1)):g("",!0)])],32)])])}}};export{gt as default};
