import{B as se,r,i as le,C as L,o as oe,c as u,a as e,f as T,w as ne,j as m,D as k,F as P,e as S,b as v,s as ue,v as $,G as K,h as c,m as de,t as o,k as D,l as ae,d as n,n as R,L as re}from"./index-DXxrbR31.js";import{_ as ve}from"./ApplicationStatusModal-Cwyrx1yp.js";import{u as ie}from"./application-Ce0Jqh45.js";import{u as xe}from"./zamat-BeKk-UwW.js";const me={class:"space-y-2 px-6 py-4"},ye={class:"md:flex justify-between items-center"},ge={class:"card-bg p-4 grid md:grid-cols-7 gap-4"},be=["value"],fe={class:"relative"},_e={class:"relative"},pe=["value"],ce={key:1},he={class:"overflow-x-auto bg-white shadow-md rounded-lg"},ke={class:"min-w-full table-auto"},we={class:"text-gray-700 text-sm font-light"},Ce={class:"py-3 px-4 text-left"},Ne={class:"font-medium"},De={class:"py-3 px-4 text-center"},Pe={class:"py-3 px-4 text-center"},Se={class:"py-3 px-4 text-left"},Ve={class:"py-3 px-4 text-left"},Ae={class:"py-3 px-4 text-left"},Me={class:"py-3 px-4 text-center"},Le={class:"py-3 px-4 text-right"},Ue={class:"py-3 px-4 text-center"},Fe={class:"py-3 px-4 text-center"},je={class:"py-3 px-4 text-left"},ze={class:"py-3 px-4 text-center"},Be={class:"flex items-center justify-end gap-2"},Ee=["href"],Ie=["onClick"],Oe=["onClick"],Te={key:1},$e={class:"flex justify-center"},Ke={key:0,class:"mt-2 text-right text-sm font-semibold"},Re={key:2,class:"flex justify-between items-center mt-4"},Ze=["disabled"],Ge={class:"flex items-center gap-2"},qe=["value"],He=["disabled"],Je={key:3,class:"fixed inset-0 z-50 flex items-center justify-center"},Qe={class:"relative bg-white rounded-lg shadow p-6 w-[90%] max-w-md"},We={class:"text-sm text-gray-600 mb-4"},Xe={class:"flex justify-end gap-2"},Ye=["disabled"],et=["disabled"],ut={__name:"ApplicationList",setup(tt){const y=se(),U=xe(),d=ie(),F=r(null),g=r(""),h=r(""),b=r(""),f=r(null),_=r("all"),p=r("all"),i=r(15),a=r(1),V=r(!0),A=r(!1),w=r(null),C=r(!1),j=l=>Number(l??0).toLocaleString("bn-BD",{minimumFractionDigits:2,maximumFractionDigits:2}),Z=le(()=>(d.applications||[]).reduce((s,N)=>s+Number((N==null?void 0:N.total_amount)??0),0)),G=l=>{F.value=l,d.showStatusModal=!0},z=()=>{d.showStatusModal=!1},q=async()=>{await x(),z()},H=()=>{const l={};return i.value==="all"?l.per_page="all":(l.per_page=Number(i.value)||15,l.page=Number(a.value)||1),f.value&&(l.exam_id=f.value),h.value&&(l.zamat_id=h.value),g.value&&(l.institute_code=g.value),b.value&&(l.application_id=b.value),_.value&&_.value!=="all"&&(l.payment_method=_.value),p.value&&p.value!=="all"&&(l.status=p.value),l},x=async()=>{V.value=!0,await d.fetchApplications(H()),V.value=!1},J=()=>{var s;const l=((s=d.pagination)==null?void 0:s.last_page)||1;a.value<l&&(a.value+=1)},Q=()=>{a.value>1&&(a.value-=1)},W=l=>{if(i.value==="all")return l+1;const s=Number(i.value)||15;return(Number(a.value)-1)*s+l+1},X=l=>{w.value=l,A.value=!0},M=()=>{A.value=!1,w.value=null},Y=async()=>{w.value&&(C.value=!0,await d.deleteApplication(w.value.id),C.value=!1,M(),i.value!=="all"&&d.applications.length===0&&a.value>1&&(a.value=a.value-1),await x())};return L([h,b,g,f,_,p],()=>{a.value=1}),L(i,()=>{a.value=1}),L([a,i,h,b,g,f,_,p],x),oe(async()=>{var l;await Promise.all([y.fetchLastExam(),y.fetchExams(),U.fetchZamats()]),(l=y==null?void 0:y.exam)!=null&&l.id&&(f.value=y.exam.id),await x()}),(l,s)=>{var B,E,I,O;const N=ae("RouterLink");return n(),u("div",me,[e("div",ye,[s[9]||(s[9]=e("h1",{class:"title-lg"},"নিবন্ধন তালিকা",-1)),T(N,{to:{name:"ApplicationForm"},class:"btn-2"},{default:ne(()=>s[8]||(s[8]=[D(" নতুন নিবন্ধন যুক্ত করুন ")])),_:1})]),e("div",ge,[e("div",null,[s[11]||(s[11]=e("p",null,"পরীক্ষা",-1)),m(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>f.value=t),class:"text-black input-1 px-2 py-1"},[s[10]||(s[10]=e("option",{disabled:"",value:""},"- পরীক্ষার তালিকা -",-1)),(n(!0),u(P,null,S(v(y).exams,t=>(n(),u("option",{key:t.id,value:t.id},o(t.name),9,be))),128))],512),[[k,f.value]])]),e("div",null,[s[13]||(s[13]=e("p",null,"প্রতি পৃষ্ঠায় নিবন্ধন সংখ্যা",-1)),m(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>i.value=t),class:"text-black input-1 px-2 py-1"},s[12]||(s[12]=[ue('<option value="15">15</option><option value="25">25</option><option value="50">50</option><option value="100">100</option><option value="all">All</option>',5)]),512),[[k,i.value]])]),e("div",null,[s[15]||(s[15]=e("p",null,"নিবন্ধন নাম্বার দিয়ে খুঁজুন",-1)),e("div",fe,[m(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>b.value=t),type:"text",class:"input-1 w-full text-black px-3 py-1",placeholder:"নিবন্ধন নং",onKeyup:K(x,["enter"])},null,544),[[$,b.value]]),b.value?(n(),u("button",{key:0,onClick:x,class:"absolute right-3 top-2"},s[14]||(s[14]=[e("i",{class:"fas fa-search"},null,-1)]))):c("",!0)])]),e("div",null,[s[17]||(s[17]=e("p",null,"ইলহাক নাম্বার দিয়ে খুঁজুন",-1)),e("div",_e,[m(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>g.value=t),type:"text",class:"input-1 w-full text-black px-3 py-1",placeholder:"ইলহাক নং",onKeyup:K(x,["enter"])},null,544),[[$,g.value]]),g.value?(n(),u("button",{key:0,onClick:x,class:"absolute right-3 top-2"},s[16]||(s[16]=[e("i",{class:"fas fa-search"},null,-1)]))):c("",!0)])]),e("div",null,[s[19]||(s[19]=e("p",null,"মারহালা অনুসারে খুঁজুন",-1)),m(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>h.value=t),class:"text-black input-1 px-2 py-1"},[s[18]||(s[18]=e("option",{value:""},"- সকল মারহালা -",-1)),(n(!0),u(P,null,S(v(U).zamats,t=>(n(),u("option",{key:t.id,value:t.id},o(t.name),9,pe))),128))],512),[[k,h.value]])]),e("div",null,[s[21]||(s[21]=e("p",null,"পেমেন্ট মেথড",-1)),m(e("select",{"onUpdate:modelValue":s[5]||(s[5]=t=>_.value=t),class:"text-black input-1 px-2 py-1"},s[20]||(s[20]=[e("option",{value:"all"},"- সব -",-1),e("option",{value:"Online"},"Online",-1),e("option",{value:"Offline"},"Offline",-1)]),512),[[k,_.value]])]),e("div",null,[s[23]||(s[23]=e("p",null,"পেমেন্ট স্ট্যাটাস",-1)),m(e("select",{"onUpdate:modelValue":s[6]||(s[6]=t=>p.value=t),class:"text-black input-1 px-2 py-1"},s[22]||(s[22]=[e("option",{value:"all"},"- সব -",-1),e("option",{value:"Paid"},"Paid",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Failed"},"Failed",-1)]),512),[[k,p.value]])])]),V.value?(n(),de(re,{key:0})):(n(),u("div",ce,[e("div",he,[e("table",ke,[s[29]||(s[29]=e("thead",{class:"bg-gray-400 text-white uppercase text-sm leading-normal"},[e("tr",null,[e("th",{class:"py-3 px-4 text-left"},"ক্র"),e("th",{class:"py-3 px-4 text-center"},"তারিখ"),e("th",{class:"py-3 px-4 text-center"},"নিবন্ধন নং"),e("th",{class:"py-3 px-4 text-left"},"ইলহাক ও মাদরাসার নাম"),e("th",{class:"py-3 px-4 text-left"},"অঞ্চল"),e("th",{class:"py-3 px-4 text-left"},"মারহালা"),e("th",{class:"py-3 px-4 text-center"},"পরীক্ষার্থী সংখ্যা"),e("th",{class:"py-3 px-4 text-right"},"টাকা"),e("th",{class:"py-3 px-4 text-center"},"পেমেন্ট মেথড"),e("th",{class:"py-3 px-4 text-center"},"পেমেন্ট স্ট্যাটাস"),e("th",{class:"py-3 px-4 text-center"},"ইউজার"),e("th",{class:"py-3 px-4 text-center"},"Actions")])],-1)),e("tbody",we,[v(d).applications&&v(d).applications.length?(n(!0),u(P,{key:0},S(v(d).applications,(t,ee)=>(n(),u("tr",{key:t.id,class:"border-b border-gray-200 hover:bg-gray-100 font-medium"},[e("td",Ce,[e("p",Ne,o(W(ee)),1)]),e("td",De,o(new Date(t==null?void 0:t.application_date).toLocaleDateString("bn-BD")),1),e("td",Pe,o(t==null?void 0:t.id),1),e("td",Se,[e("div",null,o(t==null?void 0:t.institute_code_name),1),e("div",null,[s[24]||(s[24]=e("strong",null,"কেন্দ্র: ",-1)),e("span",{class:R(t!=null&&t.center_name?"":"text-red-500")},o((t==null?void 0:t.center_name)||"নির্বাচন করা নেই"),3)])]),e("td",Ve,o(t==null?void 0:t.area_name),1),e("td",Ae,o(t==null?void 0:t.zamat_name),1),e("td",Me,o(t==null?void 0:t.student_count)+" জন",1),e("td",Le,o(j(t==null?void 0:t.total_amount)),1),e("td",Ue,o(t==null?void 0:t.payment_method),1),e("td",Fe,[e("span",{class:R([{"text-yellow-700 bg-yellow-100":(t==null?void 0:t.payment_status)==="Pending","text-green-700 bg-green-100":(t==null?void 0:t.payment_status)==="Paid","text-red-700 bg-red-100":(t==null?void 0:t.payment_status)==="Failed"},"py-1 px-2 rounded-full text-xs"])},o(t==null?void 0:t.payment_status),3)]),e("td",je,[e("div",null,[s[25]||(s[25]=e("strong",null,"প্রেরণ: ",-1)),D(o((t==null?void 0:t.submitted_by_name)||"N/A"),1)]),s[27]||(s[27]=e("hr",null,null,-1)),e("div",null,[s[26]||(s[26]=e("strong",null,"গ্রহণ: ",-1)),D(o((t==null?void 0:t.approved_by_name)||"N/A"),1)])]),e("td",ze,[e("div",Be,[e("a",{href:`/applications/${t.id}`,class:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",target:"_blank",rel:"noopener noreferrer"}," দেখুন ",8,Ee),(t==null?void 0:t.payment_status)==="Pending"?(n(),u("button",{key:0,onClick:te=>G(t.id),class:"px-3 py-1 rounded bg-emerald-600 text-white hover:bg-emerald-700"}," গ্রহণ ",8,Ie)):c("",!0),(t==null?void 0:t.payment_status)!=="Paid"?(n(),u("button",{key:1,onClick:te=>X(t),class:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",title:"ডিলিট"}," মুছুন ",8,Oe)):c("",!0)])])]))),128)):(n(),u("tr",Te,s[28]||(s[28]=[e("td",{colspan:"12",class:"text-center text-red-500 py-6"},"No applications found",-1)])))])])]),e("div",$e,[v(d).applications&&v(d).applications.length?(n(),u("div",Ke," এই পৃষ্ঠায় মোট টাকা: "+o(j(Z.value))+" ৳ ",1)):c("",!0)])])),i.value!=="all"?(n(),u("div",Re,[e("button",{class:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50",disabled:a.value===1,onClick:Q}," Prev ",8,Ze),e("div",Ge,[s[30]||(s[30]=e("span",null,"Page",-1)),m(e("select",{"onUpdate:modelValue":s[7]||(s[7]=t=>a.value=t),class:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300"},[(n(!0),u(P,null,S(((B=v(d).pagination)==null?void 0:B.last_page)||1,t=>(n(),u("option",{key:t,value:t},o(t),9,qe))),128))],512),[[k,a.value]]),e("span",null,"of "+o(((E=v(d).pagination)==null?void 0:E.last_page)||1),1)]),e("button",{class:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50",disabled:a.value===(((I=v(d).pagination)==null?void 0:I.last_page)||1),onClick:J}," Next ",8,He)])):c("",!0),T(ve,{show:v(d).showStatusModal,"application-id":F.value,onClose:z,onDataUpdated:q},null,8,["show","application-id"]),A.value?(n(),u("div",Je,[e("div",{class:"absolute inset-0 bg-black/40",onClick:M}),e("div",Qe,[s[33]||(s[33]=e("h3",{class:"text-lg font-semibold mb-2"},"নিশ্চিত করবেন?",-1)),e("p",We,[s[31]||(s[31]=D(" আবেদন ")),e("strong",null,"#"+o((O=w.value)==null?void 0:O.id),1),s[32]||(s[32]=D(" স্থায়ীভাবে মুছে ফেলা হবে। এই কাজটি ফিরিয়ে আনা যাবে না। "))]),e("div",Xe,[e("button",{class:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:M,disabled:C.value}," বাতিল ",8,Ye),e("button",{class:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-50",onClick:Y,disabled:C.value},o(C.value?"মুছছে...":"ডিলিট"),9,et)])])])):c("",!0)])}}};export{ut as default};
