import{_ as I,i as $,d as m,c as p,a as t,k as u,F as B,e as F,t as i,h as T,n as D,f as h,w as L,l as U,o as M,j as d,v as b,b as n,D as c,G as R}from"./index-DXxrbR31.js";import{u as j}from"./application-payment-Cud7D5Xo.js";const z={class:"rounded-2xl border border-slate-200 bg-white"},E={key:0,class:"p-8 text-center text-slate-500"},K={key:1,class:"p-8 text-center text-slate-500"},Z={key:2,class:"overflow-x-auto"},q={class:"w-full min-w-[900px] border-separate border-spacing-0"},G={class:"td font-medium text-slate-700"},O={class:"td font-mono text-sm"},X={class:"td"},H={class:"flex flex-col"},J={class:"font-medium text-slate-700"},Q={class:"text-xs text-slate-500"},W={key:0},Y={class:"td"},tt={class:"td"},et={class:"td text-right font-semibold"},st={class:"td"},lt={class:"td"},nt={class:"td"},at={class:"flex flex-col"},ot={class:"text-xs text-slate-400"},it={class:"td"},dt={class:"flex flex-wrap items-center justify-between gap-3 border-t border-slate-100 p-3"},rt={class:"flex flex-col gap-0.5 text-sm text-slate-500"},ut={class:"font-medium text-slate-700"},mt={class:"font-medium text-slate-700"},pt={class:"font-semibold text-slate-700"},ft={class:"flex items-center gap-2"},bt=["disabled"],xt={class:"text-sm text-slate-600"},ct={class:"font-medium"},vt={class:"font-medium"},gt=["disabled"],yt={__name:"PaymentsTable",props:{rows:{type:Array,default:()=>[]},meta:{type:Object,default:()=>({})},isLoading:{type:Boolean,default:!1},hasNext:{type:Boolean,default:!1},hasPrev:{type:Boolean,default:!1}},emits:["view","next","prev","reload"],setup(r){const l=r,f=$(()=>(l.rows||[]).reduce((s,x)=>s+Number((x==null?void 0:x.amount)??0),0));function v(o){return o==null?"—":Number(o).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}function y(o){const s=(o==null?void 0:o.meta)||{};return Number(s.students??s.students_count??0)}function g(o){if(!o)return"—";const s=new Date(o);return isNaN(s)?o:s.toLocaleString("en-GB")}function w(o){const s="inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium";switch((o||"").toLowerCase()){case"completed":case"paid":return s+" bg-emerald-100 text-emerald-700";case"pending":return s+" bg-amber-100 text-amber-700";case"failed":case"cancelled":return s+" bg-rose-100 text-rose-700";default:return s+" bg-slate-100 text-slate-700"}}function e(o){const s="inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium";return(o||"").toLowerCase()==="bkash"?s+" bg-fuchsia-100 text-fuchsia-700":o==="Bank"?s+" bg-blue-100 text-blue-700":s+" bg-slate-100 text-slate-700"}return(o,s)=>{var P,_,k,A;const x=U("RouterLink");return m(),p("section",z,[r.isLoading?(m(),p("div",E,s[2]||(s[2]=[t("span",{class:"loading-spinner mr-2"},null,-1),u(" Loading payments... ")]))):(P=r.rows)!=null&&P.length?(m(),p("div",Z,[t("table",q,[s[4]||(s[4]=t("thead",null,[t("tr",{class:"bg-slate-50 text-left text-sm text-slate-600"},[t("th",{class:"th"},"ID"),t("th",{class:"th"},"TRX"),t("th",{class:"th"},"Institute"),t("th",{class:"th"},"Zamat"),t("th",{class:"th"},"Students"),t("th",{class:"th text-right"},"Amount"),t("th",{class:"th"},"Method"),t("th",{class:"th"},"Status"),t("th",{class:"th"},"Paid At"),t("th",{class:"th"},"Actions")])],-1)),t("tbody",null,[(m(!0),p(B,null,F(r.rows,a=>{var C,V,N,S;return m(),p("tr",{key:a.id,class:"border-b border-slate-100 hover:bg-slate-50"},[t("td",G,"#"+i(a.id),1),t("td",O,i(a.trx_id||"—"),1),t("td",X,[t("div",H,[t("span",J,i(((C=a==null?void 0:a.institute)==null?void 0:C.name)||"—"),1),t("span",Q,[u(i(((V=a==null?void 0:a.institute)==null?void 0:V.institute_code)||"")+" ",1),(N=a==null?void 0:a.institute)!=null&&N.phone?(m(),p("span",W," • "+i(a.institute.phone),1)):T("",!0)])])]),t("td",Y,i(((S=a==null?void 0:a.zamat)==null?void 0:S.name)||"—"),1),t("td",tt,i(y(a)||"—")+" জন",1),t("td",et,i(v(a.amount)),1),t("td",st,[t("span",{class:D(["badge",e(a.payment_method)])},i(a.payment_method),3)]),t("td",lt,[t("span",{class:D(["badge",w(a.status)])},i(a.status),3)]),t("td",nt,[t("div",at,[t("span",null,i(g(a.paid_at)),1),t("span",ot,"c: "+i(g(a.created_at)),1)])]),t("td",it,[h(x,{to:{name:"ApplicationPaymentInvoice",params:{paymentId:a.id}},class:"inline-flex items-center rounded-lg border border-slate-300 px-3 py-1.5 text-sm hover:bg-slate-50"},{default:L(()=>s[3]||(s[3]=[u(" View Invoice ")])),_:2},1032,["to"])])])}),128))])]),t("div",dt,[t("div",rt,[t("div",null,[s[5]||(s[5]=u(" Showing ")),t("span",ut,i(r.rows.length),1),s[6]||(s[6]=u(" of ")),t("span",mt,i(((_=r.meta)==null?void 0:_.total)??0),1),s[7]||(s[7]=u(" results "))]),t("div",null,[s[8]||(s[8]=u(" Page total amount: ")),t("span",pt,i(v(f.value)),1)])]),t("div",ft,[t("button",{class:"btn-ghost",disabled:!r.hasPrev,onClick:s[0]||(s[0]=a=>o.$emit("prev"))},"‹ Prev",8,bt),t("span",xt,[s[9]||(s[9]=u(" Page ")),t("span",ct,i(((k=r.meta)==null?void 0:k.current_page)??1),1),s[10]||(s[10]=u(" / ")),t("span",vt,i(((A=r.meta)==null?void 0:A.last_page)??1),1)]),t("button",{class:"btn-ghost",disabled:!r.hasNext,onClick:s[1]||(s[1]=a=>o.$emit("next"))},"Next ›",8,gt)])])])):(m(),p("div",K,"No payments found."))])}}},wt=I(yt,[["__scopeId","data-v-fdf4119a"]]),ht={class:"p-4 sm:p-6"},Pt={class:"mb-5 flex flex-wrap items-center justify-between gap-3"},_t={class:"flex items-center gap-2"},kt={class:"mb-5 rounded-2xl border border-slate-200 bg-white p-4"},At={class:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-4"},Ct={class:"md:col-span-2 lg:col-span-2"},Vt={__name:"ApplicationPayments",setup(r){const l=j();async function f(){l.setPage(1),await l.fetchPayments()}async function v(){await l.nextPage()}async function y(){await l.prevPage()}function g(){l.resetFilters(),f()}return M(f),(w,e)=>{const o=U("RouterLink");return m(),p("div",ht,[t("header",Pt,[e[13]||(e[13]=t("div",null,[t("h1",{class:"text-xl font-semibold text-slate-800"},"Application Payments"),t("p",{class:"text-sm text-slate-500"},"Search, filter and review payment records.")],-1)),t("div",_t,[h(o,{to:{name:"ApplicationPaymentCreate"},class:"btn-primary"},{default:L(()=>e[12]||(e[12]=[t("i",{class:"far fa-plus-circle mr-1"},null,-1),u(" New Payment ")])),_:1})])]),t("section",kt,[t("div",At,[t("div",null,[e[14]||(e[14]=t("label",{class:"label"},"Exam",-1)),d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>n(l).filters.exam_id=s),type:"number",placeholder:"Exam ID",class:"input"},null,512),[[b,n(l).filters.exam_id]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"label"},"Institute",-1)),d(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>n(l).filters.institute_id=s),type:"number",placeholder:"Institute ID",class:"input"},null,512),[[b,n(l).filters.institute_id]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"label"},"Zamat",-1)),d(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>n(l).filters.zamat_id=s),type:"number",placeholder:"Zamat ID",class:"input"},null,512),[[b,n(l).filters.zamat_id]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"label"},"Application",-1)),d(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>n(l).filters.application_id=s),type:"number",placeholder:"Application ID",class:"input"},null,512),[[b,n(l).filters.application_id]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"label"},"Status",-1)),d(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>n(l).filters.status=s),class:"input"},e[18]||(e[18]=[t("option",{value:"all"},"All",-1),t("option",null,"Completed",-1),t("option",null,"Pending",-1),t("option",null,"Failed",-1),t("option",null,"Cancelled",-1)]),512),[[c,n(l).filters.status]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"label"},"Method",-1)),d(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>n(l).filters.method=s),class:"input"},e[20]||(e[20]=[t("option",{value:"all"},"All",-1),t("option",{value:"bkash"},"bKash",-1),t("option",{value:"Bank"},"Bank",-1),t("option",{value:"Cash Payment"},"Cash Payment",-1)]),512),[[c,n(l).filters.method]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"label"},"From",-1)),d(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>n(l).filters.date_from=s),type:"date",class:"input"},null,512),[[b,n(l).filters.date_from]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"label"},"To",-1)),d(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>n(l).filters.date_to=s),type:"date",class:"input"},null,512),[[b,n(l).filters.date_to]])]),t("div",Ct,[e[24]||(e[24]=t("label",{class:"label"},"Search",-1)),d(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>n(l).filters.q=s),type:"text",placeholder:"Search trx id / msisdn / institute...",class:"input",onKeyup:R(f,["enter"])},null,544),[[b,n(l).filters.q]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"label"},"Sort",-1)),d(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>n(l).filters.sort=s),class:"input"},e[25]||(e[25]=[t("option",{value:"paid_at"},"Paid At",-1),t("option",{value:"created_at"},"Created At",-1),t("option",{value:"amount"},"Amount",-1),t("option",{value:"id"},"ID",-1)]),512),[[c,n(l).filters.sort]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"label"},"Order",-1)),d(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>n(l).filters.order=s),class:"input"},e[27]||(e[27]=[t("option",{value:"desc"},"DESC",-1),t("option",{value:"asc"},"ASC",-1)]),512),[[c,n(l).filters.order]])]),t("div",null,[e[30]||(e[30]=t("label",{class:"label"},"Per Page",-1)),d(t("select",{"onUpdate:modelValue":e[11]||(e[11]=s=>n(l).filters.per_page=s),class:"input"},e[29]||(e[29]=[t("option",{value:10},"10",-1),t("option",{value:20},"20",-1),t("option",{value:50},"50",-1),t("option",{value:100},"100",-1),t("option",{value:"all"},"All",-1)]),512),[[c,n(l).filters.per_page]])]),t("div",{class:"flex gap-4 items-end"},[t("button",{class:"btn-primary w-full",onClick:f},"Apply Filters"),t("button",{class:"btn-ghost",onClick:g},"Reset")])])]),h(wt,{rows:n(l).rows,meta:n(l).meta,"is-loading":n(l).isLoading,"has-next":n(l).hasNext,"has-prev":n(l).hasPrev,onReload:f,onNext:v,onPrev:y,onView:w.openDetails},null,8,["rows","meta","is-loading","has-next","has-prev","onView"])])}}},Dt=I(Vt,[["__scopeId","data-v-81cb44fa"]]);export{Dt as default};
