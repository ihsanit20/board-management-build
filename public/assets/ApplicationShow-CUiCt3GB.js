import{E as pt,r as et,o as _t,B as V,c as l,b as n,a as t,t as d,y,h as v,j as c,C as g,F as m,e as f,n as ct,f as st,w as mt,q as yt,z as vt,d as o,v as k}from"./index-BdNQ5xTu.js";import{u as ft}from"./application-DAOrbGLu.js";import{u as bt}from"./institute-Dxs1ZzfF.js";import{u as gt}from"./group-CW-uwCiQ.js";import{u as kt}from"./area-Dn_E4pif.js";import{u as xt}from"./zamat-BJF4s1Bc.js";import{u as ht}from"./center-CteqrzPw.js";import{_ as St}from"./ApplicationStatusModal-Dl9FmKB2.js";const wt={class:"my-container space-y-4"},Vt={key:0,class:"flex justify-center items-center"},Ut={key:1,class:"card-bg p-4 md:p-8 space-y-4"},Ct={class:"space-y-4"},Dt={class:"relative"},zt={class:"flex flex-col justify-center items-center"},Pt={class:"title-md text-center"},At={class:"absolute top-0 right-0"},Et={class:"space-y-2"},Rt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Bt={key:0},Ft=["value"],Mt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},jt={class:"space-y-2"},qt={class:"flex gap-4"},Gt={key:0},It={key:0},Lt=["disabled"],Nt=["value"],Tt={key:0},Zt=["disabled"],$t=["value"],Ht={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Jt={key:0},Kt=["label"],Ot=["value"],Qt={key:0},Wt=["disabled"],Xt=["value"],Yt={key:0},te={class:"relative"},ee={class:"absolute top-0 right-0"},se={class:"overflow-x-auto"},ae={class:"table-auto w-full text-left border-collapse"},le={class:"border px-4 py-2"},oe={class:"border px-4 py-2"},ne={key:0},ie=["onUpdate:modelValue"],de={class:"border px-4 py-2"},ue={key:0},re=["onUpdate:modelValue"],pe={class:"border px-4 py-2"},_e={key:0},ce=["onUpdate:modelValue"],me={class:"border px-4 py-2"},ye={key:0},ve=["onUpdate:modelValue"],fe={class:"border px-4 py-2"},be={key:0},ge=["onUpdate:modelValue"],ke={key:0,class:"flex justify-between gap-4"},xe={key:2,class:"text-center text-red-500"},Ee={__name:"ApplicationShow",setup(he){const b=ft(),U=kt(),C=bt(),S=gt(),D=xt(),w=ht(),x=yt().params.id,{application:a,loading:at}=pt(b),u=et(!1),p=et(!1),h=async()=>{try{await Promise.all([b.fetchApplication(x),U.fetchAreas(),D.fetchZamats(),S.fetchGroups(),w.fetchCenters()])}catch(i){console.error("Failed to load application:",i)}};_t(h),V(()=>{var i;return(i=a.value)==null?void 0:i.area_id},async i=>{i&&await C.fetchInstitutes({area_id:i,per_page:"all"})}),V(()=>{var i;return(i=a.value)==null?void 0:i.zamat_id},async i=>{i&&(await S.fetchGroups(i),z())}),V(()=>{var i;return(i=a.value)==null?void 0:i.group_id},async i=>{i&&z()});const z=async()=>{var i,e;(i=a.value)!=null&&i.zamat_id&&((e=a.value)!=null&&e.group_id)&&await w.fetchCenters({zamat_id:a.value.zamat_id,group_id:a.value.group_id})},lt=()=>{u.value=!u.value},ot=()=>{p.value=!p.value},nt=async()=>{try{const i={exam_id:a.value.exam_id,institute_id:a.value.institute_id,zamat_id:a.value.zamat_id,group_id:a.value.group_id,area_id:a.value.area_id,center_id:a.value.center_id};await b.updateRegistrationPart(x,i),console.log("Registration updated successfully"),await h()}catch(i){console.error("Failed to update registration part:",i.message)}finally{u.value=!1}},it=async()=>{try{const i={students:a.value.students};await b.updateStudentsPart(x,i),console.log("Students updated successfully"),await h()}catch(i){console.error("Failed to update students part:",i.message)}finally{p.value=!1}},dt=()=>{b.showStatusModal=!0},ut=async()=>{await h()};return(i,e)=>{var P,A,E,R,B,F,M,j,q,G,I,L,N,T,Z,$,H,J,K,O,Q,W,X,Y,tt;const rt=vt("router-link");return o(),l("div",wt,[n(at)?(o(),l("div",Vt,e[5]||(e[5]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-gray-900"},null,-1)]))):n(a)?(o(),l("div",Ut,[t("div",Ct,[t("div",Dt,[t("div",zt,[t("h4",Pt,d((A=(P=n(a))==null?void 0:P.exam)==null?void 0:A.name),1),e[6]||(e[6]=t("h1",{class:"title-lg text-center"},"নিবন্ধনের বিস্তারিত",-1))]),t("div",At,[!u.value&&((E=n(a))==null?void 0:E.payment_status)!=="Paid"?(o(),l("button",{key:0,class:"btn-3",onClick:lt},e[7]||(e[7]=[t("i",{class:"fas fa-edit"},null,-1),y(),t("span",{class:"hidden md:flex"},"Edit",-1)]))):v("",!0),u.value&&((R=n(a))==null?void 0:R.payment_status)!=="Paid"?(o(),l("button",{key:1,class:"btn-2",onClick:nt},e[8]||(e[8]=[t("i",{class:"fas fa-save"},null,-1),y(),t("span",{class:"hidden md:flex"},"Save",-1)]))):v("",!0)])]),t("div",Et,[e[18]||(e[18]=t("hr",null,null,-1)),t("div",Rt,[t("div",null,[e[9]||(e[9]=t("b",null,"নিবন্ধন নং:",-1)),t("p",null,d(n(a).id),1)]),t("div",null,[e[10]||(e[10]=t("b",null,"নিবন্ধনের তারিখ:",-1)),t("p",null,d(new Date(n(a).created_at).toLocaleDateString("bn-BD"))+" ইং",1)]),t("div",null,[e[12]||(e[12]=t("b",null,"অঞ্চল:",-1)),u.value?c((o(),l("select",{key:1,"onUpdate:modelValue":e[0]||(e[0]=s=>n(a).area_id=s),class:"input-1"},[e[11]||(e[11]=t("option",{value:"",disabled:""},"Select Area",-1)),(o(!0),l(m,null,f(n(U).areas,s=>(o(),l("option",{key:s.id,value:s.id},d(s.name),9,Ft))),128))],512)),[[g,n(a).area_id]]):(o(),l("p",Bt,d((F=(B=n(a))==null?void 0:B.area)==null?void 0:F.name),1))])]),e[19]||(e[19]=t("hr",null,null,-1)),t("div",Mt,[t("div",jt,[t("div",qt,[u.value?v("",!0):(o(),l("div",Gt,[e[13]||(e[13]=t("b",null,"ইলহাক:",-1)),t("p",null,d((j=(M=n(a))==null?void 0:M.institute)==null?void 0:j.institute_code),1)])),t("div",null,[e[15]||(e[15]=t("b",null,"শিক্ষা প্রতিষ্ঠানের নাম ও ঠিকানা:",-1)),u.value?c((o(),l("select",{key:1,"onUpdate:modelValue":e[1]||(e[1]=s=>n(a).institute_id=s),class:"input-1",disabled:!n(a).area_id,required:""},[e[14]||(e[14]=t("option",{value:"",disabled:""},"Select Institute",-1)),(o(!0),l(m,null,f(n(C).institutes,s=>(o(),l("option",{key:s.id,value:s.id},d(s.institute_code)+" - "+d(s.name),9,Nt))),128))],8,Lt)),[[g,n(a).institute_id]]):(o(),l("p",It,d((G=(q=n(a))==null?void 0:q.institute)==null?void 0:G.name),1))])])]),t("div",null,[e[17]||(e[17]=t("b",null,"কেন্দ্র:",-1)),u.value?c((o(),l("select",{key:1,"onUpdate:modelValue":e[2]||(e[2]=s=>n(a).center_id=s),class:"input-1",disabled:!n(a).zamat_id,required:""},[e[16]||(e[16]=t("option",{value:"",disabled:""},"Select Center",-1)),(o(!0),l(m,null,f(n(w).centers,s=>{var r;return o(),l("option",{key:s.id,value:s==null?void 0:s.institute_id},d((r=s==null?void 0:s.institute)==null?void 0:r.name),9,$t)}),128))],8,Zt)),[[g,n(a).center_id]]):(o(),l("p",Tt,d(((L=(I=n(a))==null?void 0:I.center)==null?void 0:L.name)||"নির্বাচন করা নেই"),1))])])]),e[29]||(e[29]=t("hr",null,null,-1)),t("div",Ht,[t("div",null,[e[21]||(e[21]=t("b",null,"মারহালা:",-1)),u.value?c((o(),l("select",{key:1,"onUpdate:modelValue":e[3]||(e[3]=s=>n(a).zamat_id=s),class:"input-1",required:""},[e[20]||(e[20]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(o(!0),l(m,null,f(n(D).departments,s=>(o(),l("optgroup",{label:s.name,key:s.id},[(o(!0),l(m,null,f(s.zamats,r=>(o(),l("option",{key:r.id,value:r.id},d(r.name),9,Ot))),128))],8,Kt))),128))],512)),[[g,n(a).zamat_id]]):(o(),l("p",Jt,d((T=(N=n(a))==null?void 0:N.zamat)==null?void 0:T.name),1))]),t("div",null,[e[24]||(e[24]=t("b",null,"গ্রুপ:",-1)),u.value?c((o(),l("select",{key:1,"onUpdate:modelValue":e[4]||(e[4]=s=>n(a).group_id=s),class:"input-1",disabled:!n(a).zamat_id},[e[23]||(e[23]=t("option",{value:"",disabled:""},"Select Group",-1)),(o(!0),l(m,null,f(n(S).groups,s=>(o(),l("option",{key:s.id,value:s.id},[y(d(s.name)+" (",1),(o(!0),l(m,null,f(s.areas,(r,_)=>(o(),l(m,{key:r.id},[_?(o(),l("span",Yt,", ")):v("",!0),t("span",null,d(r.name),1)],64))),128)),e[22]||(e[22]=y(") "))],8,Xt))),128))],8,Wt)),[[g,n(a).group_id]]):(o(),l("p",Qt,d((($=(Z=n(a))==null?void 0:Z.group)==null?void 0:$.name)||"প্রযোজ্য নয়"),1))]),t("div",null,[t("b",null,"টাকার পরিমাণ ("+d((H=n(a))==null?void 0:H.payment_method)+"):",1),t("p",null,[y(d((J=n(a))==null?void 0:J.total_amount)+" টাকা ",1),t("span",{class:ct([{"text-yellow-600 bg-yellow-200":((K=n(a))==null?void 0:K.payment_status)==="Pending","text-green-600 bg-green-200":((O=n(a))==null?void 0:O.payment_status)==="Paid","text-red-600 bg-red-200":((Q=n(a))==null?void 0:Q.payment_status)==="Failed"},"py-1 px-2 rounded-full text-xs"])},d((W=n(a))==null?void 0:W.payment_status),3)])])]),e[30]||(e[30]=t("hr",null,null,-1)),t("div",te,[e[27]||(e[27]=t("div",{class:"flex justify-center"},[t("h2",{class:"title-lg"},"পরীক্ষার্থীদের তথ্য")],-1)),t("div",ee,[!p.value&&((X=n(a))==null?void 0:X.payment_status)!=="Paid"?(o(),l("button",{key:0,class:"btn-3",onClick:ot},e[25]||(e[25]=[t("i",{class:"fas fa-edit"},null,-1),y(),t("span",{class:"hidden md:flex"},"Edit",-1)]))):v("",!0),p.value&&((Y=n(a))==null?void 0:Y.payment_status)!=="Paid"?(o(),l("button",{key:1,class:"btn-2",onClick:it},e[26]||(e[26]=[t("i",{class:"fas fa-save"},null,-1),y(),t("span",{class:"hidden md:flex"},"Save",-1)]))):v("",!0)])]),t("div",se,[t("table",ae,[e[28]||(e[28]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border px-4 py-2"},"#"),t("th",{class:"border px-4 py-2"},"নাম"),t("th",{class:"border px-4 py-2"},"পিতার নাম"),t("th",{class:"border px-4 py-2"},"জন্ম তারিখ"),t("th",{class:"border px-4 py-2"},"পারার বিবরণ"),t("th",{class:"border px-4 py-2"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)")])],-1)),t("tbody",null,[(o(!0),l(m,null,f(n(a).students,(s,r)=>(o(),l("tr",{key:r},[t("td",le,d(r+1),1),t("td",oe,[p.value?c((o(),l("input",{key:1,"onUpdate:modelValue":_=>s.name=_,type:"text",class:"input-1"},null,8,ie)),[[k,s.name]]):(o(),l("span",ne,d(s.name),1))]),t("td",de,[p.value?c((o(),l("input",{key:1,"onUpdate:modelValue":_=>s.father_name=_,type:"text",class:"input-1"},null,8,re)),[[k,s.father_name]]):(o(),l("span",ue,d(s.father_name),1))]),t("td",pe,[p.value?c((o(),l("input",{key:1,"onUpdate:modelValue":_=>s.date_of_birth=_,type:"date",class:"input-1"},null,8,ce)),[[k,s.date_of_birth]]):(o(),l("span",_e,d(new Date(s.date_of_birth).toLocaleDateString("bn-BD"))+" ইং",1))]),t("td",me,[p.value?c((o(),l("input",{key:1,"onUpdate:modelValue":_=>s.para=_,type:"text",class:"input-1"},null,8,ve)),[[k,s.para]]):(o(),l("span",ye,d(s.para||"প্রযোজ্য নয়"),1))]),t("td",fe,[p.value?c((o(),l("input",{key:1,"onUpdate:modelValue":_=>s.address=_,type:"text",class:"input-1"},null,8,ge)),[[k,s.address]]):(o(),l("span",be,d(s.address),1))])]))),128))])])])]),!u.value&&!p.value?(o(),l("div",ke,[st(rt,{to:{name:"ApplicationList"},class:"btn-2"},{default:mt(()=>e[31]||(e[31]=[y("তালিকায় যান")])),_:1}),e[32]||(e[32]=t("button",{onclick:"window.print()",class:"btn-3"},"প্রিন্ট করুন",-1)),((tt=n(a))==null?void 0:tt.payment_status)==="Pending"?(o(),l("button",{key:0,onClick:dt,class:"btn-contrast"}," নিবন্ধন গ্রহণ ")):v("",!0)])):v("",!0)])):(o(),l("div",xe,e[33]||(e[33]=[t("p",null,"Application not found.",-1)]))),st(St,{applicationId:n(x),onDataUpdated:ut},null,8,["applicationId"])])}}};export{Ee as default};
