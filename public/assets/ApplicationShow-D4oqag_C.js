import{H as ft,r as D,i as yt,o as bt,C as E,c as l,b as n,a as t,t as d,y as c,F as v,j as m,D as b,e as f,h as U,n as gt,f as lt,w as xt,q as kt,z as ht,d as i,v as G}from"./index-B-zjSs8V.js";import{u as St}from"./application-CiE-rKpu.js";import{u as wt}from"./institute-D9oKuuBR.js";import{u as zt}from"./group-BLKjL9De.js";import{u as Ct}from"./area-BN6AwnGW.js";import{u as Vt}from"./zamat-BpNHGMkI.js";import{u as Dt}from"./center-Cq_iwY-I.js";import{u as Ut}from"./para-group-CbBA1F74.js";import{_ as Gt}from"./ApplicationStatusModal-DXS3-9Xk.js";const Pt={class:"my-container space-y-4"},At={key:0,class:"flex justify-center items-center"},Et={key:1,class:"card-bg p-4 md:p-8 space-y-4"},Nt={class:"space-y-4"},Rt={class:"relative"},Mt={class:"flex flex-col justify-center items-center"},jt={class:"title-md text-center"},Bt={class:"absolute top-0 right-0 flex"},Ft={class:"space-y-2"},It={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},qt={key:0},Lt=["value"],Ot={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Tt={class:"space-y-2"},Jt={class:"flex gap-4"},$t={key:0},Ht={class:"flex-1"},Kt={key:0},Qt=["disabled"],Wt=["value"],Xt={key:0},Yt=["disabled"],Zt=["value"],te={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ee={key:0},ae=["label"],se=["value"],le={key:0},ie=["disabled"],oe=["value"],ne={key:0},de={class:"relative"},ue={class:"absolute top-0 right-0 flex"},re={class:"overflow-x-auto"},pe={class:"table-auto w-full text-left border-collapse"},_e={class:"border px-4 py-2"},ve={class:"border px-4 py-2"},ce={class:"border px-4 py-2"},me={key:0},fe=["onUpdate:modelValue"],ye={class:"border px-4 py-2"},be={key:0},ge=["onUpdate:modelValue"],xe={class:"border px-4 py-2"},ke={key:0},he=["onUpdate:modelValue"],Se={class:"border px-4 py-2"},we={key:0},ze=["onUpdate:modelValue","disabled"],Ce=["value"],Ve={class:"border px-4 py-2"},De={key:0},Ue=["onUpdate:modelValue"],Ge={key:0,class:"flex justify-between gap-4"},Pe={key:2,class:"text-center text-red-500"},Oe={__name:"ApplicationShow",setup(Ae){const x=kt().params.id,g=St(),N=Ct(),k=wt(),h=zt(),R=Vt(),M=Dt(),y=Ut(),{application:a,loading:it}=ft(g),u=D(!1),p=D(!1),S=D(null),w=D(null),P=o=>JSON.parse(JSON.stringify(o)),ot=yt(()=>{const o={};for(const e of y.paraGroups||[])o[e.id]=e.name;return o}),nt=o=>o?ot.value[o]||`ID: ${o}`:"প্রযোজ্য নয়",z=async()=>{var o,e;try{await Promise.all([g.fetchApplication(x),N.fetchAreas(),R.fetchZamats()]),(o=a.value)!=null&&o.area_id&&await k.fetchInstitutes({area_id:a.value.area_id,per_page:"all"}),await C(),(e=a.value)!=null&&e.zamat_id&&(await y.fetchParaGroups({zamat_id:a.value.zamat_id}),await h.fetchGroups(a.value.zamat_id))}catch(A){console.error("Failed to load application:",A)}};bt(z),E(()=>{var o;return(o=a.value)==null?void 0:o.area_id},async o=>{o&&await k.fetchInstitutes({area_id:o,per_page:"all"})}),E(()=>{var o;return(o=a.value)==null?void 0:o.zamat_id},async o=>{o?(await h.fetchGroups(o),await y.fetchParaGroups({zamat_id:o}),await C()):y.paraGroups=[]}),E(()=>{var o;return(o=a.value)==null?void 0:o.group_id},async o=>{o&&await C()});const C=async()=>{var o;(o=a.value)!=null&&o.zamat_id&&await M.fetchCenters({zamat_id:a.value.zamat_id,group_id:a.value.group_id})},dt=()=>{!u.value&&a.value&&(S.value=P({exam_id:a.value.exam_id,institute_id:a.value.institute_id,zamat_id:a.value.zamat_id,group_id:a.value.group_id,area_id:a.value.area_id,center_id:a.value.center_id})),u.value=!u.value},ut=()=>{!p.value&&a.value&&(w.value=P(a.value.students||[])),p.value=!p.value},rt=async()=>{S.value&&a.value&&(Object.assign(a.value,S.value),a.value.area_id&&await k.fetchInstitutes({area_id:a.value.area_id,per_page:"all"}),a.value.zamat_id&&(await h.fetchGroups(a.value.zamat_id),await y.fetchParaGroups({zamat_id:a.value.zamat_id})),await C()),u.value=!1},pt=()=>{w.value&&a.value&&(a.value.students=P(w.value)),p.value=!1},_t=async()=>{try{const o={exam_id:a.value.exam_id,institute_id:a.value.institute_id,zamat_id:a.value.zamat_id,group_id:a.value.group_id,area_id:a.value.area_id,center_id:a.value.center_id};await g.updateRegistrationPart(x,o),await z(),S.value=null}catch(o){console.error("Failed to update registration part:",(o==null?void 0:o.message)||o)}finally{u.value=!1}},vt=async()=>{try{const o={students:a.value.students};await g.updateStudentsPart(x,o),await z(),w.value=null}catch(o){console.error("Failed to update students part:",(o==null?void 0:o.message)||o)}finally{p.value=!1}},ct=()=>{g.showStatusModal=!0},mt=async()=>{await z()};return(o,e)=>{var j,B,F,I,q,L,O,T,J,$,H,K,Q,W,X,Y,Z,tt,et,at,st;const A=ht("router-link");return i(),l("div",Pt,[n(it)?(i(),l("div",At,e[5]||(e[5]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-gray-900"},null,-1)]))):n(a)?(i(),l("div",Et,[t("div",Nt,[t("div",Rt,[t("div",Mt,[t("h4",jt,d((B=(j=n(a))==null?void 0:j.exam)==null?void 0:B.name),1),e[6]||(e[6]=t("h1",{class:"title-lg text-center"},"নিবন্ধনের বিস্তারিত",-1))]),t("div",Bt,[u.value?(i(),l(v,{key:1},[t("button",{class:"btn-2",onClick:_t},e[8]||(e[8]=[t("i",{class:"fas fa-save"},null,-1),c(),t("span",{class:"hidden md:flex"},"Save",-1)])),t("button",{class:"btn-3 ml-2",onClick:rt},e[9]||(e[9]=[t("i",{class:"fas fa-times"},null,-1),c(),t("span",{class:"hidden md:flex"},"Cancel",-1)]))],64)):(i(),l("button",{key:0,class:"btn-3",onClick:dt},e[7]||(e[7]=[t("i",{class:"fas fa-edit"},null,-1),c(),t("span",{class:"hidden md:flex"},"Edit",-1)])))])]),t("div",Ft,[e[19]||(e[19]=t("hr",null,null,-1)),t("div",It,[t("div",null,[e[10]||(e[10]=t("b",null,"নিবন্ধন নং:",-1)),t("p",null,d(n(a).id),1)]),t("div",null,[e[11]||(e[11]=t("b",null,"নিবন্ধনের তারিখ:",-1)),t("p",null,d(new Date(n(a).created_at).toLocaleDateString("bn-BD"))+" ইং",1)]),t("div",null,[e[13]||(e[13]=t("b",null,"অঞ্চল:",-1)),u.value?m((i(),l("select",{key:1,"onUpdate:modelValue":e[0]||(e[0]=s=>n(a).area_id=s),class:"input-1"},[e[12]||(e[12]=t("option",{value:"",disabled:""},"Select Area",-1)),(i(!0),l(v,null,f(n(N).areas,s=>(i(),l("option",{key:s.id,value:s.id},d(s.name),9,Lt))),128))],512)),[[b,n(a).area_id]]):(i(),l("p",qt,d((I=(F=n(a))==null?void 0:F.area)==null?void 0:I.name),1))])]),e[20]||(e[20]=t("hr",null,null,-1)),t("div",Ot,[t("div",Tt,[t("div",Jt,[u.value?U("",!0):(i(),l("div",$t,[e[14]||(e[14]=t("b",null,"ইলহাক:",-1)),t("p",null,d((L=(q=n(a))==null?void 0:q.institute)==null?void 0:L.institute_code),1)])),t("div",Ht,[e[16]||(e[16]=t("b",null,"শিক্ষা প্রতিষ্ঠানের নাম ও ঠিকানা:",-1)),u.value?m((i(),l("select",{key:1,"onUpdate:modelValue":e[1]||(e[1]=s=>n(a).institute_id=s),class:"input-1",disabled:!n(a).area_id,required:""},[e[15]||(e[15]=t("option",{value:"",disabled:""},"Select Institute",-1)),(i(!0),l(v,null,f(n(k).institutes,s=>(i(),l("option",{key:s.id,value:s.id},d(s.institute_code)+" - "+d(s.name),9,Wt))),128))],8,Qt)),[[b,n(a).institute_id]]):(i(),l("p",Kt,d((T=(O=n(a))==null?void 0:O.institute)==null?void 0:T.name),1))])])]),t("div",null,[e[18]||(e[18]=t("b",null,"কেন্দ্র:",-1)),u.value?m((i(),l("select",{key:1,"onUpdate:modelValue":e[2]||(e[2]=s=>n(a).center_id=s),class:"input-1",disabled:!n(a).zamat_id,required:""},[e[17]||(e[17]=t("option",{value:"",disabled:""},"Select Center",-1)),(i(!0),l(v,null,f(n(M).centers,s=>{var _;return i(),l("option",{key:s.id,value:s==null?void 0:s.institute_id},d((_=s==null?void 0:s.institute)==null?void 0:_.name),9,Zt)}),128))],8,Yt)),[[b,n(a).center_id]]):(i(),l("p",Xt,d((($=(J=n(a))==null?void 0:J.center)==null?void 0:$.name)||"নির্বাচন করা নেই"),1))])])]),e[32]||(e[32]=t("hr",null,null,-1)),t("div",te,[t("div",null,[e[22]||(e[22]=t("b",null,"মারহালা:",-1)),u.value?m((i(),l("select",{key:1,"onUpdate:modelValue":e[3]||(e[3]=s=>n(a).zamat_id=s),class:"input-1",required:""},[e[21]||(e[21]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(i(!0),l(v,null,f(n(R).departments,s=>(i(),l("optgroup",{label:s.name,key:s.id},[(i(!0),l(v,null,f(s.zamats,_=>(i(),l("option",{key:_.id,value:_.id},d(_.name),9,se))),128))],8,ae))),128))],512)),[[b,n(a).zamat_id]]):(i(),l("p",ee,d((K=(H=n(a))==null?void 0:H.zamat)==null?void 0:K.name),1))]),t("div",null,[e[25]||(e[25]=t("b",null,"গ্রুপ:",-1)),u.value?m((i(),l("select",{key:1,"onUpdate:modelValue":e[4]||(e[4]=s=>n(a).group_id=s),class:"input-1",disabled:!n(a).zamat_id},[e[24]||(e[24]=t("option",{value:"",disabled:""},"Select Group",-1)),(i(!0),l(v,null,f(n(h).groups,s=>(i(),l("option",{key:s.id,value:s.id},[c(d(s.name)+" (",1),(i(!0),l(v,null,f(s.areas,(_,V)=>(i(),l(v,{key:_.id},[V?(i(),l("span",ne,", ")):U("",!0),t("span",null,d(_.name),1)],64))),128)),e[23]||(e[23]=c(") "))],8,oe))),128))],8,ie)),[[b,n(a).group_id]]):(i(),l("p",le,d(((W=(Q=n(a))==null?void 0:Q.group)==null?void 0:W.name)||"প্রযোজ্য নয়"),1))]),t("div",null,[t("b",null,"টাকার পরিমাণ ("+d((X=n(a))==null?void 0:X.payment_method)+"):",1),t("p",null,[c(d((Y=n(a))==null?void 0:Y.total_amount)+" টাকা ",1),t("span",{class:gt([{"text-yellow-600 bg-yellow-200":((Z=n(a))==null?void 0:Z.payment_status)==="Pending","text-green-600 bg-green-200":((tt=n(a))==null?void 0:tt.payment_status)==="Paid","text-red-600 bg-red-200":((et=n(a))==null?void 0:et.payment_status)==="Failed"},"py-1 px-2 rounded-full text-xs"])},d((at=n(a))==null?void 0:at.payment_status),3)])])]),e[33]||(e[33]=t("hr",null,null,-1)),t("div",de,[e[29]||(e[29]=t("div",{class:"flex justify-center"},[t("h2",{class:"title-lg"},"পরীক্ষার্থীদের তথ্য")],-1)),t("div",ue,[p.value?(i(),l(v,{key:1},[t("button",{class:"btn-2",onClick:vt},e[27]||(e[27]=[t("i",{class:"fas fa-save"},null,-1),c(),t("span",{class:"hidden md:flex"},"Save",-1)])),t("button",{class:"btn-3 ml-2",onClick:pt},e[28]||(e[28]=[t("i",{class:"fas fa-times"},null,-1),c(),t("span",{class:"hidden md:flex"},"Cancel",-1)]))],64)):(i(),l("button",{key:0,class:"btn-3",onClick:ut},e[26]||(e[26]=[t("i",{class:"fas fa-edit"},null,-1),c(),t("span",{class:"hidden md:flex"},"Edit",-1)])))])]),t("div",re,[t("table",pe,[e[31]||(e[31]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border px-4 py-2"},"#"),t("th",{class:"border px-4 py-2"},"রেজি. নং"),t("th",{class:"border px-4 py-2"},"নাম"),t("th",{class:"border px-4 py-2"},"পিতার নাম"),t("th",{class:"border px-4 py-2"},"জন্ম তারিখ"),t("th",{class:"border px-4 py-2"},"পারা গ্রুপ"),t("th",{class:"border px-4 py-2"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)")])],-1)),t("tbody",null,[(i(!0),l(v,null,f(n(a).students,(s,_)=>{var V;return i(),l("tr",{key:_},[t("td",_e,d(_+1),1),t("td",ve,d(s.registration||"N/A"),1),t("td",ce,[p.value?m((i(),l("input",{key:1,"onUpdate:modelValue":r=>s.name=r,type:"text",class:"input-1"},null,8,fe)),[[G,s.name]]):(i(),l("span",me,d(s.name),1))]),t("td",ye,[p.value?m((i(),l("input",{key:1,"onUpdate:modelValue":r=>s.father_name=r,type:"text",class:"input-1"},null,8,ge)),[[G,s.father_name]]):(i(),l("span",be,d(s.father_name),1))]),t("td",xe,[p.value?m((i(),l("input",{key:1,"onUpdate:modelValue":r=>s.date_of_birth=r,type:"date",class:"input-1"},null,8,he)),[[G,s.date_of_birth]]):(i(),l("span",ke,d(new Date(s.date_of_birth).toLocaleDateString("bn-BD"))+" ইং ",1))]),t("td",Se,[p.value?m((i(),l("select",{key:1,"onUpdate:modelValue":r=>s.para=r,class:"input-1",disabled:!((V=n(a))!=null&&V.zamat_id)},[e[30]||(e[30]=t("option",{value:""},"প্রযোজ্য নয়",-1)),(i(!0),l(v,null,f(n(y).paraGroups,r=>(i(),l("option",{key:r.id,value:r.id},d(r.name),9,Ce))),128))],8,ze)),[[b,s.para,void 0,{number:!0}]]):(i(),l("span",we,d(nt(s.para)),1))]),t("td",Ve,[p.value?m((i(),l("input",{key:1,"onUpdate:modelValue":r=>s.address=r,type:"text",class:"input-1"},null,8,Ue)),[[G,s.address]]):(i(),l("span",De,d(s.address),1))])])}),128))])])])]),!u.value&&!p.value?(i(),l("div",Ge,[lt(A,{to:{name:"ApplicationList"},class:"btn-2"},{default:xt(()=>e[34]||(e[34]=[c("তালিকায় যান")])),_:1}),e[35]||(e[35]=t("button",{onclick:"window.print()",class:"btn-3"},"প্রিন্ট করুন",-1)),((st=n(a))==null?void 0:st.payment_status)==="Pending"?(i(),l("button",{key:0,onClick:ct,class:"btn-contrast"}," নিবন্ধন গ্রহণ ")):U("",!0)])):U("",!0)])):(i(),l("div",Pe,e[36]||(e[36]=[t("p",null,"Application not found.",-1)]))),lt(Gt,{"application-id":n(x),onDataUpdated:mt},null,8,["application-id"])])}}};export{Oe as default};
