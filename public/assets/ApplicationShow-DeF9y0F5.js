import{C as it,r as W,h as dt,z as V,c as a,i as n,a as t,t as d,y as v,f as y,m as c,A as g,F as m,b as f,n as rt,d as X,w as ut,p as pt,x as _t,o as l,v as k}from"./index-B2JbgT2f.js";import{u as ct}from"./application-CnAKXuFl.js";import{u as mt}from"./institute-C3nFEOmW.js";import{u as vt}from"./group-mnAb7qUq.js";import{u as yt}from"./area-2gucs4My.js";import{u as ft}from"./zamat-rr9zKeoI.js";import{u as bt}from"./center-C6th5dwt.js";import{_ as gt}from"./ApplicationStatusModal-BKxJf_PD.js";const kt={class:"my-container space-y-4"},xt={key:0,class:"flex justify-center items-center"},ht={key:1,class:"card-bg p-4 md:p-8 space-y-4"},St={class:"space-y-4"},wt={class:"relative"},Vt={class:"flex flex-col justify-center items-center"},Ut={class:"title-md text-center"},Ct={class:"absolute top-0 right-0"},Dt={class:"space-y-2"},zt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},At={key:0},Et=["value"],Rt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ft={class:"space-y-2"},Mt={class:"flex gap-4"},Pt={key:0},Bt={key:0},jt=["disabled"],Gt=["value"],It={key:0},Lt=["disabled"],Nt=["value"],qt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Tt={key:0},Zt=["label"],$t=["value"],Ht={key:0},Jt=["disabled"],Kt=["value"],Ot={key:0},Qt={class:"relative"},Wt={class:"absolute top-0 right-0"},Xt={class:"overflow-x-auto"},Yt={class:"table-auto w-full text-left border-collapse"},te={class:"border px-4 py-2"},ee={class:"border px-4 py-2"},se={key:0},ae=["onUpdate:modelValue"],le={class:"border px-4 py-2"},oe={key:0},ne=["onUpdate:modelValue"],ie={class:"border px-4 py-2"},de={key:0},re=["onUpdate:modelValue"],ue={class:"border px-4 py-2"},pe={key:0},_e=["onUpdate:modelValue"],ce={class:"border px-4 py-2"},me={key:0},ve=["onUpdate:modelValue"],ye={key:0,class:"flex justify-between gap-4"},fe={key:2,class:"text-center text-red-500"},De={__name:"ApplicationShow",setup(be){const b=ct(),U=yt(),C=mt(),S=vt(),D=ft(),w=bt(),x=pt().params.id,{application:o,loading:Y}=it(b),r=W(!1),p=W(!1),h=async()=>{try{await Promise.all([b.fetchApplication(x),U.fetchAreas(),D.fetchZamats(),S.fetchGroups(),w.fetchCenters()])}catch(i){console.error("Failed to load application:",i)}};dt(h),V(()=>{var i;return(i=o.value)==null?void 0:i.area_id},async i=>{i&&await C.fetchInstitutes({area_id:i,per_page:"all"})}),V(()=>{var i;return(i=o.value)==null?void 0:i.zamat_id},async i=>{i&&(await S.fetchGroups({zamat_id:i}),z())}),V(()=>{var i;return(i=o.value)==null?void 0:i.group_id},async i=>{i&&z()});const z=async()=>{var i,e;(i=o.value)!=null&&i.zamat_id&&((e=o.value)!=null&&e.group_id)&&await w.fetchCenters({zamat_id:o.value.zamat_id,group_id:o.value.group_id})},tt=()=>{r.value=!r.value},et=()=>{p.value=!p.value},st=async()=>{try{const i={exam_id:o.value.exam_id,institute_id:o.value.institute_id,zamat_id:o.value.zamat_id,group_id:o.value.group_id,area_id:o.value.area_id,center_id:o.value.center_id};await b.updateRegistrationPart(x,i),console.log("Registration updated successfully"),await h()}catch(i){console.error("Failed to update registration part:",i.message)}finally{r.value=!1}},at=async()=>{try{const i={students:o.value.students};await b.updateStudentsPart(x,i),console.log("Students updated successfully"),await h()}catch(i){console.error("Failed to update students part:",i.message)}finally{p.value=!1}},lt=()=>{b.showStatusModal=!0},ot=async()=>{await h()};return(i,e)=>{var A,E,R,F,M,P,B,j,G,I,L,N,q,T,Z,$,H,J,K,O,Q;const nt=_t("router-link");return l(),a("div",kt,[n(Y)?(l(),a("div",xt,e[5]||(e[5]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-gray-900"},null,-1)]))):n(o)?(l(),a("div",ht,[t("div",St,[t("div",wt,[t("div",Vt,[t("h4",Ut,d((E=(A=n(o))==null?void 0:A.exam)==null?void 0:E.name),1),e[6]||(e[6]=t("h1",{class:"title-lg text-center"},"নিবন্ধনের বিস্তারিত",-1))]),t("div",Ct,[r.value?y("",!0):(l(),a("button",{key:0,class:"btn-3",onClick:tt},e[7]||(e[7]=[t("i",{class:"fas fa-edit"},null,-1),v(),t("span",{class:"hidden md:flex"},"Edit",-1)]))),r.value?(l(),a("button",{key:1,class:"btn-2",onClick:st},e[8]||(e[8]=[t("i",{class:"fas fa-save"},null,-1),v(),t("span",{class:"hidden md:flex"},"Save",-1)]))):y("",!0)])]),t("div",Dt,[e[18]||(e[18]=t("hr",null,null,-1)),t("div",zt,[t("div",null,[e[9]||(e[9]=t("b",null,"নিবন্ধন নং:",-1)),t("p",null,d(n(o).id),1)]),t("div",null,[e[10]||(e[10]=t("b",null,"নিবন্ধনের তারিখ:",-1)),t("p",null,d(new Date(n(o).created_at).toLocaleDateString("bn-BD"))+" ইং",1)]),t("div",null,[e[12]||(e[12]=t("b",null,"অঞ্চল:",-1)),r.value?c((l(),a("select",{key:1,"onUpdate:modelValue":e[0]||(e[0]=s=>n(o).area_id=s),class:"input-1"},[e[11]||(e[11]=t("option",{value:"",disabled:""},"Select Area",-1)),(l(!0),a(m,null,f(n(U).areas,s=>(l(),a("option",{key:s.id,value:s.id},d(s.name),9,Et))),128))],512)),[[g,n(o).area_id]]):(l(),a("p",At,d((F=(R=n(o))==null?void 0:R.area)==null?void 0:F.name),1))])]),e[19]||(e[19]=t("hr",null,null,-1)),t("div",Rt,[t("div",Ft,[t("div",Mt,[r.value?y("",!0):(l(),a("div",Pt,[e[13]||(e[13]=t("b",null,"ইলহাক:",-1)),t("p",null,d((P=(M=n(o))==null?void 0:M.institute)==null?void 0:P.institute_code),1)])),t("div",null,[e[15]||(e[15]=t("b",null,"শিক্ষা প্রতিষ্ঠানের নাম ও ঠিকানা:",-1)),r.value?c((l(),a("select",{key:1,"onUpdate:modelValue":e[1]||(e[1]=s=>n(o).institute_id=s),class:"input-1",disabled:!n(o).area_id,required:""},[e[14]||(e[14]=t("option",{value:"",disabled:""},"Select Institute",-1)),(l(!0),a(m,null,f(n(C).institutes,s=>(l(),a("option",{key:s.id,value:s.id},d(s.institute_code)+" - "+d(s.name),9,Gt))),128))],8,jt)),[[g,n(o).institute_id]]):(l(),a("p",Bt,d((j=(B=n(o))==null?void 0:B.institute)==null?void 0:j.name),1))])])]),t("div",null,[e[17]||(e[17]=t("b",null,"কেন্দ্র:",-1)),r.value?c((l(),a("select",{key:1,"onUpdate:modelValue":e[2]||(e[2]=s=>n(o).center_id=s),class:"input-1",disabled:!n(o).zamat_id,required:""},[e[16]||(e[16]=t("option",{value:"",disabled:""},"Select Center",-1)),(l(!0),a(m,null,f(n(w).centers,s=>{var u;return l(),a("option",{key:s.id,value:s==null?void 0:s.institute_id},d((u=s==null?void 0:s.institute)==null?void 0:u.name),9,Nt)}),128))],8,Lt)),[[g,n(o).center_id]]):(l(),a("p",It,d(((I=(G=n(o))==null?void 0:G.center)==null?void 0:I.name)||"নির্বাচন করা নেই"),1))])])]),e[29]||(e[29]=t("hr",null,null,-1)),t("div",qt,[t("div",null,[e[21]||(e[21]=t("b",null,"মারহালা:",-1)),r.value?c((l(),a("select",{key:1,"onUpdate:modelValue":e[3]||(e[3]=s=>n(o).zamat_id=s),class:"input-1",required:""},[e[20]||(e[20]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(l(!0),a(m,null,f(n(D).departments,s=>(l(),a("optgroup",{label:s.name,key:s.id},[(l(!0),a(m,null,f(s.zamats,u=>(l(),a("option",{key:u.id,value:u.id},d(u.name),9,$t))),128))],8,Zt))),128))],512)),[[g,n(o).zamat_id]]):(l(),a("p",Tt,d((N=(L=n(o))==null?void 0:L.zamat)==null?void 0:N.name),1))]),t("div",null,[e[24]||(e[24]=t("b",null,"গ্রুপ:",-1)),r.value?c((l(),a("select",{key:1,"onUpdate:modelValue":e[4]||(e[4]=s=>n(o).group_id=s),class:"input-1",disabled:!n(o).zamat_id},[e[23]||(e[23]=t("option",{value:"",disabled:""},"Select Group",-1)),(l(!0),a(m,null,f(n(S).groups,s=>(l(),a("option",{key:s.id,value:s.id},[v(d(s.name)+" (",1),(l(!0),a(m,null,f(s.areas,(u,_)=>(l(),a(m,{key:u.id},[_?(l(),a("span",Ot,", ")):y("",!0),t("span",null,d(u.name),1)],64))),128)),e[22]||(e[22]=v(") "))],8,Kt))),128))],8,Jt)),[[g,n(o).group_id]]):(l(),a("p",Ht,d(((T=(q=n(o))==null?void 0:q.group)==null?void 0:T.name)||"প্রযোজ্য নয়"),1))]),t("div",null,[t("b",null,"টাকার পরিমাণ ("+d((Z=n(o))==null?void 0:Z.payment_method)+"):",1),t("p",null,[v(d(($=n(o))==null?void 0:$.total_amount)+" টাকা ",1),t("span",{class:rt([{"text-yellow-600 bg-yellow-200":((H=n(o))==null?void 0:H.payment_status)==="Pending","text-green-600 bg-green-200":((J=n(o))==null?void 0:J.payment_status)==="Paid","text-red-600 bg-red-200":((K=n(o))==null?void 0:K.payment_status)==="Failed"},"py-1 px-2 rounded-full text-xs"])},d((O=n(o))==null?void 0:O.payment_status),3)])])]),e[30]||(e[30]=t("hr",null,null,-1)),t("div",Qt,[e[27]||(e[27]=t("div",{class:"flex justify-center"},[t("h2",{class:"title-lg"},"পরীক্ষার্থীদের তথ্য")],-1)),t("div",Wt,[p.value?y("",!0):(l(),a("button",{key:0,class:"btn-3",onClick:et},e[25]||(e[25]=[t("i",{class:"fas fa-edit"},null,-1),v(),t("span",{class:"hidden md:flex"},"Edit",-1)]))),p.value?(l(),a("button",{key:1,class:"btn-2",onClick:at},e[26]||(e[26]=[t("i",{class:"fas fa-save"},null,-1),v(),t("span",{class:"hidden md:flex"},"Save",-1)]))):y("",!0)])]),t("div",Xt,[t("table",Yt,[e[28]||(e[28]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border px-4 py-2"},"#"),t("th",{class:"border px-4 py-2"},"নাম"),t("th",{class:"border px-4 py-2"},"পিতার নাম"),t("th",{class:"border px-4 py-2"},"জন্ম তারিখ"),t("th",{class:"border px-4 py-2"},"পারার বিবরণ"),t("th",{class:"border px-4 py-2"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)")])],-1)),t("tbody",null,[(l(!0),a(m,null,f(n(o).students,(s,u)=>(l(),a("tr",{key:u},[t("td",te,d(u+1),1),t("td",ee,[p.value?c((l(),a("input",{key:1,"onUpdate:modelValue":_=>s.name=_,type:"text",class:"input-1"},null,8,ae)),[[k,s.name]]):(l(),a("span",se,d(s.name),1))]),t("td",le,[p.value?c((l(),a("input",{key:1,"onUpdate:modelValue":_=>s.father_name=_,type:"text",class:"input-1"},null,8,ne)),[[k,s.father_name]]):(l(),a("span",oe,d(s.father_name),1))]),t("td",ie,[p.value?c((l(),a("input",{key:1,"onUpdate:modelValue":_=>s.date_of_birth=_,type:"date",class:"input-1"},null,8,re)),[[k,s.date_of_birth]]):(l(),a("span",de,d(new Date(s.date_of_birth).toLocaleDateString("bn-BD"))+" ইং",1))]),t("td",ue,[p.value?c((l(),a("input",{key:1,"onUpdate:modelValue":_=>s.para=_,type:"text",class:"input-1"},null,8,_e)),[[k,s.para]]):(l(),a("span",pe,d(s.para||"প্রযোজ্য নয়"),1))]),t("td",ce,[p.value?c((l(),a("input",{key:1,"onUpdate:modelValue":_=>s.address=_,type:"text",class:"input-1"},null,8,ve)),[[k,s.address]]):(l(),a("span",me,d(s.address),1))])]))),128))])])])]),!r.value&&!p.value?(l(),a("div",ye,[X(nt,{to:{name:"ApplicationList"},class:"btn-2"},{default:ut(()=>e[31]||(e[31]=[v("তালিকায় যান")])),_:1}),e[32]||(e[32]=t("button",{onclick:"window.print()",class:"btn-3"},"প্রিন্ট করুন",-1)),((Q=n(o))==null?void 0:Q.payment_status)==="Pending"?(l(),a("button",{key:0,onClick:lt,class:"btn-contrast"}," নিবন্ধন গ্রহণ ")):y("",!0)])):y("",!0)])):(l(),a("div",fe,e[33]||(e[33]=[t("p",null,"Application not found.",-1)]))),X(gt,{applicationId:n(x),onDataUpdated:ot},null,8,["applicationId"])])}}};export{De as default};
