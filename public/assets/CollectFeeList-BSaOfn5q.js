import{d as n,c as r,a as t,y as p,t as o,F as C,e as V,f as N,w as B,h as $,z as R,r as u,i as M,o as O,j as w,v as D,D as j,C as z,b as S,k as U,L as I}from"./index-D1_2pXdj.js";import{u as K}from"./collect-fee-DzpxZU_c.js";import{u as T}from"./zamat-BZkfmZ2z.js";const A={key:0,class:"modal-bg z-50"},E={class:"modal-card"},J={class:""},Z={class:"grid grid-cols-2 gap-4"},q={class:"grid grid-cols-2 gap-4"},X={class:"grid grid-cols-2 gap-4"},G={class:"mt-4 max-h-80 overflow-y-auto"},H={class:"w-full border-collapse border border-gray-300"},P={class:"border border-gray-300 px-4 py-2 text-center"},Q={class:"border border-gray-300 px-4 py-2"},W={class:"border border-gray-300 px-4 py-2 text-center"},Y={class:"min-w-max"},tt={class:"border border-gray-300 px-4 py-2 text-center"},et={class:"border border-gray-300 px-4 py-2 text-center"},st={__name:"CollectFeeShow",props:{visible:{type:Boolean,required:!0},collectFee:{type:Object,default:()=>null},students:{type:Object,default:()=>null}},emits:["close"],setup(i,{emit:F}){const y=F,x=()=>{y("close")};return(g,l)=>{var c,b,_,f,h,d,k,a,s,m;const v=R("RouterLink");return i.visible?(n(),r("div",A,[t("div",E,[t("div",{class:"flex justify-between items-center border-b pb-3"},[l[1]||(l[1]=t("h3",{class:"title-md"},"পরিক্ষার্থী তালিকা:",-1)),t("button",{onClick:x,class:"text-gray-600 hover:text-gray-800"},l[0]||(l[0]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",J,[t("p",null,[l[2]||(l[2]=t("strong",null,"মাদ্রাসার নাম:",-1)),p(o((b=(c=i.collectFee)==null?void 0:c.institute)==null?void 0:b.institute_code)+" - "+o((f=(_=i.collectFee)==null?void 0:_.institute)==null?void 0:f.name),1)]),t("div",Z,[t("p",null,[l[3]||(l[3]=t("strong",null,"মারহালা:",-1)),p(" "+o((d=(h=i.collectFee)==null?void 0:h.zamat)==null?void 0:d.name),1)]),t("p",null,[l[4]||(l[4]=t("strong",null,"ফি’র পরিমাণ:",-1)),p(" "+o((k=i.collectFee)==null?void 0:k.total_amount),1)])]),t("div",q,[t("p",null,[l[5]||(l[5]=t("strong",null,"পেমেন্ট মাধ্যম:",-1)),p(" "+o((a=i.collectFee)==null?void 0:a.payment_method),1)]),t("p",null,[l[6]||(l[6]=t("strong",null,"ট্রান্স. আইডি:",-1)),p(" "+o(((s=i.collectFee)==null?void 0:s.transaction_id)||"N/A"),1)])]),t("div",X,[t("p",null,[l[7]||(l[7]=t("strong",null,"পরিক্ষার্থী সংখ্যা:",-1)),p(" "+o(JSON.parse(i.collectFee.student_ids).length),1)]),t("p",null,[l[8]||(l[8]=t("strong",null,"তারিখ:",-1)),p(" "+o(new Date((m=i.collectFee)==null?void 0:m.created_at).toLocaleString()),1)])]),t("div",G,[t("table",H,[l[10]||(l[10]=t("thead",{class:"bg-gray-100 sticky top-0"},[t("tr",null,[t("th",{class:"border border-gray-300 px-4 py-2"},"#"),t("th",{class:"border border-gray-300 px-4 py-2"},"নাম"),t("th",{class:"border border-gray-300 px-4 py-2"},"রোল নম্বর"),t("th",{class:"border border-gray-300 px-4 py-2"},"রেজিস্ট্রেশন নম্বর"),t("th",{class:"border border-gray-300 px-4 py-2"},"একশন")])],-1)),t("tbody",null,[(n(!0),r(C,null,V(i.students,(e,L)=>(n(),r("tr",{key:e.id},[t("td",P,o(L+1),1),t("td",Q,o(e.name),1),t("td",W,[t("div",Y,o(e.roll_number?e.roll_number.replace(/(\d{3})(\d+)/,"$1-$2"):"নেই"),1)]),t("td",tt,o(e.registration_number),1),t("td",et,[N(v,{to:{name:"StudentEdit",params:{id:e.id}},class:"btn-icon"},{default:B(()=>l[9]||(l[9]=[t("i",{class:"fas fa-edit"},null,-1)])),_:2},1032,["to"])])]))),128))])])])])])])):$("",!0)}}},lt={class:"px-4 space-y-6"},ot={class:"flex justify-between items-center"},nt={class:"card-bg p-4"},at={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},rt={class:"relative"},it=["value"],dt={class:"relative"},ct={key:0,class:"text-red-600 font-semibold"},ut={key:2,class:"overflow-x-auto"},pt={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},yt={class:"text-gray-600 text-sm"},xt={class:"py-3 px-2"},vt={class:"py-3 px-2"},mt={class:"py-3 px-2 text-center"},bt={class:"py-3 px-2 text-center"},gt={class:"py-3 px-2 text-center"},_t={class:"py-3 px-2 text-center"},ft={class:"py-3 px-2 text-center"},ht={class:"py-3 px-2 text-center"},Ft={class:"py-3 px-2 text-center"},kt={class:"flex items-center justify-center gap-4"},wt=["onClick"],Ct={key:1},Nt={__name:"CollectFeeList",setup(i){const F=T(),y=K(),x=u(!0),g=u(""),l=u(""),v=u(""),c=u(""),b=u(!1),_=u(null),f=u(null),h=M(()=>[...y.collectFees].sort((a,s)=>new Date(s.created_at)-new Date(a.created_at))),d=async()=>{try{x.value=!0;const a={};g.value&&(a.zamat_id=g.value),l.value&&(a.payment_method=l.value),v.value&&(a.institute_code=v.value),c.value&&(a.transaction_id=c.value),await y.fetchCollectFees(a)}finally{x.value=!1}};O(async()=>{await F.fetchZamats(),d()});const k=async a=>{var s,m;try{x.value=!0;const e=await y.fetchCollectFee(a);_.value=(s=e==null?void 0:e.data)==null?void 0:s.feeCollection,f.value=(m=e==null?void 0:e.data)==null?void 0:m.students,b.value=!0}finally{x.value=!1}};return(a,s)=>{const m=R("RouterLink");return n(),r(C,null,[t("div",lt,[t("div",ot,[s[6]||(s[6]=t("h1",{class:"title-lg"},"Fee Collections List",-1)),N(m,{to:{name:"CollectFee"},class:"btn-2"},{default:B(()=>s[5]||(s[5]=[p("নতুন ফি গ্রহণ")])),_:1})]),t("div",nt,[t("div",at,[t("div",rt,[w(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>v.value=e),type:"text",class:"input-1 text-center",placeholder:"ইলহাক নং",onKeyup:j(d,["enter"])},null,544),[[D,v.value]]),v.value?(n(),r("button",{key:0,onClick:d,class:"absolute right-3 top-2.5"},s[7]||(s[7]=[t("i",{class:"fas fa-search"},null,-1)]))):$("",!0)]),w(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>g.value=e),class:"input-1 text-center",onChange:d},[s[8]||(s[8]=t("option",{value:""},"- সকল মারহালা -",-1)),(n(!0),r(C,null,V(S(F).zamats,e=>(n(),r("option",{key:e.id,value:e.id},o(e.name),9,it))),128))],544),[[z,g.value]]),w(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>l.value=e),class:"input-1 text-center",onChange:d},s[9]||(s[9]=[t("option",{value:""},"- পেমেন্ট মেথড -",-1),t("option",{value:"offline"},"অফলাইন",-1),t("option",{value:"online"},"অনলাইন",-1)]),544),[[z,l.value]]),t("div",dt,[w(t("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>c.value=e),type:"text",placeholder:"TRX ID",class:"input-1 text-center",onKeyup:j(d,["enter"])},null,544),[[D,c.value]]),c.value?(n(),r("button",{key:0,onClick:d,class:"absolute right-3 top-2.5"},s[10]||(s[10]=[t("i",{class:"fas fa-search"},null,-1)]))):$("",!0)])])]),S(y).error?(n(),r("div",ct,o(S(y).error),1)):$("",!0),x.value?(n(),U(I,{key:1})):(n(),r("div",ut,[t("table",pt,[s[13]||(s[13]=t("thead",null,[t("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[t("th",{class:"py-3 px-2 text-left"},"#"),t("th",{class:"py-3 px-2 text-left"},"মাদ্রাসার নাম"),t("th",{class:"py-3 px-2 text-center"},"মারহালা"),t("th",{class:"py-3 px-2 text-center"},"পরিক্ষার্থী সংখ্যা"),t("th",{class:"py-3 px-2 text-center"},"ফি’র পরিমাণ"),t("th",{class:"py-3 px-2 text-center"},"মাধ্যম"),t("th",{class:"py-3 px-2 text-center"},"ট্রান্স. আইডি"),t("th",{class:"py-3 px-2 text-center"},"তারিখ ও সময়"),t("th",{class:"py-3 px-2 text-center"},"একশন")])],-1)),t("tbody",yt,[h.value.length?(n(!0),r(C,{key:0},V(h.value,(e,L)=>(n(),r("tr",{key:e.id,class:"border-b border-gray-200 hover:bg-gray-100"},[t("td",xt,o(L+1),1),t("td",vt,o(e.institute.institute_code)+" - "+o(e.institute.name),1),t("td",mt,o(e.zamat.name),1),t("td",bt,o(JSON.parse(e.student_ids).length),1),t("td",gt,o(e.total_amount),1),t("td",_t,o(e.payment_method),1),t("td",ft,o(e.transaction_id||"N/A"),1),t("td",ht,o(new Date(e.created_at).toLocaleString("bn-BD",{hour12:!0})),1),t("td",Ft,[t("div",kt,[t("button",{onClick:$t=>k(e.id),class:"text-blue-600 hover:text-blue-800"},s[11]||(s[11]=[t("i",{class:"fas fa-eye"},null,-1)]),8,wt)])])]))),128)):(n(),r("tr",Ct,s[12]||(s[12]=[t("td",{colspan:"9",class:"text-center text-red-500 py-4"},"No fee collections found",-1)])))])])]))]),N(st,{visible:b.value,collectFee:_.value,students:f.value,onClose:s[4]||(s[4]=e=>b.value=!1)},null,8,["visible","collectFee","students"])],64)}}};export{Nt as default};
