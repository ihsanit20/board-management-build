import{d as n,c as r,a as t,y,t as o,F as S,e as B,f as j,w as R,h as L,z as U,B as O,r as p,i as K,o as T,j as $,D,b as k,v as E,G as I,k as A,L as J}from"./index-q8lYwX3i.js";import{u as Z}from"./collect-fee-vTDbWAEi.js";import{u as q}from"./zamat-CazijuuD.js";const G={key:0,class:"modal-bg z-50"},P={class:"modal-card"},X={class:""},H={class:"grid grid-cols-2 gap-4"},Q={class:"grid grid-cols-2 gap-4"},W={class:"grid grid-cols-2 gap-4"},Y={class:"mt-4 max-h-80 overflow-y-auto"},tt={class:"w-full border-collapse border border-gray-300"},et={class:"border border-gray-300 px-4 py-2 text-center"},st={class:"border border-gray-300 px-4 py-2"},lt={class:"border border-gray-300 px-4 py-2 text-center"},ot={class:"min-w-max"},at={class:"border border-gray-300 px-4 py-2 text-center"},nt={class:"border border-gray-300 px-4 py-2 text-center"},rt={__name:"CollectFeeShow",props:{visible:{type:Boolean,required:!0},collectFee:{type:Object,default:()=>null},students:{type:Object,default:()=>null}},emits:["close"],setup(i,{emit:V}){const u=V,v=()=>{u("close")};return(g,s)=>{var b,m,x,_,F,w,C,d,N,a;const f=U("RouterLink");return i.visible?(n(),r("div",G,[t("div",P,[t("div",{class:"flex justify-between items-center border-b pb-3"},[s[1]||(s[1]=t("h3",{class:"title-md"},"পরিক্ষার্থী তালিকা:",-1)),t("button",{onClick:v,class:"text-gray-600 hover:text-gray-800"},s[0]||(s[0]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",X,[t("p",null,[s[2]||(s[2]=t("strong",null,"মাদ্রাসার নাম:",-1)),y(o((m=(b=i.collectFee)==null?void 0:b.institute)==null?void 0:m.institute_code)+" - "+o((_=(x=i.collectFee)==null?void 0:x.institute)==null?void 0:_.name),1)]),t("div",H,[t("p",null,[s[3]||(s[3]=t("strong",null,"মারহালা:",-1)),y(" "+o((w=(F=i.collectFee)==null?void 0:F.zamat)==null?void 0:w.name),1)]),t("p",null,[s[4]||(s[4]=t("strong",null,"ফি’র পরিমাণ:",-1)),y(" "+o((C=i.collectFee)==null?void 0:C.total_amount),1)])]),t("div",Q,[t("p",null,[s[5]||(s[5]=t("strong",null,"পেমেন্ট মাধ্যম:",-1)),y(" "+o((d=i.collectFee)==null?void 0:d.payment_method),1)]),t("p",null,[s[6]||(s[6]=t("strong",null,"ট্রান্স. আইডি:",-1)),y(" "+o(((N=i.collectFee)==null?void 0:N.transaction_id)||"N/A"),1)])]),t("div",W,[t("p",null,[s[7]||(s[7]=t("strong",null,"পরিক্ষার্থী সংখ্যা:",-1)),y(" "+o(JSON.parse(i.collectFee.student_ids).length),1)]),t("p",null,[s[8]||(s[8]=t("strong",null,"তারিখ:",-1)),y(" "+o(new Date((a=i.collectFee)==null?void 0:a.created_at).toLocaleString()),1)])]),t("div",Y,[t("table",tt,[s[10]||(s[10]=t("thead",{class:"bg-gray-100 sticky top-0"},[t("tr",null,[t("th",{class:"border border-gray-300 px-4 py-2"},"#"),t("th",{class:"border border-gray-300 px-4 py-2"},"নাম"),t("th",{class:"border border-gray-300 px-4 py-2"},"রোল নম্বর"),t("th",{class:"border border-gray-300 px-4 py-2"},"রেজিস্ট্রেশন নম্বর"),t("th",{class:"border border-gray-300 px-4 py-2"},"একশন")])],-1)),t("tbody",null,[(n(!0),r(S,null,B(i.students,(e,h)=>(n(),r("tr",{key:e.id},[t("td",et,o(h+1),1),t("td",st,o(e.name),1),t("td",lt,[t("div",ot,o(e.roll_number?e.roll_number.replace(/(\d{3})(\d+)/,"$1-$2"):"নেই"),1)]),t("td",at,o(e.registration_number),1),t("td",nt,[j(f,{to:{name:"StudentEdit",params:{id:e.id}},class:"btn-icon"},{default:R(()=>s[9]||(s[9]=[t("i",{class:"fas fa-edit"},null,-1)])),_:2},1032,["to"])])]))),128))])])])])])])):L("",!0)}}},it={class:"px-4 space-y-6"},dt={class:"flex justify-between items-center"},ut={class:"card-bg p-4"},ct={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},pt=["value"],yt={class:"relative"},mt=["value"],xt={class:"relative"},vt={key:0,class:"text-sm mt-2 text-gray-600 text-center"},bt={key:0,class:"text-red-600 font-semibold"},gt={key:2,class:"overflow-x-auto"},ft={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},_t={class:"text-gray-600 text-sm"},ht={class:"py-3 px-2"},kt={class:"py-3 px-2"},Ft={class:"py-3 px-2 text-center"},wt={class:"py-3 px-2 text-center"},Ct={class:"py-3 px-2 text-center"},$t={class:"py-3 px-2 text-center"},St={class:"py-3 px-2 text-center"},Lt={class:"py-3 px-2 text-center"},Vt={class:"py-3 px-2 text-center"},Nt={class:"flex items-center justify-center gap-4"},Bt=["onClick"],Dt={key:1},Rt={__name:"CollectFeeList",setup(i){const V=q(),u=O(),v=Z(),g=p(!0),s=p(""),f=p(""),b=p(""),m=p(""),x=p(""),_=p(!1),F=p(null),w=p(null),C=K(()=>[...v.collectFees].sort((a,e)=>new Date(e.created_at)-new Date(a.created_at))),d=async()=>{try{g.value=!0;const a={};s.value&&s.value!=="all"&&(a.exam_id=s.value),f.value&&(a.zamat_id=f.value),b.value&&(a.payment_method=b.value),m.value&&(a.institute_code=m.value),x.value&&(a.transaction_id=x.value),await v.fetchCollectFees(a)}finally{g.value=!1}};T(async()=>{var a;await Promise.all([V.fetchZamats(),u.fetchExams(),u.fetchLastExam()]),s.value=u.lastExamId||((a=u.exam)==null?void 0:a.id)||"",await d()});const N=async a=>{var e,h;try{g.value=!0;const c=await v.fetchCollectFee(a);F.value=(e=c==null?void 0:c.data)==null?void 0:e.feeCollection,w.value=(h=c==null?void 0:c.data)==null?void 0:h.students,_.value=!0}finally{g.value=!1}};return(a,e)=>{var c,z;const h=U("RouterLink");return n(),r(S,null,[t("div",it,[t("div",dt,[e[7]||(e[7]=t("h1",{class:"title-lg"},"Fee Collections List",-1)),j(h,{to:{name:"CollectFee"},class:"btn-2"},{default:R(()=>e[6]||(e[6]=[y("নতুন ফি গ্রহণ")])),_:1})]),t("div",ut,[t("div",ct,[$(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.value=l),class:"input-1 text-center",onChange:d},[e[8]||(e[8]=t("option",{value:"",disabled:""},"— এক্সাম নির্বাচন করুন —",-1)),e[9]||(e[9]=t("option",{value:"all"},"— সব এক্সাম —",-1)),(n(!0),r(S,null,B(k(u).exams,l=>(n(),r("option",{key:l.id,value:l.id},o(l.name),9,pt))),128))],544),[[D,s.value]]),t("div",yt,[$(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),type:"text",class:"input-1 text-center",placeholder:"ইলহাক নং",onKeyup:I(d,["enter"])},null,544),[[E,m.value]]),m.value?(n(),r("button",{key:0,onClick:d,class:"absolute right-3 top-2.5"},e[10]||(e[10]=[t("i",{class:"fas fa-search"},null,-1)]))):L("",!0)]),$(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>f.value=l),class:"input-1 text-center",onChange:d},[e[11]||(e[11]=t("option",{value:""},"- সকল মারহালা -",-1)),(n(!0),r(S,null,B(k(V).zamats,l=>(n(),r("option",{key:l.id,value:l.id},o(l.name),9,mt))),128))],544),[[D,f.value]]),$(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>b.value=l),class:"input-1 text-center",onChange:d},e[12]||(e[12]=[t("option",{value:""},"- পেমেন্ট মেথড -",-1),t("option",{value:"offline"},"অফলাইন",-1),t("option",{value:"online"},"অনলাইন",-1)]),544),[[D,b.value]]),t("div",xt,[$(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>x.value=l),type:"text",placeholder:"TRX ID",class:"input-1 text-center",onKeyup:I(d,["enter"])},null,544),[[E,x.value]]),x.value?(n(),r("button",{key:0,onClick:d,class:"absolute right-3 top-2.5"},e[13]||(e[13]=[t("i",{class:"fas fa-search"},null,-1)]))):L("",!0)])]),s.value&&s.value!=="all"?(n(),r("div",vt,[e[14]||(e[14]=y(" বর্তমান এক্সাম: ")),t("strong",null,o(((c=k(u).exams.find(l=>l.id===Number(s.value)))==null?void 0:c.name)||((z=k(u).exam)==null?void 0:z.name)),1)])):L("",!0)]),k(v).error?(n(),r("div",bt,o(k(v).error),1)):L("",!0),g.value?(n(),A(J,{key:1})):(n(),r("div",gt,[t("table",ft,[e[17]||(e[17]=t("thead",null,[t("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[t("th",{class:"py-3 px-2 text-left"},"#"),t("th",{class:"py-3 px-2 text-left"},"মাদ্রাসার নাম"),t("th",{class:"py-3 px-2 text-center"},"মারহালা"),t("th",{class:"py-3 px-2 text-center"},"পরিক্ষার্থী সংখ্যা"),t("th",{class:"py-3 px-2 text-center"},"ফি’র পরিমাণ"),t("th",{class:"py-3 px-2 text-center"},"মাধ্যম"),t("th",{class:"py-3 px-2 text-center"},"ট্রান্স. আইডি"),t("th",{class:"py-3 px-2 text-center"},"তারিখ ও সময়"),t("th",{class:"py-3 px-2 text-center"},"একশন")])],-1)),t("tbody",_t,[C.value.length?(n(!0),r(S,{key:0},B(C.value,(l,M)=>(n(),r("tr",{key:l.id,class:"border-b border-gray-200 hover:bg-gray-100"},[t("td",ht,o(M+1),1),t("td",kt,o(l.institute.institute_code)+" - "+o(l.institute.name),1),t("td",Ft,o(l.zamat.name),1),t("td",wt,o(JSON.parse(l.student_ids).length),1),t("td",Ct,o(l.total_amount),1),t("td",$t,o(l.payment_method),1),t("td",St,o(l.transaction_id||"N/A"),1),t("td",Lt,o(new Date(l.created_at).toLocaleString("bn-BD",{hour12:!0})),1),t("td",Vt,[t("div",Nt,[t("button",{onClick:jt=>N(l.id),class:"text-blue-600 hover:text-blue-800"},e[15]||(e[15]=[t("i",{class:"fas fa-eye"},null,-1)]),8,Bt)])])]))),128)):(n(),r("tr",Dt,e[16]||(e[16]=[t("td",{colspan:"9",class:"text-center text-red-500 py-4"},"No fee collections found",-1)])))])])]))]),j(rt,{visible:_.value,collectFee:F.value,students:w.value,onClose:e[5]||(e[5]=l=>_.value=!1)},null,8,["visible","collectFee","students"])],64)}}};export{Rt as default};
