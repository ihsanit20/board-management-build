import{d as n,c as r,a as t,z as p,t as o,F as L,e as N,f as D,w as R,h as S,y as M,r as u,i as I,o as K,m as $,v as z,D as B,C as j,b as V,x as O,L as T}from"./index-CuhRPLzI.js";import{u as A}from"./collect-fee-CIfknw2s.js";import{u as E}from"./zamat-jV3tYBa5.js";const Z={key:0,class:"modal-bg z-50"},q={class:"modal-card"},J={class:""},X={class:"grid grid-cols-2 gap-4"},G={class:"grid grid-cols-2 gap-4"},H={class:"grid grid-cols-2 gap-4"},P={class:"mt-4 max-h-80 overflow-y-auto"},Q={class:"w-full border-collapse border border-gray-300"},W={class:"border border-gray-300 px-4 py-2 text-center"},Y={class:"border border-gray-300 px-4 py-2"},tt={class:"border border-gray-300 px-4 py-2 text-center"},et={class:"min-w-max"},st={class:"border border-gray-300 px-4 py-2 text-center"},lt={class:"border border-gray-300 px-4 py-2 text-center"},ot={__name:"CollectFeeShow",props:{visible:{type:Boolean,required:!0},collectFee:{type:Object,default:()=>null},students:{type:Object,default:()=>null}},emits:["close"],setup(i,{emit:k}){const y=k,x=()=>{y("close")};return(_,l)=>{var c,g,f,h,F,d,w,a,e,m,s,C;const v=M("RouterLink");return i.visible?(n(),r("div",Z,[t("div",q,[t("div",{class:"flex justify-between items-center border-b pb-3"},[l[1]||(l[1]=t("h3",{class:"title-md"},"পরিক্ষার্থী তালিকা:",-1)),t("button",{onClick:x,class:"text-gray-600 hover:text-gray-800"},l[0]||(l[0]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",J,[t("p",null,[l[2]||(l[2]=t("strong",null,"মাদ্রাসার নাম:",-1)),p(o((g=(c=i.collectFee)==null?void 0:c.institute)==null?void 0:g.institute_code)+" - "+o((h=(f=i.collectFee)==null?void 0:f.institute)==null?void 0:h.name),1)]),t("div",X,[t("p",null,[l[3]||(l[3]=t("strong",null,"মারহালা:",-1)),p(" "+o((d=(F=i.collectFee)==null?void 0:F.zamat)==null?void 0:d.name),1)]),t("p",null,[l[4]||(l[4]=t("strong",null,"ফি’র পরিমাণ:",-1)),p(" "+o((w=i.collectFee)==null?void 0:w.total_amount),1)])]),t("div",G,[t("p",null,[l[5]||(l[5]=t("strong",null,"পেমেন্ট মাধ্যম:",-1)),p(" "+o((a=i.collectFee)==null?void 0:a.payment_method),1)]),t("p",null,[l[6]||(l[6]=t("strong",null,"ট্রান্স. আইডি:",-1)),p(" "+o(((e=i.collectFee)==null?void 0:e.transaction_id)||"N/A"),1)])]),t("div",H,[t("p",null,[l[7]||(l[7]=t("strong",null,"পরিক্ষার্থী সংখ্যা:",-1)),p(" "+o((s=(m=i.collectFee)==null?void 0:m.student_ids)==null?void 0:s.length),1)]),t("p",null,[l[8]||(l[8]=t("strong",null,"তারিখ:",-1)),p(" "+o(new Date((C=i.collectFee)==null?void 0:C.created_at).toLocaleString()),1)])]),t("div",P,[t("table",Q,[l[10]||(l[10]=t("thead",{class:"bg-gray-100 sticky top-0"},[t("tr",null,[t("th",{class:"border border-gray-300 px-4 py-2"},"#"),t("th",{class:"border border-gray-300 px-4 py-2"},"নাম"),t("th",{class:"border border-gray-300 px-4 py-2"},"রোল নম্বর"),t("th",{class:"border border-gray-300 px-4 py-2"},"রেজিস্ট্রেশন নম্বর"),t("th",{class:"border border-gray-300 px-4 py-2"},"একশন")])],-1)),t("tbody",null,[(n(!0),r(L,null,N(i.students,(b,U)=>(n(),r("tr",{key:b.id},[t("td",W,o(U+1),1),t("td",Y,o(b.name),1),t("td",tt,[t("div",et,o(b.roll_number?b.roll_number.replace(/(\d{3})(\d+)/,"$1-$2"):"নেই"),1)]),t("td",st,o(b.registration_number),1),t("td",lt,[D(v,{to:{name:"StudentEdit",params:{id:b.id}},class:"btn-icon"},{default:R(()=>l[9]||(l[9]=[t("i",{class:"fas fa-edit"},null,-1)])),_:2},1032,["to"])])]))),128))])])])])])])):S("",!0)}}},nt={class:"px-4 space-y-6"},at={class:"flex justify-between items-center"},rt={class:"card-bg p-4"},it={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},dt={class:"relative"},ct=["value"],ut={class:"relative"},pt={key:0,class:"text-red-600 font-semibold"},yt={key:2,class:"overflow-x-auto"},xt={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},vt={class:"text-gray-600 text-sm"},mt={class:"py-3 px-2"},bt={class:"py-3 px-2"},gt={class:"py-3 px-2 text-center"},_t={class:"py-3 px-2 text-center"},ft={class:"py-3 px-2 text-center"},ht={class:"py-3 px-2 text-center"},Ft={class:"py-3 px-2 text-center"},kt={class:"py-3 px-2 text-center"},wt={class:"py-3 px-2 text-center"},Ct={class:"flex items-center justify-center gap-4"},$t=["onClick"],Lt={key:1},Dt={__name:"CollectFeeList",setup(i){const k=E(),y=A(),x=u(!0),_=u(""),l=u(""),v=u(""),c=u(""),g=u(!1),f=u(null),h=u(null),F=I(()=>[...y.collectFees].sort((a,e)=>new Date(e.created_at)-new Date(a.created_at))),d=async()=>{try{x.value=!0;const a={};_.value&&(a.zamat_id=_.value),l.value&&(a.payment_method=l.value),v.value&&(a.institute_code=v.value),c.value&&(a.transaction_id=c.value),await y.fetchCollectFees(a)}finally{x.value=!1}};K(async()=>{await k.fetchZamats(),d()});const w=async a=>{var e,m;try{x.value=!0;const s=await y.fetchCollectFee(a);f.value=(e=s==null?void 0:s.data)==null?void 0:e.feeCollection,h.value=(m=s==null?void 0:s.data)==null?void 0:m.students,g.value=!0}finally{x.value=!1}};return(a,e)=>{const m=M("RouterLink");return n(),r(L,null,[t("div",nt,[t("div",at,[e[6]||(e[6]=t("h1",{class:"title-lg"},"Fee Collections List",-1)),D(m,{to:{name:"CollectFee"},class:"btn-2"},{default:R(()=>e[5]||(e[5]=[p("নতুন ফি গ্রহণ")])),_:1})]),t("div",rt,[t("div",it,[t("div",dt,[$(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),type:"text",class:"input-1 text-center",placeholder:"ইলহাক নং",onKeyup:B(d,["enter"])},null,544),[[z,v.value]]),v.value?(n(),r("button",{key:0,onClick:d,class:"absolute right-3 top-2.5"},e[7]||(e[7]=[t("i",{class:"fas fa-search"},null,-1)]))):S("",!0)]),$(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>_.value=s),class:"input-1 text-center",onChange:d},[e[8]||(e[8]=t("option",{value:""},"- সকল মারহালা -",-1)),(n(!0),r(L,null,N(V(k).zamats,s=>(n(),r("option",{key:s.id,value:s.id},o(s.name),9,ct))),128))],544),[[j,_.value]]),$(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.value=s),class:"input-1 text-center",onChange:d},e[9]||(e[9]=[t("option",{value:""},"- পেমেন্ট মেথড -",-1),t("option",{value:"offline"},"অফলাইন",-1),t("option",{value:"online"},"অনলাইন",-1)]),544),[[j,l.value]]),t("div",ut,[$(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>c.value=s),type:"text",placeholder:"TRX ID",class:"input-1 text-center",onKeyup:B(d,["enter"])},null,544),[[z,c.value]]),c.value?(n(),r("button",{key:0,onClick:d,class:"absolute right-3 top-2.5"},e[10]||(e[10]=[t("i",{class:"fas fa-search"},null,-1)]))):S("",!0)])])]),V(y).error?(n(),r("div",pt,o(V(y).error),1)):S("",!0),x.value?(n(),O(T,{key:1})):(n(),r("div",yt,[t("table",xt,[e[13]||(e[13]=t("thead",null,[t("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[t("th",{class:"py-3 px-2 text-left"},"#"),t("th",{class:"py-3 px-2 text-left"},"মাদ্রাসার নাম"),t("th",{class:"py-3 px-2 text-center"},"মারহালা"),t("th",{class:"py-3 px-2 text-center"},"পরিক্ষার্থী সংখ্যা"),t("th",{class:"py-3 px-2 text-center"},"ফি’র পরিমাণ"),t("th",{class:"py-3 px-2 text-center"},"মাধ্যম"),t("th",{class:"py-3 px-2 text-center"},"ট্রান্স. আইডি"),t("th",{class:"py-3 px-2 text-center"},"তারিখ ও সময়"),t("th",{class:"py-3 px-2 text-center"},"একশন")])],-1)),t("tbody",vt,[F.value.length?(n(!0),r(L,{key:0},N(F.value,(s,C)=>(n(),r("tr",{key:s.id,class:"border-b border-gray-200 hover:bg-gray-100"},[t("td",mt,o(C+1),1),t("td",bt,o(s.institute.institute_code)+" - "+o(s.institute.name),1),t("td",gt,o(s.zamat.name),1),t("td",_t,o(JSON.parse(s.student_ids).length),1),t("td",ft,o(s.total_amount),1),t("td",ht,o(s.payment_method),1),t("td",Ft,o(s.transaction_id||"N/A"),1),t("td",kt,o(new Date(s.created_at).toLocaleString("bn-BD",{hour12:!0})),1),t("td",wt,[t("div",Ct,[t("button",{onClick:b=>w(s.id),class:"text-blue-600 hover:text-blue-800"},e[11]||(e[11]=[t("i",{class:"fas fa-eye"},null,-1)]),8,$t)])])]))),128)):(n(),r("tr",Lt,e[12]||(e[12]=[t("td",{colspan:"9",class:"text-center text-red-500 py-4"},"No fee collections found",-1)])))])])]))]),D(ot,{visible:g.value,collectFee:f.value,students:h.value,onClose:e[4]||(e[4]=s=>g.value=!1)},null,8,["visible","collectFee","students"])],64)}}};export{Dt as default};
