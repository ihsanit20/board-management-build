import{r as u,O as $,o as L,c as m,a as t,t as a,y as x,n as N,k as S,F as q,e as E,p as F,j as v,v as f,h as O,d as c,q as z,L as R}from"./index-VisWtOtk.js";import{u as T}from"./committee-store-DH7sxf1D.js";const I={key:0,class:"px-4 space-y-2"},A={class:"flex justify-between items-center"},G={class:"title-lg"},H={class:"text-gray-600"},J={class:"flex justify-between items-center"},K={class:"flex items-center gap-2"},P=["disabled"],Q={class:"text-sm text-gray-500"},W={key:1,class:"overflow-x-auto"},X={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},Y={class:"text-gray-600 text-sm font-light"},Z={class:"py-3 px-2 text-left whitespace-nowrap"},ee={class:"font-medium"},te={class:"py-3 px-2 text-left"},se={class:"font-medium"},le={class:"py-3 px-2 text-left"},oe={class:"font-medium"},ne={class:"py-3 px-2 text-left"},ae={class:"font-medium"},ie={class:"py-3 px-2 text-left"},de={class:"font-medium"},re={class:"py-3 px-2 text-center"},ue={class:"flex item-center justify-center gap-4"},ce=["onClick"],pe=["onClick"],me=["onClick","disabled"],ve=["onClick","disabled"],fe={key:1},be={class:"text-lg font-semibold"},ye={class:"grid gap-2"},xe={class:"grid grid-cols-2 gap-2"},ge={class:"flex justify-end gap-2 pt-2"},he=["disabled"],Ce={__name:"CommitteeDetail",setup(_e){const C=z(),r=T(),i=u(null),n=u([]),h=u(!0),b=u(null),o=$({id:null,name:"",designation:"",phone:"",email:"",order:null}),y=u(!1),g=u(!1),_=s=>s?String(s).slice(0,10):"—";async function M(){const s=Number(C.params.id),e=await r.getCommittee(s);i.value=e,n.value=[...r.membersByCommittee[s]||[]]}function V(){var s,e;Object.assign(o,{id:null,name:"",designation:"",phone:"",email:"",order:null}),(e=(s=b.value)==null?void 0:s.showModal)==null||e.call(s)}function j(s){var e,l;Object.assign(o,s),(l=(e=b.value)==null?void 0:e.showModal)==null||l.call(e)}function w(){var s,e;(e=(s=b.value)==null?void 0:s.close)==null||e.call(s)}async function B(){try{y.value=!0;const s=i.value.id;if(o.id){const e=await r.updateMember(o.id,o,s),l=n.value.findIndex(d=>d.id===e.id);l!==-1&&(n.value[l]=e)}else{const e=await r.createMember(s,o);n.value.push(e)}w()}catch(s){console.error(s)}finally{y.value=!1}}async function D(s){if(confirm("এই সদস্যকে মুছে ফেলতে চাও?"))try{await r.deleteMember(s,i.value.id),n.value=n.value.filter(e=>e.id!==s)}catch(e){console.error(e)}}function k(s,e){const l=s+e;if(l<0||l>=n.value.length)return;const d=n.value,p=d[s];d.splice(s,1),d.splice(l,0,p)}async function U(){try{g.value=!0;const s=n.value.map((e,l)=>({id:e.id,order:l+1}));await r.reorderMembers(i.value.id,s),n.value=[...r.membersByCommittee[i.value.id]||[]]}catch(s){console.error(s)}finally{g.value=!1}}return L(async()=>{try{await M()}finally{h.value=!1}}),(s,e)=>i.value?(c(),m("div",I,[t("div",A,[t("div",null,[t("h1",G,a(i.value.name),1),t("p",H,[e[6]||(e[6]=x(" সেশন: ")),t("b",null,a(i.value.session||"—"),1),e[7]||(e[7]=x(" · শুরু: ")),t("b",null,a(_(i.value.start_date)),1),e[8]||(e[8]=x(" · শেষ: ")),t("b",null,a(_(i.value.end_date)),1),e[9]||(e[9]=x(" · অবস্থা: ")),t("b",{class:N(i.value.is_active?"text-green-600":"text-gray-400")},a(i.value.is_active?"একটিভ":"ইন-একটিভ"),3)])])]),t("div",J,[t("div",K,[t("button",{class:"btn-3",onClick:e[0]||(e[0]=l=>s.$router.push({name:"CommitteesList"}))},"ফিরে যান"),t("button",{class:"btn-2",onClick:V},"+ নতুন সদস্য"),t("button",{class:"btn-1",disabled:g.value,onClick:U},"সংরক্ষণ (ক্রম)",8,P)]),t("div",Q,"মোট সদস্য: "+a(n.value.length),1)]),h.value?(c(),S(R,{key:0})):(c(),m("div",W,[t("table",X,[e[15]||(e[15]=t("thead",null,[t("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[t("th",{class:"py-3 px-2 text-left"},"#"),t("th",{class:"py-3 px-2 text-left"},"নাম"),t("th",{class:"py-3 px-2 text-left"},"পদবি"),t("th",{class:"py-3 px-2 text-left"},"ফোন"),t("th",{class:"py-3 px-2 text-left"},"ইমেইল"),t("th",{class:"py-3 px-2 text-center"},"একশন")])],-1)),t("tbody",Y,[n.value.length?(c(!0),m(q,{key:0},E(n.value,(l,d)=>(c(),m("tr",{key:l.id,class:"border-b border-gray-200 hover:bg-gray-100"},[t("td",Z,[t("p",ee,a(l.order??d+1),1)]),t("td",te,[t("p",se,a(l.name),1)]),t("td",le,[t("p",oe,a(l.designation||"—"),1)]),t("td",ne,[t("p",ae,a(l.phone||"—"),1)]),t("td",ie,[t("p",de,a(l.email||"—"),1)]),t("td",re,[t("div",ue,[t("button",{class:"text-blue-600 hover:text-blue-800",onClick:p=>j(l),title:"Edit"},e[10]||(e[10]=[t("i",{class:"fas fa-edit"},null,-1)]),8,ce),t("button",{class:"text-red-600 hover:text-red-800",onClick:p=>D(l.id),title:"Delete"},e[11]||(e[11]=[t("i",{class:"fas fa-trash"},null,-1)]),8,pe),t("button",{class:"text-gray-600 hover:text-gray-800",onClick:p=>k(d,-1),disabled:d===0,title:"Move Up"},e[12]||(e[12]=[t("i",{class:"fas fa-arrow-up"},null,-1)]),8,me),t("button",{class:"text-gray-600 hover:text-gray-800",onClick:p=>k(d,1),disabled:d===n.value.length-1,title:"Move Down"},e[13]||(e[13]=[t("i",{class:"fas fa-arrow-down"},null,-1)]),8,ve)])])]))),128)):(c(),m("tr",fe,e[14]||(e[14]=[t("td",{colspan:"6",class:"text-center text-red-500 py-4"},"কোনো সদস্য পাওয়া যায়নি",-1)])))])])])),t("dialog",{ref_key:"dlg",ref:b,class:"z-40"},[t("form",{onSubmit:F(B,["prevent"]),class:"bg-white p-4 rounded-lg space-y-3 min-w-[320px]"},[t("h3",be,a(o.id?"সদস্য সম্পাদনা":"নতুন সদস্য"),1),t("div",ye,[v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>o.name=l),placeholder:"নাম",required:"",class:"border rounded px-3 py-2"},null,512),[[f,o.name]]),v(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.designation=l),placeholder:"পদবি",required:"",class:"border rounded px-3 py-2"},null,512),[[f,o.designation]]),t("div",xe,[v(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.phone=l),placeholder:"ফোন",class:"border rounded px-3 py-2"},null,512),[[f,o.phone]]),v(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.email=l),placeholder:"ইমেইল",class:"border rounded px-3 py-2"},null,512),[[f,o.email]])]),v(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.order=l),type:"number",min:"0",class:"border rounded px-3 py-2",placeholder:"ডিসপ্লে অর্ডার (ঐচ্ছিক)"},null,512),[[f,o.order,void 0,{number:!0}]])]),t("div",ge,[t("button",{type:"button",class:"btn-1",onClick:w},"বাতিল"),t("button",{type:"submit",class:"btn-2",disabled:y.value},a(y.value?"সেভ হচ্ছে…":"সেভ"),9,he)])],32)],512)])):O("",!0)}};export{Ce as default};
