import{r as _,i as S,o as I,c as n,t as u,h as d,k as F,b as i,a as e,f as L,w as N,F as M,e as T,p as q,q as A,z as O,d as c,y as z,j as B,v as C,L as G}from"./index-TvokxHqA.js";import{u as H}from"./result-zpSe0DUn.js";const J={class:"my-container space-y-4"},K={key:0,class:"text-center text-red-500"},P={key:2,class:"text-center text-gray-500"},Q={key:3},W={class:"mb-4 flex gap-4 justify-between"},X={class:"card-bg p-4"},Y={class:"title-md text-center"},Z={class:""},ee={class:"table-auto border-collapse w-full"},te={class:"border border-black px-2 py-1 text-center"},se={class:"border border-black px-2 py-1"},ae={class:"border border-black px-2 py-1 text-center"},oe={class:"border border-black px-2 py-1 text-center"},re={class:"border border-black px-2 py-1 text-center"},le=["onUpdate:modelValue"],ce={class:"border border-black px-2 py-1 text-center"},ne=["onUpdate:modelValue"],ue={class:"mt-4 flex gap-4 justify-between"},pe={__name:"ExamResultSubjectMarkView",setup(de){const l=H(),E=A(),{centerId:x,zamatId:m,examSubjectId:k}=E.params,v=_(null),b=_(!1),y=_(""),r=_({}),R=S(()=>l.results.length),h=S(()=>l.students.length);I(async()=>{try{b.value=!0,r.value={},await l.fetchResultData({center_id:x,zamat_id:m,exam_subject_id:k});const a=Object.fromEntries(l.results.map(t=>[t.student_id,t]));l.students.forEach(t=>{const o=a[t.id]||null,p=(o==null?void 0:o.marks)||["",""];r.value[t.id]=[p[0]||"",p[1]||""]}),v.value=l.examSubjects[0]}catch(a){y.value="ডাটা লোড করতে সমস্যা হয়েছে।",console.error(a)}finally{b.value=!1}});async function D(){await l.submitMarks(m,k,{marks:r.value})}const U=a=>{let t=0,o=0;return a&&a[0]!==""&&(t+=Number(a[0]),o++),a&&a[1]!==""&&(t+=Number(a[1]),o++),o>0?t/o:0};return(a,t)=>{var p,g,w,j,V;const o=O("RouterLink");return c(),n("div",J,[y.value?(c(),n("div",K,u(y.value),1)):d("",!0),b.value?(c(),F(G,{key:1})):d("",!0),!b.value&&h.value===0&&R.value===0?(c(),n("div",P," কোন ডাটা পাওয়া যায়নি। ")):d("",!0),!i(l).loading&&!b.value&&h.value>0?(c(),n("div",Q,[e("form",{onSubmit:q(D,["prevent"]),class:"w-full overflow-x-auto"},[e("div",W,[L(o,{to:`/exam-results?zamat=${i(m)}&center=${i(x)}`,class:"btn-contrast"},{default:N(()=>t[0]||(t[0]=[z(" পিছনে যান ")])),_:1},8,["to"]),t[1]||(t[1]=e("h1",{class:"title-lg"},"পরীক্ষার ফলাফল যুক্ত করুন",-1)),t[2]||(t[2]=e("button",{type:"submit",class:"btn-2"},"সংরক্ষণ করুন",-1))]),e("div",X,[e("div",Y,[e("p",Z,"মারহালা: "+u((w=(g=(p=v.value)==null?void 0:p.subject)==null?void 0:g.zamat)==null?void 0:w.name),1),e("p",null,"সাবজেক্ট: "+u((V=(j=v.value)==null?void 0:j.subject)==null?void 0:V.name),1)]),e("table",ee,[t[3]||(t[3]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"border border-black px-2 py-1"},"#"),e("th",{class:"border border-black px-2 py-1"},"পরীক্ষার্থীর নাম"),e("th",{class:"border border-black px-2 py-1"},"রোল"),e("th",{class:"border border-black px-2 py-1"},"চূরান্ত মার্ক (গড়)"),e("th",{class:"border border-black px-2 py-1"},"মার্ক (১ম পরিক্ষক)"),e("th",{class:"border border-black px-2 py-1"},"মার্ক (২য় পরিক্ষক)")])],-1)),e("tbody",null,[(c(!0),n(M,null,T(i(l).students,(s,$)=>(c(),n("tr",{key:s.id},[e("td",te,u(Number($+1).toLocaleString("bn-BD")),1),e("td",se,u(s==null?void 0:s.name),1),e("td",ae,u(s.roll_number),1),e("td",oe,u(U(r.value[s.id])),1),e("td",re,[r.value[s.id]?B((c(),n("input",{key:0,type:"text","onUpdate:modelValue":f=>r.value[s.id][0]=f,class:"input-1 text-center"},null,8,le)),[[C,r.value[s.id][0]]]):d("",!0)]),e("td",ce,[r.value[s.id]?B((c(),n("input",{key:0,type:"text","onUpdate:modelValue":f=>r.value[s.id][1]=f,class:"input-1 text-center"},null,8,ne)),[[C,r.value[s.id][1]]]):d("",!0)])]))),128))])])]),e("div",ue,[L(o,{to:`/exam-results?zamat=${i(m)}&center=${i(x)}`,class:"btn-contrast"},{default:N(()=>t[4]||(t[4]=[z(" পিছনে যান ")])),_:1},8,["to"]),t[5]||(t[5]=e("button",{type:"submit",class:"btn-2"},"সংরক্ষণ করুন",-1))])],32)])):d("",!0)])}}};export{pe as default};
