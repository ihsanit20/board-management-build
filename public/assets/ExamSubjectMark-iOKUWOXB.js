import{P as w,r as x,Q as f,i as E,c as u,a,b as y,k as $,F as v,e as k,d as c,t as g,j,v as S,L as I}from"./index-BXAMF6o-.js";import{u as M}from"./subject-C0Vvrj46.js";const V=w("examSubject",()=>{const i=x([]),p=x(null),o=x(!1);async function n(){o.value=!0;try{const e=await f.get("/exam-subjects");i.value=e.data}catch(e){console.error("Error fetching exam subjects:",e)}finally{o.value=!1}}async function d(e){o.value=!0;try{const t=await f.get(`/exam-subjects/${e}`);p.value=t.data}catch(t){console.error(`Error fetching exam subject with id ${e}:`,t)}finally{o.value=!1}}async function _(e){try{const t=await f.post("/exam-subjects",e);i.value.push(t.data)}catch(t){console.error("Error creating exam subject:",t)}}async function b(e,t){try{const l=await f.put(`/exam-subjects/${e}`,t),s=i.value.findIndex(r=>r.id===e);s!==-1&&(i.value[s]=l.data)}catch(l){console.error(`Error updating exam subject with id ${e}:`,l)}}async function h(e){try{await f.delete(`/exam-subjects/${e}`),i.value=i.value.filter(t=>t.id!==e)}catch(t){console.error(`Error deleting exam subject with id ${e}:`,t)}}return{examSubjects:i,examSubject:p,loading:o,fetchExamSubjects:n,fetchExamSubject:d,createExamSubject:_,updateExamSubject:b,deleteExamSubject:h}}),B={class:"my-container space-y-4"},C={key:1},U={class:"flex justify-between items-center mb-2"},D={class:"text-lg font-semibold"},F=["onClick"],L=["onClick"],P={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},Z={class:"text-gray-600 text-sm font-light"},Q={class:"py-3 px-2 text-left"},T={class:"title-md"},q={class:"py-3 px-2 text-left"},A=["onUpdate:modelValue","disabled"],G={class:"py-3 px-2 text-left"},H=["onUpdate:modelValue","disabled"],O={__name:"ExamSubjectMark",setup(i){const p=M(),o=V(),n=x({}),d=x({}),_=E(()=>{const e={};return p.subjects.forEach(t=>{var r;const l=((r=t.zamat)==null?void 0:r.name)||"Unknown Zamat";e[l]||(e[l]=[]),e[l].push(t);const s=o.examSubjects.find(m=>parseInt(m.subject_id)===parseInt(t.id));s?n.value[t.id]={full_marks:s.full_marks,pass_marks:s.pass_marks}:n.value[t.id]||(n.value[t.id]={full_marks:"",pass_marks:""})}),e}),b=e=>{d.value[e]=!d.value[e]},h=async e=>{const t=_.value[e];try{await Promise.all(t.map(async l=>{const s=n.value[l.id],r=o.examSubjects.find(m=>m.subject_id===l.id);r?await o.updateExamSubject(r.id,{full_marks:parseInt(s.full_marks,10),pass_marks:parseInt(s.pass_marks,10)}):await o.createExamSubject({subject_id:l.id,full_marks:parseInt(s.full_marks,10),pass_marks:parseInt(s.pass_marks,10)})})),alert(`${e} Marks saved successfully!`),b(e)}catch(l){console.error(`Error saving marks for ${e}:`,l),alert("Failed to save marks.")}};return p.fetchSubjects(),o.fetchExamSubjects(),(e,t)=>(c(),u("div",B,[t[1]||(t[1]=a("div",{class:"flex justify-between items-center"},[a("h1",{class:"title-lg"},"সাবজেক্টে মার্ক যুক্ত করুন")],-1)),y(p).loading||y(o).loading?(c(),$(I,{key:0})):(c(),u("div",C,[(c(!0),u(v,null,k(_.value,(l,s)=>(c(),u("div",{key:s,class:"mb-4"},[a("div",U,[a("h2",D,g(s),1),d.value[s]?(c(),u("button",{key:1,class:"btn-2",onClick:r=>h(s)},"সেভ",8,L)):(c(),u("button",{key:0,class:"btn-3",onClick:r=>b(s)}," এডিট ",8,F))]),a("table",P,[t[0]||(t[0]=a("thead",null,[a("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[a("th",{class:"py-3 px-2 text-left"},"নাম"),a("th",{class:"py-3 px-2 text-left"},"পূর্ণমান"),a("th",{class:"py-3 px-2 text-left"},"পাশ মার্ক")])],-1)),a("tbody",Z,[(c(!0),u(v,null,k(l,r=>(c(),u("tr",{key:r.id,class:"border-b border-gray-200 hover:bg-gray-100"},[a("td",Q,[a("p",T,g(r.name),1)]),a("td",q,[j(a("input",{"onUpdate:modelValue":m=>n.value[r.id].full_marks=m,type:"number",placeholder:"পূর্ণমান",class:"input-1 w-full",disabled:!d.value[s]},null,8,A),[[S,n.value[r.id].full_marks]])]),a("td",G,[j(a("input",{"onUpdate:modelValue":m=>n.value[r.id].pass_marks=m,type:"number",placeholder:"পাশ মার্ক",class:"input-1 w-full",disabled:!d.value[s]},null,8,H),[[S,n.value[r.id].pass_marks]])])]))),128))])])]))),128))]))]))}};export{O as default};
