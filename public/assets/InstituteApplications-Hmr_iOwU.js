import{O as A,c as p,a as t,j as d,D as c,s as D,v as g,b as i,h as b,t as o,F as C,e as L,d as u,n as m,p as N}from"./index-CBPYhcDR.js";import{u as U}from"./institute-application-CERlZ3V6.js";const V={class:"my-container"},I={class:"card-bg p-4 mb-4 grid md:grid-cols-6 gap-3"},S={class:"md:col-span-6 flex items-center gap-3"},T={key:0,class:"text-sm text-gray-500"},E={key:1,class:"text-sm text-red-600"},P={class:"card-bg p-4"},F={class:"overflow-auto border rounded"},$={class:"min-w-full text-sm"},j={class:"p-2"},R={class:"p-2"},h={class:"p-2"},q={class:"p-2"},O={class:"p-2"},B={class:"p-2"},W={class:"p-2"},M={class:"p-2"},Y={class:"p-2 text-right"},z={class:"flex items-center gap-2 justify-end"},G=["onClick"],H=["onClick","disabled"],J={key:0},K={class:"flex items-center justify-between mt-4 text-sm"},Q={class:"flex items-center gap-2"},X=["disabled"],Z=["disabled"],w=["disabled"],tt=["disabled"],at={__name:"InstituteApplications",setup(et){const y=N(),n=U(),a=A({status:"",type:"",q:"",area_id:"",institute_id:"",date_from:"",date_to:"",per_page:20,page:1});function x(l=!0){l&&(a.page=1),n.setFilters({...a}),n.fetchList()}function v(){Object.assign(a,{status:"",type:"",q:"",area_id:"",institute_id:"",date_from:"",date_to:"",per_page:20,page:1}),x()}x(!1);function r(l){l<1||l>n.pagination.last_page||(a.page=l,x(!1))}async function _(l){var s;const e=(l==null?void 0:l.id)??((s=l==null?void 0:l.application)==null?void 0:s.id);e&&y.push({name:"InstituteApplicationReview",params:{id:e}})}async function k(l){var s;const e=(l==null?void 0:l.id)??((s=l==null?void 0:l.application)==null?void 0:s.id);if(e&&confirm(`Delete application #${e}?`))try{await n.destroy(e),n.items.length===0&&n.pagination.current_page>1&&r(n.pagination.current_page-1)}catch{}}return(l,e)=>(u(),p("div",V,[e[26]||(e[26]=t("h1",{class:"title-lg"},"ইলহাকী আবেদন তালিকা",-1)),t("div",I,[t("div",null,[e[14]||(e[14]=t("label",{class:"text-xs text-gray-500"},"Status",-1)),d(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.status=s),class:"input-1 w-full"},e[13]||(e[13]=[D('<option value="">All</option><option value="pending">pending</option><option value="approved">approved</option><option value="rejected">rejected</option><option value="needs_info">needs_info</option>',5)]),512),[[c,a.status]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"text-xs text-gray-500"},"Type",-1)),d(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.type=s),class:"input-1 w-full"},e[15]||(e[15]=[t("option",{value:""},"All",-1),t("option",{value:"NEW"},"NEW",-1),t("option",{value:"UPDATE"},"UPDATE",-1),t("option",{value:"DETAILS_ONLY"},"DETAILS_ONLY",-1)]),512),[[c,a.type]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"text-xs text-gray-500"},"Search (name/phone)",-1)),d(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.q=s),class:"input-1 w-full",placeholder:"name or phone"},null,512),[[g,a.q]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"text-xs text-gray-500"},"Area ID",-1)),d(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.area_id=s),type:"number",class:"input-1 w-full"},null,512),[[g,a.area_id]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"text-xs text-gray-500"},"Institute ID",-1)),d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>a.institute_id=s),type:"number",class:"input-1 w-full"},null,512),[[g,a.institute_id]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"text-xs text-gray-500"},"Per Page",-1)),d(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.per_page=s),class:"input-1 w-full"},e[20]||(e[20]=[t("option",{value:10},"10",-1),t("option",{value:20},"20",-1),t("option",{value:50},"50",-1),t("option",{value:100},"100",-1)]),512),[[c,a.per_page,void 0,{number:!0}]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"text-xs text-gray-500"},"From",-1)),d(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>a.date_from=s),type:"date",class:"input-1 w-full"},null,512),[[g,a.date_from]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"text-xs text-gray-500"},"To",-1)),d(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>a.date_to=s),type:"date",class:"input-1 w-full"},null,512),[[g,a.date_to]])]),t("div",S,[t("button",{class:"px-4 py-2 rounded bg-blue-600 text-white",onClick:e[8]||(e[8]=s=>x())}," Apply "),t("button",{class:"px-4 py-2 rounded border",onClick:v},"Reset"),i(n).loadingList?(u(),p("span",T,"Loading…")):b("",!0),i(n).error?(u(),p("span",E,o(i(n).error),1)):b("",!0)])]),t("div",P,[t("div",F,[t("table",$,[e[25]||(e[25]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"text-left p-2"},"ID"),t("th",{class:"text-left p-2"},"Type"),t("th",{class:"text-left p-2"},"Status"),t("th",{class:"text-left p-2"},"Name"),t("th",{class:"text-left p-2"},"Phone"),t("th",{class:"text-left p-2"},"Institute"),t("th",{class:"text-left p-2"},"Area"),t("th",{class:"text-left p-2"},"Created"),t("th",{class:"text-right p-2"},"Actions")])],-1)),t("tbody",null,[(u(!0),p(C,null,L(i(n).items,s=>(u(),p("tr",{key:s.id,class:"border-t"},[t("td",j,o(s.id),1),t("td",R,[t("span",{class:m(["px-2 py-0.5 rounded text-white",s.type==="NEW"?"bg-indigo-600":s.type==="UPDATE"?"bg-amber-600":"bg-teal-600"])},o(s.type),3)]),t("td",h,[t("span",{class:m(["px-2 py-0.5 rounded text-white",s.status==="approved"?"bg-emerald-600":s.status==="rejected"?"bg-red-600":s.status==="needs_info"?"bg-yellow-600":"bg-gray-600"])},o(s.status),3)]),t("td",q,o(s.name||"—"),1),t("td",O,o(s.phone||"—"),1),t("td",B,o(s.institute_id??"—"),1),t("td",W,o(s.area_id??"—"),1),t("td",M,o(new Date(s.created_at).toLocaleString()),1),t("td",Y,[t("div",z,[t("button",{class:"px-3 py-1 rounded bg-blue-600 text-white",onClick:f=>_(s)}," Review ",8,G),t("button",{class:"px-3 py-1 rounded bg-red-600 text-white",onClick:f=>k(s),disabled:i(n).deleting}," Delete ",8,H)])])]))),128)),!i(n).loadingList&&i(n).items.length===0?(u(),p("tr",J,e[24]||(e[24]=[t("td",{colspan:"9",class:"p-4 text-center text-gray-500"},"No applications found.",-1)]))):b("",!0)])])]),t("div",K,[t("div",null," Page "+o(i(n).pagination.current_page)+" of "+o(i(n).pagination.last_page)+" — Total "+o(i(n).pagination.total),1),t("div",Q,[t("button",{class:"px-3 py-1 rounded border",onClick:e[9]||(e[9]=s=>r(1)),disabled:i(n).pagination.current_page<=1}," « First ",8,X),t("button",{class:"px-3 py-1 rounded border",onClick:e[10]||(e[10]=s=>r(i(n).pagination.current_page-1)),disabled:i(n).pagination.current_page<=1}," ‹ Prev ",8,Z),t("button",{class:"px-3 py-1 rounded border",onClick:e[11]||(e[11]=s=>r(i(n).pagination.current_page+1)),disabled:i(n).pagination.current_page>=i(n).pagination.last_page}," Next › ",8,w),t("button",{class:"px-3 py-1 rounded border",onClick:e[12]||(e[12]=s=>r(i(n).pagination.last_page)),disabled:i(n).pagination.current_page>=i(n).pagination.last_page}," Last » ",8,tt)])])])]))}};export{at as default};
