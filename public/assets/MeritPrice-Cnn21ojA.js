import{B as C,r as f,i as V,o as B,c as i,a as s,j as g,D as j,F as h,e as y,b as v,m as D,d as l,t as x,k as w,v as L,L as N}from"./index-DXxrbR31.js";import{u as U}from"./zamat-BeKk-UwW.js";import{u as F}from"./merit-price-B81VGpLs.js";const T={class:"my-container space-y-6"},Z={class:"flex justify-between items-center"},$=["value"],q={key:1},A={class:"flex justify-between items-center mb-2"},G={class:"text-lg font-semibold"},H=["onClick"],J=["onClick"],K={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},O={class:"py-3 px-2"},Q={class:"py-3 px-2"},R=["onUpdate:modelValue","disabled"],z={__name:"MeritPrice",setup(W){const d=C(),m=U(),u=F(),n=f(null),c=f({}),o=f({}),p=["১ম","২য়","৩য়","অন্যান্য"],b=V(()=>m.zamats||[]),k=e=>{c.value[e]=!c.value[e]},E=async e=>{const a={exam_id:n.value,zamat_id:e,merit_names:[],price_amounts:[]};p.forEach(t=>{a.merit_names.push(t),a.price_amounts.push(parseInt(o.value[e][t]||0,10))}),await u.storeMeritPrices(a),await _(n.value),c.value[e]=!1,alert("সেভ সফল হয়েছে!")},M=()=>{o.value={},b.value.forEach(e=>{o.value[e.id]={},p.forEach(a=>{o.value[e.id][a]=""})}),u.meritPrices.forEach(e=>{o.value[e.zamat_id]||(o.value[e.zamat_id]={}),o.value[e.zamat_id][e.merit_name]=e.price_amount})},_=async e=>{await u.fetchMeritPrices(e),M()};B(async()=>{await d.fetchExams(),await m.fetchZamats(),d.exams.length>0&&(n.value=d.exams[0].id,await _(n.value))});const P=async()=>{n.value&&await _(n.value)};return(e,a)=>(l(),i("div",T,[s("div",Z,[a[1]||(a[1]=s("h1",{class:"title-lg"},"মেধাস্থান প্রাইজ সেটিং",-1)),g(s("select",{"onUpdate:modelValue":a[0]||(a[0]=t=>n.value=t),onChange:P,class:"input-1 max-w-xs"},[(l(!0),i(h,null,y(v(d).exams,t=>(l(),i("option",{key:t.id,value:t.id},x(t.name),9,$))),128))],544),[[j,n.value]])]),v(d).loading||v(m).loading||v(u).loading?(l(),D(N,{key:0})):(l(),i("div",q,[(l(!0),i(h,null,y(b.value,t=>(l(),i("div",{key:t.id,class:"mb-6"},[s("div",A,[s("h2",G,x(t.name),1),c.value[t.id]?(l(),i("button",{key:1,class:"btn-2",onClick:r=>E(t.id)},a[3]||(a[3]=[s("i",{class:"fas fa-save"},null,-1),w(" সেভ ")]),8,J)):(l(),i("button",{key:0,class:"btn-3",onClick:r=>k(t.id)},a[2]||(a[2]=[s("i",{class:"fas fa-edit"},null,-1),w(" এডিট ")]),8,H))]),s("table",K,[a[4]||(a[4]=s("thead",null,[s("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[s("th",{class:"py-3 px-2 text-left"},"মেধাস্থান"),s("th",{class:"py-3 px-2 text-left"},"প্রাইজ (৳)")])],-1)),s("tbody",null,[(l(),i(h,null,y(p,r=>s("tr",{key:r,class:"border-b hover:bg-gray-50"},[s("td",O,x(r),1),s("td",Q,[g(s("input",{"onUpdate:modelValue":S=>o.value[t.id][r]=S,type:"number",placeholder:"৳",class:"input-1 w-full",disabled:!c.value[t.id]},null,8,R),[[L,o.value[t.id][r]]])])])),64))])])]))),128))]))]))}};export{z as default};
