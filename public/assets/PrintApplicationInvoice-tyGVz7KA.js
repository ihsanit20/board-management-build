import{_ as P,B as V,r as w,i as u,C as L,o as O,c as p,a as t,j as E,v as T,D as U,F as M,e as N,b as q,t as d,h as D,l as W,d as m,n as Y}from"./index-DEpdMT1V.js";import{_ as G}from"./logo-name-CJ0dX4ea.js";import{_ as H}from"./sign-BrQ60Aw4.js";import{u as J}from"./application-D7_6mFef.js";const K={class:"my-container space-y-4"},Q={class:"card-bg md:flex-row p-4 print:hidden"},R={class:"grid grid-cols-1 md:grid-cols-3 gap-3 w-full max-w-3xl"},X=["value"],Z={class:"flex gap-2"},z=["disabled"],tt={key:0,class:"mt-3 text-sm text-red-600"},et={class:"bg-white shadow print:shadow-none print:rounded-none rounded-xl border print:border-0"},st={class:"p-5 md:p-6 border-b relative"},ot={class:"flex flex-col justify-center items-center gap-2"},nt={class:"text-center"},at={class:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3"},lt={class:"flex md:justify-end"},dt={class:"border px-3 py-2 rounded"},it={class:"ml-2"},rt={class:"mt-4 space-y-2"},ct={class:"grid grid-cols-12 gap-2 items-center"},ut={class:"col-span-10 md:col-span-10 border rounded px-3 py-2 min-h-[42px]"},pt={class:"grid grid-cols-12 gap-2 items-center"},mt={class:"col-span-10 md:col-span-10 border rounded px-3 py-2 min-h-[42px]"},vt={class:"p-5 md:p-6"},xt={class:"overflow-x-auto"},_t={class:"w-full border"},gt={key:0},ft={class:"px-3 py-2 border"},bt={class:"px-3 py-2 border text-center font-medium"},yt={class:"px-3 py-2 border text-center"},ht={class:"px-3 py-2 border text-right font-semibold"},wt={class:"mt-4 grid grid-cols-12 gap-3"},St={class:"col-span-12 md:col-span-6"},kt={class:"grid grid-cols-12"},It={class:"col-span-6 border px-3 py-2"},jt={class:"col-span-12 md:col-span-6"},Et={class:"grid grid-cols-12"},Mt={class:"col-span-6 border px-3 py-2 text-right font-semibold"},Nt={class:"mt-3"},Dt={class:"bg-gray-50 border px-3 py-3 rounded"},At={class:"ml-2"},Bt={__name:"PrintApplicationInvoice",setup(Ct){const i=V(),_=J(),g=w(""),c=w(""),f=w(!1),A=u(()=>{const s=new Date,e=l=>String(l).padStart(2,"0");return`${e(s.getDate())}-${e(s.getMonth()+1)}-${s.getFullYear()}`}),v=s=>{const e="0123456789,.",l="০১২৩৪৫৬৭৮৯,.";return String(s).split("").map(o=>{const n=e.indexOf(o);return n>=0?l[n]:o}).join("")};function y(s){const l=Number(s||0).toLocaleString("en-IN",{maximumFractionDigits:0});return v(l)}function B(s){const e=Math.round(Number(s||0));if(!e)return"শূন্য টাকা মাত্র";const l=[{name:"কোটি",value:1e7},{name:"লাখ",value:1e5},{name:"হাজার",value:1e3},{name:"শত",value:100}],o=[];let n=e;for(const r of l)if(n>=r.value){const a=Math.floor(n/r.value);o.push(`${v(a)} ${r.name}`),n=n%r.value}return n&&o.push(v(n)),`${o.join(" ")} টাকা মাত্র`}const S=u(()=>_.loading),x=u(()=>_.invoice||null),k=u(()=>_.error||""),b=u(()=>{var e;return(e=x.value)!=null&&e.zamats?Object.entries(x.value.zamats).map(([l,o])=>{const n=Number((o==null?void 0:o.student_count)||0),r=Number((o==null?void 0:o.paid_amount)||0),a=n>0?Math.round(r/n):0;return{zamat_name:l,student_count:n,fee_rate:a,total_fee:r}}):[]}),C=u(()=>b.value.reduce((s,e)=>s+(e.student_count||0),0)),I=u(()=>b.value.reduce((s,e)=>s+(e.total_fee||0),0)),h=u(()=>{var s;if((s=i.lastExam)!=null&&s.id)return String(i.lastExam.id);if(Array.isArray(i.exams)&&i.exams.length){const e=i.exams.reduce((l,o)=>o.id>l?o.id:l,i.exams[0].id);return String(e)}return""});L(h,s=>{!f.value&&!c.value&&s&&(c.value=s,f.value=!0)});async function $(){if(!g.value.trim()){alert("অনুগ্রহ করে institute_code দিন");return}const s={institute_code:g.value.trim()};String(c.value||"").trim()&&(s.exam_id=String(c.value).trim()),await _.fetchInvoice(s)}function F(){window.print()}return O(async()=>{await Promise.all([i.fetchExams(),typeof i.fetchLastExam=="function"?i.fetchLastExam():Promise.resolve()]),!f.value&&!c.value&&h.value&&(c.value=h.value,f.value=!0)}),(s,e)=>{var l,o,n,r;return m(),p("div",K,[t("div",Q,[t("div",R,[t("div",null,[E(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"ইলহাক নং (institute_code)"},null,512),[[T,g.value]])]),t("div",null,[E(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>c.value=a),class:"w-full border rounded px-3 py-2"},[e[2]||(e[2]=t("option",{value:""},"-- পরীক্ষা সিলেক্ট করুন (ঐচ্ছিক) --",-1)),(m(!0),p(M,null,N(q(i).exams,a=>(m(),p("option",{key:a.id,value:String(a.id)},d(a.name),9,X))),128))],512),[[U,c.value]]),e[3]||(e[3]=t("p",{class:"text-xs text-gray-500 mt-1"},"ডিফল্টে সর্বশেষ পরীক্ষা সিলেক্ট থাকবে (লোড হলে)।",-1))]),t("div",null,[t("div",Z,[t("button",{onClick:$,class:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:S.value},d(S.value?"লোড হচ্ছে…":"সার্চ করুন"),9,z),t("button",{onClick:F,class:"px-4 py-2 rounded border hover:bg-gray-100"}," প্রিন্ট ")])])]),k.value?(m(),p("p",tt,d(k.value),1)):D("",!0)]),t("div",et,[t("div",st,[t("div",ot,[e[4]||(e[4]=t("div",{class:"text-xl md:text-2xl font-bold leading-snug"},"পরীক্ষা বিভাগ",-1)),e[5]||(e[5]=t("img",{src:G,alt:"logo",class:"h-20"},null,-1)),t("p",nt,d(((l=x.value)==null?void 0:l.exam_name)||"—"),1),e[6]||(e[6]=t("div",{class:"text-lg font-semibold"},"নিবন্ধন ফি আদায়ের রশিদ",-1))]),t("div",at,[e[8]||(e[8]=t("div",{class:"col-span-2"},null,-1)),t("div",lt,[t("div",dt,[e[7]||(e[7]=t("span",{class:"font-medium"},"তারিখঃ",-1)),t("span",it,d(v(A.value)),1)])])]),t("div",rt,[t("div",ct,[e[9]||(e[9]=t("div",{class:"col-span-2 md:col-span-2 font-medium"},"মাদরাসার নামঃ",-1)),t("div",ut,d(((o=x.value)==null?void 0:o.institute_code)||"—")+" - "+d(((n=x.value)==null?void 0:n.institute_name)||"—"),1)]),t("div",pt,[e[10]||(e[10]=t("div",{class:"col-span-2 md:col-span-2 font-medium"},"ফোনঃ",-1)),t("div",mt,d(((r=x.value)==null?void 0:r.phone)||"—"),1)])])]),t("div",vt,[t("div",xt,[t("table",_t,[e[12]||(e[12]=t("thead",null,[t("tr",{class:"bg-sky-600 text-white"},[t("th",{class:"text-left px-3 py-2 border"},"মারহালা"),t("th",{class:"text-center px-3 py-2 border"},"পরীক্ষার্থী সংখ্যা"),t("th",{class:"text-center px-3 py-2 border"},"ফি হার"),t("th",{class:"text-right px-3 py-2 border"},"মোট ফি")])],-1)),t("tbody",null,[b.value.length===0?(m(),p("tr",gt,e[11]||(e[11]=[t("td",{colspan:"4",class:"text-center py-6 text-gray-500"},"ডাটা পাওয়া যায়নি",-1)]))):D("",!0),(m(!0),p(M,null,N(b.value,(a,j)=>(m(),p("tr",{key:j,class:Y(j%2?"bg-yellow-50/40":"bg-purple-50/30")},[t("td",ft,d(a.zamat_name),1),t("td",bt,d(v(a.student_count)),1),t("td",yt,d(y(a.fee_rate)),1),t("td",ht,d(y(a.total_fee)),1)],2))),128))])])]),t("div",wt,[t("div",St,[t("div",kt,[e[13]||(e[13]=t("div",{class:"col-span-6 bg-green-100 border px-3 py-2 font-medium"}," পরীক্ষার্থী সংখ্যা ",-1)),t("div",It,d(v(C.value)),1)])]),t("div",jt,[t("div",Et,[e[14]||(e[14]=t("div",{class:"col-span-6 bg-green-100 border px-3 py-2 font-medium"},"সর্বমোট ফি",-1)),t("div",Mt,d(y(I.value)),1)])])]),t("div",Nt,[t("div",Dt,[e[15]||(e[15]=t("span",{class:"font-medium"},"সর্বমোট কথায়ঃ",-1)),t("span",At,d(B(I.value)),1)])]),e[16]||(e[16]=W('<div class="mt-10 grid grid-cols-2 gap-6" data-v-68414e0e><div class="flex flex-col justify-center items-center text-center" data-v-68414e0e><img class="w-28" src="'+H+'" alt="signature" data-v-68414e0e><div class="border-t pt-2 inline-block min-w-[220px]" data-v-68414e0e>পরীক্ষা নিয়ন্ত্রকের স্বাক্ষর</div></div><div class="flex flex-col justify-center items-center text-center" data-v-68414e0e><div class="border-t pt-2 inline-block min-w-[220px]" data-v-68414e0e>গ্রহণকারীর স্বাক্ষর</div></div></div>',1))])])])}}},Lt=P(Bt,[["__scopeId","data-v-68414e0e"]]);export{Lt as default};
