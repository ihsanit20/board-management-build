import{r as m,o as S,c as a,a as e,x as D,h as v,t as o,F as y,e as f,d as s,E as L,z as p,L as z}from"./index-BZQ8rmLo.js";import{u as B}from"./student-CTGozWMc.js";import{u as j}from"./exam-E7kPc-ml.js";const F={class:"my-container max-w-4xl card-bg p-4 md:p-10"},P={key:1,class:"text-red-500 text-center"},V={key:2},C={key:0,class:"grid grid-cols-2 divide-x-2"},I={class:"flex justify-center text-black font-bold text-lg"},N={key:0},O={class:"grid grid-cols-2 divide-x-2 text-xs"},T={class:"divide-y-2"},M={class:"py-0.5"},q={class:"py-0.5"},A={class:"py-0.5"},G={class:"py-0.5"},H={class:"divide-y-2 text-xs"},J={class:"pt-0.5 text-xs"},W={__name:"PrintEnvelop",setup(K){const b=B(),g=j(),i=m(!1),c=m(null),_=m({}),x=m(null),k=async()=>{i.value=!0,c.value=null;try{await b.fetchPrintEnvelopData();const l=b.printEnvelopData;_.value=Object.entries(l).reduce((t,[r,d])=>(t[r]=d.map(n=>({institute_name:n.institute_name,institute_code:n.institute_code,phone:n.phone,zamat_counts:n.zamat_counts.map(u=>({zamat_name:u.zamat_name,student_count:u.student_count}))})),t),{})}catch(l){c.value=l.message||"Failed to fetch envelop data"}finally{i.value=!1}},h=async()=>{var l,t;i.value=!0;try{await g.fetchLastExam(),x.value=g.exam}catch(r){c.value=((t=(l=r.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to fetch exam"}finally{i.value=!1}},w=l=>l.reduce((r,d)=>r+parseInt(d.student_count,10),0).toLocaleString("bn-BD"),E=()=>{window.print()};return S(()=>{h(),k()}),(l,t)=>(s(),a("div",F,[e("div",{class:"flex justify-between items-center mb-4 print:hidden"},[t[0]||(t[0]=e("h2",{class:"title-xl text-center"},"ইনভেলাপ প্রিন্ট",-1)),e("button",{onClick:E,class:"btn-2"},"প্রিন্ট")]),i.value?(s(),D(z,{key:0,class:"shadow-none"})):v("",!0),c.value?(s(),a("div",P,o(c.value),1)):v("",!0),Object.keys(_.value).length?(s(),a("div",V,[(s(!0),a(y,null,f(_.value,(r,d)=>(s(),a("div",{key:d,class:""},[(s(!0),a(y,null,f(r,n=>(s(),a("div",{key:n.institute_code,class:"py-3",style:{"page-break-inside":"avoid"}},[(s(),a("div",C,[t[1]||(t[1]=e("div",{class:"flex justify-center"},[e("img",{src:L,alt:"logo",class:"h-[50px] mb-2"})],-1)),e("div",I,[x.value?(s(),a("p",N,o(x.value.name)+"র নিবন্ধন তথ্য",1)):v("",!0)])])),t[8]||(t[8]=e("hr",{class:"w-full"},null,-1)),e("div",O,[e("div",T,[e("p",M,[t[2]||(t[2]=e("b",null,"মাদরাসার নাম:",-1)),t[3]||(t[3]=e("br",null,null,-1)),p(" "+o(n.institute_name),1)]),e("p",q,[t[4]||(t[4]=e("b",null,"ইলহাক নং:",-1)),p(" "+o(n.institute_code),1)]),e("p",A,[t[5]||(t[5]=e("b",null,"ফোন:",-1)),p(" "+o(n.phone),1)]),e("p",G,[t[6]||(t[6]=e("b",null,"অঞ্চল:",-1)),p(" "+o(d),1)])]),e("div",H,[(s(!0),a(y,null,f(n.zamat_counts,u=>(s(),a("p",{class:"py-0.5 pl-2 text-xs",key:u.zamat_name},[e("b",null,o(u.zamat_name)+": ",1),e("span",null,o(parseInt(u.student_count).toLocaleString("bn-BD"))+" জন",1)]))),128)),e("p",J,[t[7]||(t[7]=e("b",{class:"pl-2"},"মোট পরীক্ষার্থীর সংখ্যা:",-1)),p(" "+o(w(n.zamat_counts))+" জন ",1)])])]),t[9]||(t[9]=e("div",{class:"w-full border-b-2 border-dashed p-2"},null,-1))]))),128))]))),128))])):v("",!0)]))}};export{W as default};
