import{A,r as d,o as F,c as n,a as t,m as C,C as I,F as _,e as y,b as P,v as M,D as T,x as K,h as f,t as a,d as l,G as N,z as v,L as O}from"./index-DQ0MrzyU.js";import{u as U}from"./student-DvK_h-mQ.js";import{u as G}from"./area-CtewZljp.js";const q={class:"my-container max-w-4xl card-bg p-4 md:p-10"},H={class:"flex md:flex-row flex-col gap-2 justify-between items-center mb-4 print:hidden"},J={class:"grid md:grid-cols-2 gap-4"},Q={class:"w-full"},R=["value"],W={class:"w-full"},X={key:1,class:"text-red-500 text-center"},Y={key:2},Z={class:"grid grid-cols-2 divide-x-2"},$={class:"flex justify-center text-black font-bold text-md px-2 items-center"},ee={key:0},te={class:"grid grid-cols-2 divide-x-2 text-xs"},se={class:"divide-y-2"},le={class:"py-0.5"},ne={class:"py-0.5"},ae={class:"py-0.5"},oe={class:"py-0.5"},re={class:"divide-y-2 text-xs"},ue={class:"py-0.5 text-xs"},ve={__name:"PrintEnvelop",setup(de){const w=U(),k=A(),S=G(),i=d(!1),c=d(null),b=d({}),g=d(null),h=d(""),m=d(""),D=async(r=null,e=null)=>{i.value=!0,c.value=null;try{await w.fetchPrintEnvelopData(r,e);const s=w.printEnvelopData;b.value=Object.entries(s).reduce((u,[o,p])=>(u[o]=p.map(x=>({institute_name:x.institute_name,institute_code:x.institute_code,phone:x.phone,zamat_counts:x.zamat_counts.map(E=>({zamat_name:E.zamat_name,student_count:E.student_count}))})),u),{})}catch(s){c.value=s.message||"Failed to fetch envelop data"}finally{i.value=!1}},L=async()=>{var r,e;i.value=!0;try{await k.fetchLastExam(),g.value=k.exam}catch(s){c.value=((e=(r=s.response)==null?void 0:r.data)==null?void 0:e.message)||"Failed to fetch exam"}finally{i.value=!1}},z=r=>r.reduce((s,u)=>s+parseInt(u.student_count,10),0).toLocaleString("bn-BD"),B=()=>{window.print()},V=()=>{D(h.value,m.value)},j=()=>{D(null,m.value)};return F(()=>{S.fetchAreas(),L()}),(r,e)=>(l(),n("div",q,[t("div",H,[e[3]||(e[3]=t("h2",{class:"title-xl text-center"},"ইনভেলাপ প্রিন্ট",-1)),t("div",J,[t("div",Q,[C(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>h.value=s),onChange:V,class:"input-1 py-1 w-full"},[e[2]||(e[2]=t("option",{value:"",disabled:""},"- অঞ্চল নির্বাচন করুন -",-1)),(l(!0),n(_,null,y(P(S).areas,s=>(l(),n("option",{key:s.id,value:s.name},a(s.name),9,R))),128))],544),[[I,h.value]])]),t("div",W,[C(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),type:"text",class:"input-1 w-full text-black px-3 py-1 text-center",placeholder:"ইলহাক নং",onKeyup:T(j,["enter"])},null,544),[[M,m.value]])])]),t("button",{onClick:B,class:"btn-2"},"প্রিন্ট")]),i.value?(l(),K(O,{key:0,class:"shadow-none"})):f("",!0),c.value?(l(),n("div",X,a(c.value),1)):f("",!0),Object.keys(b.value).length?(l(),n("div",Y,[(l(!0),n(_,null,y(b.value,(s,u)=>(l(),n("div",{key:u},[(l(!0),n(_,null,y(s,o=>(l(),n("div",{key:o.institute_code,class:"py-3",style:{"page-break-inside":"avoid"}},[t("div",Z,[e[4]||(e[4]=t("div",{class:"flex justify-center"},[t("img",{src:N,alt:"logo",class:"h-[50px] mb-2"})],-1)),t("div",$,[g.value?(l(),n("p",ee,a(g.value.name)+"র নিবন্ধন তথ্য",1)):f("",!0)])]),e[11]||(e[11]=t("hr",{class:"w-full"},null,-1)),t("div",te,[t("div",se,[t("p",le,[e[5]||(e[5]=t("b",null,"মাদরাসার নাম:",-1)),e[6]||(e[6]=t("br",null,null,-1)),v(" "+a(o.institute_name),1)]),t("p",ne,[e[7]||(e[7]=t("b",null,"ইলহাক নং:",-1)),v(" "+a(o.institute_code),1)]),t("p",ae,[e[8]||(e[8]=t("b",null,"ফোন:",-1)),v(" "+a(o.phone),1)]),t("p",oe,[e[9]||(e[9]=t("b",null,"অঞ্চল:",-1)),v(" "+a(u),1)])]),t("div",re,[(l(!0),n(_,null,y(o.zamat_counts,p=>(l(),n("p",{class:"py-0.5 pl-2 text-xs",key:p.zamat_name},[t("b",null,a(p.zamat_name)+": ",1),t("span",null,a(parseInt(p.student_count).toLocaleString("bn-BD"))+" জন",1)]))),128)),t("p",ue,[e[10]||(e[10]=t("b",{class:"pl-2"},"মোট পরীক্ষার্থীর সংখ্যা:",-1)),v(" "+a(z(o.zamat_counts))+" জন ",1)])])]),e[12]||(e[12]=t("div",{class:"w-full border-b-2 border-dashed p-2"},null,-1))]))),128))]))),128))])):f("",!0)]))}};export{ve as default};
