import{r as p,o as z,c as a,a as t,m as j,B as V,F as v,e as _,b as A,x as C,h as x,t as l,d as n,E as F,z as m,L as P}from"./index-D-EzV734.js";import{u as I}from"./student-BPUmK0t9.js";import{u as M}from"./exam-DlPiQjB_.js";import{u as N}from"./area-D6jPSkbs.js";const O={class:"my-container max-w-4xl card-bg p-4 md:p-10"},T={class:"flex md:flex-row flex-col gap-2 justify-between items-center mb-4 print:hidden"},U=["value"],q={key:1,class:"text-red-500 text-center"},G={key:2},H={class:"grid grid-cols-2 divide-x-2"},J={class:"flex justify-center text-black font-bold text-md px-2 items-center"},K={key:0},Q={class:"grid grid-cols-2 divide-x-2 text-xs"},R={class:"divide-y-2"},W={class:"py-0.5"},X={class:"py-0.5"},Y={class:"py-0.5"},Z={class:"py-0.5"},$={class:"divide-y-2 text-xs"},ee={class:"py-0.5 text-xs"},oe={__name:"PrintEnvelop",setup(te){const g=I(),h=M(),k=N(),i=p(!1),c=p(null),f=p({}),y=p(null),b=p(""),S=async(d=null)=>{i.value=!0,c.value=null;try{await g.fetchPrintEnvelopData(d);const e=g.printEnvelopData;f.value=Object.entries(e).reduce((s,[u,o])=>(s[u]=o.map(r=>({institute_name:r.institute_name,institute_code:r.institute_code,phone:r.phone,zamat_counts:r.zamat_counts.map(w=>({zamat_name:w.zamat_name,student_count:w.student_count}))})),s),{})}catch(e){c.value=e.message||"Failed to fetch envelop data"}finally{i.value=!1}},E=async()=>{var d,e;i.value=!0;try{await h.fetchLastExam(),y.value=h.exam}catch(s){c.value=((e=(d=s.response)==null?void 0:d.data)==null?void 0:e.message)||"Failed to fetch exam"}finally{i.value=!1}},D=d=>d.reduce((s,u)=>s+parseInt(u.student_count,10),0).toLocaleString("bn-BD"),B=()=>{window.print()},L=()=>{S(b.value)};return z(()=>{k.fetchAreas(),E()}),(d,e)=>(n(),a("div",O,[t("div",T,[e[2]||(e[2]=t("h2",{class:"title-xl text-center"},"ইনভেলাপ প্রিন্ট",-1)),t("div",null,[j(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s),onChange:L,class:"border p-2 rounded"},[e[1]||(e[1]=t("option",{value:"",disabled:""},"- অঞ্চল নির্বাচন করুন -",-1)),(n(!0),a(v,null,_(A(k).areas,s=>(n(),a("option",{key:s.id,value:s.name},l(s.name),9,U))),128))],544),[[V,b.value]])]),t("button",{onClick:B,class:"btn-2"},"প্রিন্ট")]),i.value?(n(),C(P,{key:0,class:"shadow-none"})):x("",!0),c.value?(n(),a("div",q,l(c.value),1)):x("",!0),Object.keys(f.value).length?(n(),a("div",G,[(n(!0),a(v,null,_(f.value,(s,u)=>(n(),a("div",{key:u,class:""},[(n(!0),a(v,null,_(s,o=>(n(),a("div",{key:o.institute_code,class:"py-3",style:{"page-break-inside":"avoid"}},[t("div",H,[e[3]||(e[3]=t("div",{class:"flex justify-center"},[t("img",{src:F,alt:"logo",class:"h-[50px] mb-2"})],-1)),t("div",J,[y.value?(n(),a("p",K,l(y.value.name)+"র নিবন্ধন তথ্য",1)):x("",!0)])]),e[10]||(e[10]=t("hr",{class:"w-full"},null,-1)),t("div",Q,[t("div",R,[t("p",W,[e[4]||(e[4]=t("b",null,"মাদরাসার নাম:",-1)),e[5]||(e[5]=t("br",null,null,-1)),m(" "+l(o.institute_name),1)]),t("p",X,[e[6]||(e[6]=t("b",null,"ইলহাক নং:",-1)),m(" "+l(o.institute_code),1)]),t("p",Y,[e[7]||(e[7]=t("b",null,"ফোন:",-1)),m(" "+l(o.phone),1)]),t("p",Z,[e[8]||(e[8]=t("b",null,"অঞ্চল:",-1)),m(" "+l(u),1)])]),t("div",$,[(n(!0),a(v,null,_(o.zamat_counts,r=>(n(),a("p",{class:"py-0.5 pl-2 text-xs",key:r.zamat_name},[t("b",null,l(r.zamat_name)+": ",1),t("span",null,l(parseInt(r.student_count).toLocaleString("bn-BD"))+" জন",1)]))),128)),t("p",ee,[e[9]||(e[9]=t("b",{class:"pl-2"},"মোট পরীক্ষার্থীর সংখ্যা:",-1)),m(" "+l(D(o.zamat_counts))+" জন ",1)])])]),e[11]||(e[11]=t("div",{class:"w-full border-b-2 border-dashed p-2"},null,-1))]))),128))]))),128))])):x("",!0)]))}};export{oe as default};
