import{r as f,o as $,i as q,c as l,a as t,j as _,C as I,F as d,e as i,b as o,y as h,h as g,k as A,G as H,t as u,d as a,M as J,L as K}from"./index-eOcHBJM5.js";import{u as O}from"./print-CBbCBVF9.js";import{u as Q}from"./zamat-4VcpeWxF.js";import{u as R}from"./center-BQyxXRyq.js";const W={class:"my-container space-y-4"},X={class:"card-bg p-4 print:hidden"},Y={class:"grid md:grid-cols-3 gap-4"},ee=["label"],te=["value"],re=["value"],ae={class:"card-bg p-4 print:hidden"},le={key:0,class:"flex gap-4 mt-2"},se=["onUpdate:modelValue"],oe={key:1,class:"space-y-2 print:space-y-0"},ne={key:0,class:"card-bg p-8"},ue={class:"flex flex-col items-center gap-2"},de={class:"border border-black px-4 rounded-full font-bold"},ie={class:"flex gap-4 justify-between w-full"},be={key:0},pe={class:"table-auto border-collapse border border-black w-full text-sm"},ce={class:"border border-black px-2 py-1 text-center"},me={class:"border border-black px-2 py-1"},ve={class:"border border-black px-2 py-1 text-center"},ke={key:1,class:"card-bg py-6"},Se={__name:"PrintSignatureSheet",setup(ye){const s=O(),D=Q(),S=R(),m=f(""),v=f(""),b=f(!1),k=f(""),x=f({subjects:{}});$(async()=>{try{b.value=!0,await D.fetchZamats()}catch(n){k.value="ডাটা লোড করতে সমস্যা হয়েছে।",console.error("Error fetching zamats:",n)}finally{b.value=!1}});const P=async n=>{if(!n){m.value="",S.centers=[];return}try{b.value=!0,await S.fetchCenters({zamat_id:n})}catch(e){k.value="সেন্টার লোড করতে সমস্যা হয়েছে।",console.error("Error fetching centers:",e)}finally{b.value=!1}},G=async()=>{var n,e;if(!v.value||!m.value){k.value="জামাত এবং সেন্টার নির্বাচন করুন।";return}k.value="";try{b.value=!0,s.centerId=m.value,s.zamatId=v.value,await s.fetchMarkSheet(),(e=(n=s.markSheetData)==null?void 0:n.subjects)!=null&&e.length&&s.markSheetData.subjects.forEach(p=>{x.value.subjects[p.name]=!0})}catch(p){k.value="মার্কশিট লোড করতে সমস্যা হয়েছে।",console.error("Error in handleFetchMarkSheet:",p)}finally{b.value=!1}},y=q(()=>{var n,e;return((e=(n=s.markSheetData)==null?void 0:n.subjects)==null?void 0:e.filter(p=>x.value.subjects[p.name]))||[]}),T=()=>{window.print()};return(n,e)=>{var p,w,j,C,V,M,E,z,B,L,F,N,U;return a(),l("div",W,[t("div",X,[e[7]||(e[7]=t("h1",{class:"title-lg text-center"},"মার্কশিট প্রিন্ট",-1)),t("div",Y,[t("div",null,[_(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>v.value=r),onChange:e[1]||(e[1]=r=>P(v.value)),class:"input-1"},[e[3]||(e[3]=t("option",{value:"",disabled:""},"- জামাত নির্বাচন করুন -",-1)),(a(!0),l(d,null,i(o(D).departments,r=>(a(),l("optgroup",{label:r.name,key:r.id},[(a(!0),l(d,null,i(r.zamats,c=>(a(),l("option",{key:c.id,value:c.id},u(c.name),9,te))),128))],8,ee))),128))],544),[[I,v.value]])]),t("div",null,[_(t("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>m.value=r),class:"input-1"},[e[4]||(e[4]=t("option",{value:"",selected:"",disabled:""},"- মারকাজ নির্বাচন করুন -",-1)),(a(!0),l(d,null,i(o(S).centers,r=>(a(),l("option",{key:r==null?void 0:r.id,value:r==null?void 0:r.id},u(r==null?void 0:r.institute.name),9,re))),128))],512),[[I,m.value]])]),t("div",{class:"w-full flex gap-4"},[t("button",{onClick:G,class:"btn-2 w-full"},e[5]||(e[5]=[t("i",{class:"fas fa-search"},null,-1),h(" অনুসন্ধান ")])),t("button",{onClick:T,class:"btn-3"},e[6]||(e[6]=[t("i",{class:"fas fa-print pr-1"},null,-1),h(" প্রিন্ট ")]))])])]),t("div",ae,[e[8]||(e[8]=t("h2",{class:"title-md mb-2"},"কলাম কন্ট্রোল",-1)),(w=(p=o(s).markSheetData)==null?void 0:p.subjects)!=null&&w.length?(a(),l("div",le,[(a(!0),l(d,null,i(o(s).markSheetData.subjects,r=>(a(),l("label",{key:r.name},[_(t("input",{type:"checkbox","onUpdate:modelValue":c=>x.value.subjects[r.name]=c},null,8,se),[[J,x.value.subjects[r.name]]]),h(" "+u(r.name),1)]))),128))])):g("",!0)]),b.value||o(s).loading?(a(),A(K,{key:0})):(a(),l("div",oe,[(C=(j=o(s).markSheetData)==null?void 0:j.students)!=null&&C.length?(a(),l("div",ne,[e[17]||(e[17]=t("div",{class:"flex justify-center"},[t("img",{src:H,alt:"logo",class:"h-[70px]"})],-1)),t("div",ue,[t("p",de,u((V=o(s).markSheetData)==null?void 0:V.exam_name)+" এর স্বাক্ষরপত্র ",1),t("div",ie,[t("p",null,[e[9]||(e[9]=t("b",null,"মারহালা:",-1)),h(" "+u((E=(M=o(s).markSheetData)==null?void 0:M.zamat)==null?void 0:E.name)+" ",1),(z=o(s).markSheetData)!=null&&z.group_name?(a(),l("span",be,"(গ্রুপ: "+u((B=o(s).markSheetData)==null?void 0:B.group_name)+")",1)):g("",!0)]),t("p",null,[e[10]||(e[10]=t("b",null,"মারকাজ:",-1)),h(" "+u((F=(L=o(s).markSheetData)==null?void 0:L.center)==null?void 0:F.institute_name),1)])])]),t("table",pe,[t("thead",null,[t("tr",null,[e[11]||(e[11]=t("th",{class:"border border-black px-2 py-1"},"ক্রম",-1)),e[12]||(e[12]=t("th",{class:"border border-black px-2 py-1"},"শিক্ষার্থীর নাম",-1)),e[13]||(e[13]=t("th",{class:"border border-black px-2 py-1"},"রোল",-1)),(a(!0),l(d,null,i(y.value,r=>(a(),l("th",{key:r.name,class:"border border-black px-2 py-1 w-28"},u(r.name),1))),128))])]),t("tbody",null,[(a(!0),l(d,null,i(o(s).markSheetData.students,(r,c)=>(a(),l("tr",{key:r.id},[t("td",ce,u(Number(c+1).toLocaleString("bn-BD")),1),t("td",me,u(r.name),1),t("td",ve,u(r.roll_number),1),(a(!0),l(d,null,i(y.value,Z=>(a(),l("td",{key:Z.name,class:"border border-black px-2 py-1"}))),128))]))),128)),t("tr",null,[e[14]||(e[14]=t("td",{colspan:"3",class:"border border-black px-2 py-1 text-right font-bold"}," মোট উপস্থিতি ",-1)),(a(!0),l(d,null,i(y.value,r=>(a(),l("td",{key:r.name,class:"border border-black px-2 py-1 text-right"}," জন "))),128))]),t("tr",null,[e[15]||(e[15]=t("td",{colspan:"3",class:"border border-black px-2 py-1 text-right font-bold"}," মোট অনুপস্থিতি ",-1)),(a(!0),l(d,null,i(y.value,r=>(a(),l("td",{key:r.name,class:"border border-black px-2 py-1 text-right"}," জন "))),128))]),t("tr",null,[e[16]||(e[16]=t("td",{colspan:"3",class:"border border-black px-2 py-1 text-right font-bold"}," হল পরিচালকের স্বাক্ষর ও তারিখ ",-1)),(a(!0),l(d,null,i(y.value,r=>(a(),l("td",{key:r.name,class:"border border-black px-2 py-1 text-right"}))),128))])])])])):g("",!0),!((U=(N=o(s).markSheetData)==null?void 0:N.students)!=null&&U.length)&&!b.value?(a(),l("div",ke,e[18]||(e[18]=[t("p",{class:"text-center text-red-500"}," কোন পরীক্ষার্থী পাওয়া যায়নি। দয়া করে সঠিক তথ্য দিয়ে অনুসন্ধান করুন। ",-1)]))):g("",!0)]))])}}};export{Se as default};
