import{A as H,r as k,B as C,o as J,i as Q,c as i,a as t,t as r,b as _,z as m,m as u,v as f,n as W,l as ee,C as w,F as b,e as y,h as x,j as te,f as se,w as ae,y as le,d as o,D as ie,q as oe}from"./index-CyA6YVnO.js";import{u as ne}from"./application-CtVV4Osr.js";import{u as de}from"./institute-B9OM-bCO.js";import{u as re}from"./area-CVhpV-tY.js";import{u as ue}from"./zamat-DHWWPpLk.js";import{u as pe}from"./group-DS2ROHjm.js";import{u as ce}from"./center-Cy5e2TfH.js";import{u as me}from"./fee-Ci1FUoIW.js";import{t as _e}from"./date-Cs-xe4uq.js";const ve={class:"my-container py-6"},fe={class:"md:p-8 p-4 card-bg space-y-2"},be={class:"flex gap-4 justify-center items-center"},ye={class:"flex flex-col items-center space-y-2"},ge={class:"title-xl"},xe={class:"flex flex-wrap gap-2 text-center"},he={class:"md:text-base text-sm"},ke={class:"flex justify-center items-center"},Ve={class:"flex gap-2 justify-center items-center bg-gray-100 p-4 rounded-lg"},Se={class:"text-red-500"},Ue={class:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-md"},Ce={class:"col-start-1"},we=["value"],De=["disabled"],ze=["value"],$e=["label"],Me=["value"],je=["disabled"],Be=["value"],qe={key:0},Ae=["disabled"],Ie=["value"],Fe={class:"space-y-2"},Le={class:"grid md:grid-cols-12 gap-4 border rounded p-2"},Ee={class:"flex items-center justify-center"},Ne={class:"text-lg font-semibold mb-2 px-3 py-1 bg-gray-100 rounded-full"},Oe={class:"md:col-span-2 grid gap-2"},Ye=["onUpdate:modelValue"],Ge=["onUpdate:modelValue"],Ke={class:"md:col-span-2 grid gap-2"},Re=["onUpdate:modelValue"],Pe=["onUpdate:modelValue"],Te={class:"md:col-span-2"},Xe={class:"flex relative"},Ze={key:0,class:"absolute left-2 top-3"},He=["onUpdate:modelValue","onBlur","onKeyup"],Je=["onChange","onUpdate:modelValue"],Qe={class:"md:col-span-2"},We=["onUpdate:modelValue"],et={class:"md:col-span-2"},tt=["onUpdate:modelValue"],st={class:"flex justify-end md:justify-center items-start"},at=["onClick"],lt={key:0,class:"flex flex-col items-center space-y-2"},it={class:"flex flex-col items-center"},ot={class:"text-xl text-green-600"},nt=["disabled"],dt={class:"flex justify-center"},rt={key:0,class:"text-xl text-green-600"},ut={key:1,class:"text-xl text-red-600"},pt={class:"flex mt-4"},kt={__name:"PublicApplication",setup(ct){const E=oe(),n=H(),N=me(),O=ne(),h=de(),j=ce(),q=re(),A=ue(),B=pe(),D=k(!1),V=k(""),z=k(""),$=k(""),S=k(""),l=k({exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:""}],payment_method:"Offline",total_amount:0}),Y=async()=>{var a;h.institutes=[],B.groups=[],j.centers=[],N.fee={},await n.fetchLastExam(),l.value.exam_id=(a=n==null?void 0:n.exam)==null?void 0:a.id,await q.fetchAreas(),await A.fetchZamats()};C(()=>l.value.area_id,async a=>{a&&await h.fetchInstitutes({area_id:a,per_page:"all"})}),C(()=>l.value.zamat_id,async a=>{a&&(l.value.group_id="",await B.fetchGroups(a))}),C(()=>l.value.zamat_id,async a=>{a&&I()}),C(()=>l.value.group_id,async a=>{a&&I()}),C($,()=>{S.value=""});const I=async()=>{j.fetchCenters({zamat_id:l.value.zamat_id,group_id:l.value.group_id,gender:l.value.gender})};J(Y);const G=()=>{l.value.students.push({registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""})},K=a=>{confirm("ডিলিট নিশ্চিত করুন")&&l.value.students.splice(a,1)},R=()=>{l.value={exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:""}],payment_method:"Offline",total_amount:0}},P=async()=>{var a,e;D.value=!0,V.value="",z.value="";try{l.value.total_amount=M.value*(((e=(a=l==null?void 0:l.value)==null?void 0:a.students)==null?void 0:e.length)||0);const c=await O.createApplication(l.value);localStorage.setItem("applicationId",c.id),localStorage.setItem("instituteCode",c.institute.institute_code),z.value="আপনার নিবন্ধন সফলভাবে জমা হয়েছে।",R(),E.push({name:"SuccessMessage"})}catch{V.value="নিবন্ধন জমা দিতে ব্যর্থ হয়েছে।"}finally{D.value=!1}},T=a=>{V.value=a},M=Q(()=>{var c,v,g,U;let a=parseInt(((c=n==null?void 0:n.exam)==null?void 0:c.registration_fee)||0);const e=_e();return e>((v=n==null?void 0:n.exam)==null?void 0:v.reg_final_date)?(T("নিবন্ধন গ্রহণ বন্ধ রয়েছে"),a=0):(e>((g=n==null?void 0:n.exam)==null?void 0:g.reg_last_date)&&(a+=parseInt(((U=n==null?void 0:n.exam)==null?void 0:U.late_fee)||0)),a)}),X=async()=>{l.value.area_id="",l.value.institute_id="",h.institutes=[],S.value="";const a=await h.findInstituteByCode($.value);a?(h.institutes[0]=a,l.value.area_id=a.area_id,l.value.institute_id=a.id):S.value="খুঁজে পাওয়া যায় নি!"},F=a=>{if(/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/.test(a.input_dob)){const[c,v,g]=a.input_dob.split("/");a.date_of_birth=`${g}-${v}-${c}`}else a.date_of_birth="",a.input_dob=""},Z=a=>{if(a.date_of_birth&&/^\d{4}-\d{2}-\d{2}$/.test(a.date_of_birth)){const[e,c,v]=a.date_of_birth.split("-");a.input_dob=`${v}/${c}/${e}`}else a.input_dob=""};return(a,e)=>{var v,g,U,L;const c=le("RouterLink");return o(),i("div",ve,[t("div",fe,[t("div",be,[t("div",ye,[t("h2",ge,r((g=(v=_(n))==null?void 0:v.exam)==null?void 0:g.name),1),t("div",xe,[t("p",he,[e[9]||(e[9]=m(" নিবন্ধনের শেষ তারিখ ")),t("b",null,r(new Date((U=_(n).exam)==null?void 0:U.reg_last_date).toLocaleDateString("bn-BD")),1),e[10]||(e[10]=m(" । বিলম্ব ফি সহ নিবন্ধনের চূড়ান্ত তারিখ ")),t("b",null,r(new Date((L=_(n).exam)==null?void 0:L.reg_final_date).toLocaleDateString("bn-BD")),1),e[11]||(e[11]=m(" । "))])]),e[12]||(e[12]=t("div",{class:"px-6 bg-sky-700 rounded-full pt-1"},[t("h2",{class:"title-lg text-white"},"নিবন্ধন পত্র")],-1))])]),t("div",ke,[t("div",Ve,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>$.value=s),type:"search",class:W(["input-1 text-center",{"border-red-500":!!S.value}]),placeholder:"ইলহাক নাম্বার"},null,2),[[f,$.value]]),t("div",Se,r(S.value),1),t("button",{onClick:X,type:"button",class:"btn-2"},e[13]||(e[13]=[t("i",{class:"fas fa-search"},null,-1),m(" খুঁজুন ")]))])]),t("form",{onSubmit:ee(P,["prevent"]),class:"space-y-4"},[t("div",Ue,[t("div",Ce,[e[15]||(e[15]=t("label",{class:"block text-gray-700"},"অঞ্চল নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.area_id=s),class:"input-1",required:""},[e[14]||(e[14]=t("option",{value:"",disabled:""},"Select Area",-1)),(o(!0),i(b,null,y(_(q).areas,s=>(o(),i("option",{key:s.id,value:s.id},r(s.name),9,we))),128))],512),[[w,l.value.area_id]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-gray-700"},"মাদরাসা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.institute_id=s),class:"input-1",disabled:!l.value.area_id,required:""},[e[16]||(e[16]=t("option",{value:"",disabled:""},"Select Institute",-1)),(o(!0),i(b,null,y(_(h).institutes,s=>(o(),i("option",{key:s.id,value:s.id},r(s.institute_code)+" - "+r(s.name),9,ze))),128))],8,De),[[w,l.value.institute_id]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-gray-700"},"মারহালা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.zamat_id=s),class:"input-1",required:""},[e[18]||(e[18]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(o(!0),i(b,null,y(_(A).departments,s=>(o(),i("optgroup",{label:s.name,key:s.id},[(o(!0),i(b,null,y(s.zamats,p=>(o(),i("option",{key:p.id,value:p.id},r(p.name),9,Me))),128))],8,$e))),128))],512),[[w,l.value.zamat_id]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-gray-700"},"গ্রুপ নির্বাচন করুন (যদি থাকে)",-1)),u(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.group_id=s),class:"input-1",disabled:!l.value.zamat_id},[e[21]||(e[21]=t("option",{value:"",disabled:""},"Select Group",-1)),(o(!0),i(b,null,y(_(B).groups,s=>(o(),i("option",{key:s.id,value:s.id},[m(r(s.name)+" (",1),(o(!0),i(b,null,y(s.areas,(p,d)=>(o(),i(b,{key:p.id},[d?(o(),i("span",qe,", ")):x("",!0),t("span",null,r(p.name),1)],64))),128)),e[20]||(e[20]=m(") "))],8,Be))),128))],8,je),[[w,l.value.group_id]])]),x("",!0),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-gray-700"},"কেন্দ্র নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.center_id=s),class:"input-1",disabled:!l.value.zamat_id,required:""},[e[25]||(e[25]=t("option",{value:"",disabled:""},"Select Center",-1)),(o(!0),i(b,null,y(_(j).centers,s=>{var p;return o(),i("option",{key:s.id,value:s==null?void 0:s.institute_id},r((p=s==null?void 0:s.institute)==null?void 0:p.name),9,Ie)}),128))],8,Ae),[[w,l.value.center_id]])])]),t("div",Fe,[e[35]||(e[35]=te('<div class="flex justify-center"><h4 class="title-lg">পরীক্ষার্থীদের তথ্য</h4></div><div class="hidden md:grid md:grid-cols-12 bg-gray-100 py-2 px-2 text-center divide-x-2 font-medium"><div class="text-center">ক্র</div><div class="col-span-2 text-center">পরীক্ষার্থীর নাম</div><div class="col-span-2">পিতার নাম</div><div class="col-span-2"> জন্ম তারিখ <br><span class="text-xs">(জন্ম নিবন্ধন অনুসারে)</span></div><div class="col-span-2"> পারার বিবরণ <br><span class="text-xs">(হিফজের ক্ষেত্রে)</span></div><div class="col-span-2"> ঠিকানা <br><span class="text-xs">(গ্রাম, ডাকঘর, থানা, জেলা)</span></div><div>ডিলিট</div></div>',2)),(o(!0),i(b,null,y(l.value.students,(s,p)=>(o(),i("div",{key:p},[t("div",Le,[t("div",Ee,[t("div",Ne,r(p+1),1)]),t("div",Oe,[e[27]||(e[27]=t("div",{class:"md:hidden flex font-medium"},"পরীক্ষার্থীর নাম:",-1)),u(t("input",{"onUpdate:modelValue":d=>s.name=d,type:"text",class:"input-1",required:"",placeholder:"বাংলায়"},null,8,Ye),[[f,s.name]]),u(t("input",{"onUpdate:modelValue":d=>s.name_arabic=d,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Ge),[[f,s.name_arabic]])]),t("div",Ke,[e[28]||(e[28]=t("div",{class:"md:hidden flex font-medium"},"পিতার নাম:",-1)),u(t("input",{"onUpdate:modelValue":d=>s.father_name=d,required:"",type:"text",class:"input-1",placeholder:"বাংলায়"},null,8,Re),[[f,s.father_name]]),u(t("input",{"onUpdate:modelValue":d=>s.father_name_arabic=d,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Pe),[[f,s.father_name_arabic]])]),t("div",Te,[e[30]||(e[30]=t("p",{class:"md:hidden flex font-medium"},"জন্ম তারিখ (জন্ম নিবন্ধন অনুসারে)",-1)),t("div",Xe,[s.date_of_birth?(o(),i("div",Ze,e[29]||(e[29]=[t("i",{class:"fa fa-check-circle text-green-500"},null,-1)]))):x("",!0),u(t("input",{"onUpdate:modelValue":d=>s.input_dob=d,required:"",type:"text",placeholder:"DD/MM/YYYY",class:"input-1 border-r-0 rounded-r-none text-center",onBlur:d=>F(s),onKeyup:ie(d=>F(s),["enter"])},null,40,He),[[f,s.input_dob]]),u(t("input",{onChange:d=>Z(s),"onUpdate:modelValue":d=>s.date_of_birth=d,required:"",type:"date",class:"input-1 w-10 px-2 rounded-l-none"},null,40,Je),[[f,s.date_of_birth]])])]),t("div",Qe,[e[31]||(e[31]=t("p",{class:"md:hidden flex font-medium"},"পারার বিববরণ (হিফজের ক্ষেত্রে)",-1)),u(t("input",{"onUpdate:modelValue":d=>s.para=d,type:"text",class:"input-1",placeholder:"পারার বিবরণ"},null,8,We),[[f,s.para]])]),t("div",et,[e[32]||(e[32]=t("p",{class:"md:hidden flex font-medium"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)",-1)),u(t("input",{"onUpdate:modelValue":d=>s.address=d,type:"text",class:"input-1",placeholder:"গ্রাম, ডাকঘর, থানা, জেলা"},null,8,tt),[[f,s.address]])]),t("div",st,[t("button",{type:"button",onClick:d=>K(p),class:"btn-4 py-2"},e[33]||(e[33]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,at)])])]))),128)),t("div",{class:"flex justify-center"},[t("button",{type:"button",onClick:G,class:"btn-contrast"},e[34]||(e[34]=[t("i",{class:"fas fa-plus"},null,-1),m(" আরেকজন যুক্ত করুন ")]))])]),e[42]||(e[42]=t("hr",{class:"my-4"},null,-1)),M.value?(o(),i("div",lt,[t("div",it,[t("div",null," প্রতি পরীক্ষার্থীর ফি: "+r(_(n).exam.registration_fee)+" টাকা। বিলম্ব ফি (প্রযোজ্য ক্ষেত্রে): "+r(_(n).exam.late_fee)+" টাকা। ",1),t("div",ot,[e[36]||(e[36]=m(" পরীক্ষার্থীর সংখ্যা:")),t("b",null,r(l.value.students.length),1),e[37]||(e[37]=m(" X ")),t("b",null,r(M.value),1),e[38]||(e[38]=m(" টাকা = ")),t("b",null,r(l.value.students.length*M.value)+" টাকা",1)])]),x("",!0),t("button",{type:"submit",disabled:D.value,class:"btn-2"},r(D.value?"সাবমিট হচ্ছে...":"সাবমিট করুন"),9,nt)])):x("",!0),t("div",dt,[z.value?(o(),i("div",rt,r(z.value),1)):x("",!0),V.value?(o(),i("div",ut,r(V.value),1)):x("",!0)])],32)]),t("div",pt,[se(c,{to:{name:"PublicFunctions"},class:"btn-3"},{default:ae(()=>e[43]||(e[43]=[m("পিছনে যান")])),_:1})])])}}};export{kt as default};
