import{f as H,r as g,s as D,o as J,x as K,l as Q,a as o,c as n,b as e,t as d,d as p,q as _,i as r,v as f,y as W,w as Y,z as U,F as m,m as h,j as C,n as ee,p as te,e as se}from"./index-Bo8EQg3O.js";import{u as ae}from"./application-HhjKo7bn.js";import{u as le}from"./exam-t_h3Bt_l.js";import{u as ie}from"./institute-yjSEhUi1.js";import{u as oe}from"./area-CE0Ua0ll.js";import{u as ne}from"./zamat-CXp_GKKz.js";import{u as de}from"./group-lsazaqqC.js";import{u as ue}from"./center-BHalUDb7.js";import{u as ce}from"./fee-DgMmZhTo.js";import{t as re}from"./date-Cwd8pd0-.js";const _e={class:"my-container py-6"},pe={class:"md:p-8 p-4 card-bg space-y-2"},me={class:"flex gap-4 justify-center items-center"},ve={class:"flex flex-col items-center space-y-2"},he={class:"title-xl"},fe={class:"flex flex-wrap gap-2 text-center"},be={class:"md:text-base text-sm"},ge=e("div",{class:"px-6 bg-sky-700 rounded-full pt-1"},[e("h2",{class:"title-lg text-white"},"নিবন্ধন পত্র")],-1),ye={class:"flex justify-center items-center"},xe={class:"flex gap-2 justify-center items-center bg-gray-100 p-4 rounded-lg"},ke={class:"text-red-500"},Ve=e("i",{class:"fas fa-search"},null,-1),Se={class:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-md"},Ue=e("label",{class:"block text-gray-700"},"অঞ্চল নির্বাচন করুন",-1),Ce=e("option",{value:"",disabled:""},"Select Area",-1),we=["value"],ze=e("label",{class:"block text-gray-700"},"মাদরাসা নির্বাচন করুন",-1),je=["disabled"],Ie=e("option",{value:"",disabled:""},"Select Institute",-1),Me=["value"],De=e("label",{class:"block text-gray-700"},"মারহালা নির্বাচন করুন",-1),Ae=e("option",{value:"",disabled:""},"Select Marhala",-1),Fe=["label"],Le=["value"],Be=e("label",{class:"block text-gray-700"},"গ্রুপ নির্বাচন করুন (যদি থাকে)",-1),Ee=["disabled"],Ne=e("option",{value:"",disabled:""},"Select Group",-1),qe=["value"],Ge={key:0},Oe=e("label",{class:"block text-gray-700"},"কেন্দ্র নির্বাচন করুন",-1),Re=["disabled"],Pe=e("option",{value:"",disabled:""},"Select Center",-1),Te=["value"],Xe={class:"space-y-2"},Ze=se('<div class="flex justify-center"><h4 class="title-lg">শিক্ষার্থীদের তথ্য</h4></div><div class="hidden md:grid md:grid-cols-12 bg-gray-100 py-2 px-2 text-center divide-x-2 font-medium"><div class="text-center">ক্র</div><div class="col-span-2 text-center">শিক্ষার্থীর নাম</div><div class="col-span-2">পিতার নাম</div><div class="col-span-2"><p>জন্ম তারিখ</p><p class="text-xs">(জন্ম নিবন্ধন অনুসারে)</p></div><div class="col-span-4">ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)</div><div>ডিলিট</div></div>',2),$e={class:"grid md:grid-cols-12 gap-4 border rounded p-2"},He={class:"flex items-center justify-center"},Je={class:"text-lg font-semibold mb-2 px-3 py-1 bg-gray-100 rounded-full"},Ke={class:"md:col-span-2 grid gap-2"},Qe=e("div",{class:"md:hidden flex font-medium"},"শিক্ষার্থীর নাম:",-1),We=["onUpdate:modelValue"],Ye=["onUpdate:modelValue"],et={class:"md:col-span-2 grid gap-2"},tt=e("div",{class:"md:hidden flex font-medium"},"পিতার নাম:",-1),st=["onUpdate:modelValue"],at=["onUpdate:modelValue"],lt={class:"md:col-span-2"},it=e("p",{class:"md:hidden flex font-medium"},"জন্ম তারিখ (জন্ম নিবন্ধন অনুসারে)",-1),ot=["onUpdate:modelValue"],nt={class:"md:col-span-4"},dt=e("p",{class:"md:hidden flex font-medium"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)",-1),ut=["onUpdate:modelValue"],ct={class:"flex justify-end md:justify-center items-start"},rt=["onClick"],_t=e("i",{class:"fas fa-trash-alt"},null,-1),pt=[_t],mt=e("i",{class:"fas fa-plus"},null,-1),vt=e("hr",{class:"my-4"},null,-1),ht={key:0,class:"flex flex-col items-center space-y-2"},ft={class:"flex flex-col items-center"},bt={class:"text-xl text-green-600"},gt=["disabled"],yt={key:1,class:"text-xl text-green-600"},xt={key:2,class:"text-xl text-red-600"},kt={class:"flex mt-4"},Ft={__name:"PublicApplication",setup(Vt){const N=H(),l=le(),q=ce(),G=ae(),b=ie(),A=ue(),F=oe(),L=ne(),w=de(),z=g(!1),y=g(""),j=g(""),I=g(""),x=g(""),s=g({exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:""}],payment_method:"Online",total_amount:0}),O=async()=>{var a;b.institutes=[],w.groups=[],A.centers=[],q.fee={},await l.fetchLastExam(),s.value.exam_id=(a=l==null?void 0:l.exam)==null?void 0:a.id,await F.fetchAreas(),await L.fetchZamats()};D(()=>s.value.area_id,async a=>{a&&await b.fetchInstitutes({area_id:a,per_page:"all"})}),D(()=>s.value.zamat_id,async a=>{var i;a&&(s.value.group_id="",await w.fetchGroups(a),(i=w.groups)!=null&&i.length||B())}),D(()=>s.value.group_id,async a=>{a&&B()}),D(I,()=>{x.value=""});const B=async()=>{A.fetchCenters({zamat_id:s.value.zamat_id,group_id:s.value.group_id,gender:s.value.gender})};J(O);const R=()=>{s.value.students.push({registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:""})},P=a=>{confirm("ডিলিট নিশ্চিত করুন")&&s.value.students.splice(a,1)},T=()=>{s.value={exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:""}],payment_method:"Online",total_amount:0}},X=async()=>{var a,i;z.value=!0,y.value="",j.value="";try{s.value.total_amount=M.value*(((i=(a=s==null?void 0:s.value)==null?void 0:a.students)==null?void 0:i.length)||0);const v=await G.createApplication(s.value);localStorage.setItem("applicationId",v.id),localStorage.setItem("instituteId",v.institute_id),j.value="আপনার নিবন্ধন সফলভাবে জমা হয়েছে।",T(),N.push({name:"SuccessMessage"})}catch{y.value="নিবন্ধন জমা দিতে ব্যর্থ হয়েছে।"}finally{z.value=!1}},Z=a=>{y.value=a},M=K(()=>{var v,k,V,S;let a=parseInt(((v=l==null?void 0:l.exam)==null?void 0:v.registration_fee)||0);const i=re();return i>((k=l==null?void 0:l.exam)==null?void 0:k.reg_final_date)?(Z("নিবন্ধন গ্রহণ বন্ধ রয়েছে"),a=0):(i>((V=l==null?void 0:l.exam)==null?void 0:V.reg_last_date)&&(a+=parseInt(((S=l==null?void 0:l.exam)==null?void 0:S.late_fee)||0)),a)}),$=async()=>{s.value.area_id="",s.value.institute_id="",b.institutes=[],x.value="";const a=await b.findInstituteByCode(I.value);a?(b.institutes[0]=a,s.value.area_id=a.area_id,s.value.institute_id=a.id):x.value="খুঁজে পাওয়া যায় নি!"};return(a,i)=>{var k,V,S,E;const v=Q("RouterLink");return o(),n("div",_e,[e("div",pe,[e("div",me,[e("div",ve,[e("h2",he,d((V=(k=p(l))==null?void 0:k.exam)==null?void 0:V.name),1),e("div",fe,[e("p",be,[_(" নিবন্ধনের শেষ তারিখ "),e("b",null,d(new Date((S=p(l).exam)==null?void 0:S.reg_last_date).toLocaleDateString("bn-BD")),1),_(" । বিলম্ব ফি সহ নিবন্ধনের চূড়ান্ত তারিখ "),e("b",null,d(new Date((E=p(l).exam)==null?void 0:E.reg_final_date).toLocaleDateString("bn-BD")),1),_(" । ")])]),ge])]),e("div",ye,[e("div",xe,[r(e("input",{"onUpdate:modelValue":i[0]||(i[0]=t=>I.value=t),type:"search",class:W(["input-1 text-center",{"border-red-500":!!x.value}]),placeholder:"ইলহাক নাম্বার"},null,2),[[f,I.value]]),e("div",ke,d(x.value),1),e("button",{onClick:$,type:"button",class:"btn-2"},[Ve,_(" খুঁজুন ")])])]),e("form",{onSubmit:Y(X,["prevent"]),class:"space-y-4"},[e("div",Se,[e("div",null,[Ue,r(e("select",{"onUpdate:modelValue":i[1]||(i[1]=t=>s.value.area_id=t),class:"input-1"},[Ce,(o(!0),n(m,null,h(p(F).areas,t=>(o(),n("option",{key:t.id,value:t.id},d(t.name),9,we))),128))],512),[[U,s.value.area_id]])]),e("div",null,[ze,r(e("select",{"onUpdate:modelValue":i[2]||(i[2]=t=>s.value.institute_id=t),class:"input-1",disabled:!s.value.area_id},[Ie,(o(!0),n(m,null,h(p(b).institutes,t=>(o(),n("option",{key:t.id,value:t.id},d(t.institute_code)+" - "+d(t.name),9,Me))),128))],8,je),[[U,s.value.institute_id]])]),e("div",null,[De,r(e("select",{"onUpdate:modelValue":i[3]||(i[3]=t=>s.value.zamat_id=t),class:"input-1"},[Ae,(o(!0),n(m,null,h(p(L).departments,t=>(o(),n("optgroup",{label:t.name,key:t.id},[(o(!0),n(m,null,h(t.zamats,c=>(o(),n("option",{key:c.id,value:c.id},d(c.name),9,Le))),128))],8,Fe))),128))],512),[[U,s.value.zamat_id]])]),e("div",null,[Be,r(e("select",{"onUpdate:modelValue":i[4]||(i[4]=t=>s.value.group_id=t),class:"input-1",disabled:!s.value.zamat_id},[Ne,(o(!0),n(m,null,h(p(w).groups,t=>(o(),n("option",{key:t.id,value:t.id},[_(d(t.name)+" (",1),(o(!0),n(m,null,h(t.areas,(c,u)=>(o(),n(m,{key:c.id},[u?(o(),n("span",Ge,", ")):C("",!0),e("span",null,d(c.name),1)],64))),128)),_(") ")],8,qe))),128))],8,Ee),[[U,s.value.group_id]])]),C("",!0),e("div",null,[Oe,r(e("select",{"onUpdate:modelValue":i[6]||(i[6]=t=>s.value.center_id=t),class:"input-1",disabled:!s.value.zamat_id},[Pe,(o(!0),n(m,null,h(p(A).centers,t=>{var c;return o(),n("option",{key:t.id,value:t==null?void 0:t.institute_id},d((c=t==null?void 0:t.institute)==null?void 0:c.name),9,Te)}),128))],8,Re),[[U,s.value.center_id]])])]),e("div",Xe,[Ze,(o(!0),n(m,null,h(s.value.students,(t,c)=>(o(),n("div",{key:c},[e("div",$e,[e("div",He,[e("div",Je,d(c+1),1)]),e("div",Ke,[Qe,r(e("input",{"onUpdate:modelValue":u=>t.name=u,type:"text",class:"input-1",required:"",placeholder:"বাংলায়"},null,8,We),[[f,t.name]]),r(e("input",{"onUpdate:modelValue":u=>t.name_arabic=u,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Ye),[[f,t.name_arabic]])]),e("div",et,[tt,r(e("input",{"onUpdate:modelValue":u=>t.father_name=u,required:"",type:"text",class:"input-1",placeholder:"বাংলায়"},null,8,st),[[f,t.father_name]]),r(e("input",{"onUpdate:modelValue":u=>t.father_name_arabic=u,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,at),[[f,t.father_name_arabic]])]),e("div",lt,[it,r(e("input",{"onUpdate:modelValue":u=>t.date_of_birth=u,required:"",type:"date",class:"input-1"},null,8,ot),[[f,t.date_of_birth]])]),e("div",nt,[dt,r(e("input",{"onUpdate:modelValue":u=>t.address=u,type:"text",class:"input-1",placeholder:"গ্রাম, ডাকঘর, থানা, জেলা"},null,8,ut),[[f,t.address]])]),e("div",ct,[e("button",{type:"button",onClick:u=>P(c),class:"btn-4 py-2"},pt,8,rt)])])]))),128)),e("div",{class:"flex justify-center"},[e("button",{type:"button",onClick:R,class:"btn-contrast"},[mt,_(" আরেকজন যুক্ত করুন ")])])]),vt,M.value?(o(),n("div",ht,[e("div",ft,[e("div",null," প্রতি শিক্ষার্থীর ফি: "+d(p(l).exam.registration_fee)+" টাকা। বিলম্ব ফি (প্রযোজ্য ক্ষেত্রে): "+d(p(l).exam.late_fee)+" টাকা। ",1),e("div",bt,[_(" শিক্ষার্থীর সংখ্যা:"),e("b",null,d(s.value.students.length),1),_(" X "),e("b",null,d(M.value),1),_(" টাকা = "),e("b",null,d(s.value.students.length*M.value)+" টাকা",1)])]),e("button",{type:"submit",disabled:z.value,class:"btn-2"},d(z.value?"সাবমিট হচ্ছে...":"সাবমিট করুন"),9,gt)])):C("",!0),j.value?(o(),n("div",yt,d(j.value),1)):C("",!0),y.value?(o(),n("div",xt,d(y.value),1)):C("",!0)],32)]),e("div",kt,[ee(v,{to:{name:"PublicFunctions"},class:"btn-3"},{default:te(()=>[_("পিছনে যান")]),_:1})])])}}};export{Ft as default};
