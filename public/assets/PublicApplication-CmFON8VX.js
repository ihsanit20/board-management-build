import{f as Z,r as C,s as V,o as X,x as $,l as H,a as o,c as i,b as e,t as n,d as m,q as v,w as J,i as u,y as g,F as h,m as f,j,n as K,p as Q,e as W,v as b}from"./index-_YQyFPma.js";import{u as Y}from"./application-CBBvTm6G.js";import{u as ee}from"./exam-DnVGQbVX.js";import{u as te}from"./institute-CZSAXtQZ.js";import{u as ae}from"./area-CjfcXp_v.js";import{u as se}from"./zamat-wYIGjr0R.js";import{u as le}from"./group-CmRze_0l.js";import{u as oe}from"./center-C2yd6d30.js";import{u as ie}from"./fee-PwFtQhvH.js";import{t as ne}from"./date-Cwd8pd0-.js";const de={class:"my-container py-6"},ce={class:"md:p-8 p-4 card-bg space-y-2"},ue={class:"flex gap-4 justify-center items-center"},re={class:"flex flex-col items-center space-y-2"},_e={class:"title-xl"},me={class:"flex flex-wrap gap-2 text-center"},pe={class:"md:text-base text-sm"},ve=e("div",{class:"px-6 bg-sky-700 rounded-full pt-1"},[e("h2",{class:"title-lg text-white"},"আবেদন পত্র")],-1),he={class:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-md"},fe=e("label",{class:"block text-gray-700"},"এলাকা নির্বাচন করুন",-1),ge=e("option",{value:"",disabled:""},"Select Area",-1),be=["value"],xe=e("label",{class:"block text-gray-700"},"মাদরাসা নির্বাচন করুন",-1),ye=["disabled"],ke=e("option",{value:"",disabled:""},"Select Institute",-1),Se=["value"],Ve=e("label",{class:"block text-gray-700"},"মারহালা নির্বাচন করুন",-1),Ue=e("option",{value:"",disabled:""},"Select Marhala",-1),we=["label"],ze=["value"],Ce=e("label",{class:"block text-gray-700"},"গ্রুপ নির্বাচন করুন (যদি থাকে)",-1),Me=["disabled"],Ae=e("option",{value:"",disabled:""},"Select Group",-1),De=["value"],Fe=e("label",{class:"block text-gray-700"},"ধরন নির্বাচন করুন",-1),je=e("option",{value:"",disabled:""},"Select Gender",-1),Le=e("option",{value:"male"},"ছাত্র",-1),Be=e("option",{value:"female"},"ছাত্রী",-1),Ee=[je,Le,Be],Ie=e("label",{class:"block text-gray-700"},"কেন্দ্র নির্বাচন করুন",-1),Ne=["disabled"],qe=e("option",{value:"",disabled:""},"Select Center",-1),Ge=["value"],Oe={class:"space-y-2"},Re=W('<div class="flex justify-center"><h4 class="title-lg">শিক্ষার্থীদের তথ্য</h4></div><div class="hidden md:grid md:grid-cols-12 bg-gray-100 py-2 px-2 text-center divide-x-2 font-medium"><div class="text-center">ক্র</div><div class="col-span-2 text-center">শিক্ষার্থীর নাম</div><div class="col-span-2">পিতার নাম</div><div class="col-span-2"><p>জন্ম তারিখ</p><p class="text-xs">(জন্ম নিবন্ধন অনুসারে)</p></div><div class="col-span-4">ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)</div><div>ডিলিট</div></div>',2),Pe={class:"grid md:grid-cols-12 gap-4 border rounded p-2"},Te={class:"flex items-center justify-center"},Ze={class:"text-lg font-semibold mb-2 px-3 py-1 bg-gray-100 rounded-full"},Xe={class:"md:col-span-2 grid gap-2"},$e=e("div",{class:"md:hidden flex font-medium"},"শিক্ষার্থীর নাম:",-1),He=["onUpdate:modelValue"],Je=["onUpdate:modelValue"],Ke={class:"md:col-span-2 grid gap-2"},Qe=e("div",{class:"md:hidden flex font-medium"},"পিতার নাম:",-1),We=["onUpdate:modelValue"],Ye=["onUpdate:modelValue"],et={class:"md:col-span-2"},tt=e("p",{class:"md:hidden flex font-medium"},"জন্ম তারিখ (জন্ম নিবন্ধন অনুসারে)",-1),at=["onUpdate:modelValue"],st={class:"md:col-span-4"},lt=e("p",{class:"md:hidden flex font-medium"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)",-1),ot=["onUpdate:modelValue"],it={class:"flex justify-end md:justify-center items-start"},nt=["onClick"],dt=e("i",{class:"fas fa-trash-alt"},null,-1),ct=[dt],ut=e("i",{class:"fas fa-plus"},null,-1),rt=e("hr",{class:"my-4"},null,-1),_t={key:0,class:"flex flex-col items-center space-y-2"},mt={class:"flex flex-col items-center"},pt={class:"text-xl text-green-600"},vt=["disabled"],ht={key:1,class:"text-xl text-green-600"},ft={key:2,class:"text-xl text-red-600"},gt={class:"flex mt-4"},At={__name:"PublicApplication",setup(bt){const I=Z(),d=ee(),r=ie(),N=Y(),M=te(),A=oe(),L=ae(),B=se(),D=le(),U=C(!1),x=C(""),w=C(""),a=C({exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:""}],payment_method:"Online",total_amount:0}),q=async()=>{var s;M.institutes=[],D.groups=[],A.centers=[],r.fee={},await d.fetchLastExam(),a.value.exam_id=(s=d==null?void 0:d.exam)==null?void 0:s.id,await L.fetchAreas(),await B.fetchZamats()};V(()=>a.value.area_id,async s=>{s&&await M.fetchInstitutes({area_id:s})}),V(()=>a.value.zamat_id,async s=>{s&&(a.value.group_id="",await D.fetchGroups(s),await r.fetchFeeByExamAndZamat(a.value.exam_id,a.value.zamat_id))}),V(()=>a.value.zamat_id,async s=>{s&&a.value.gender&&F()}),V(()=>a.value.gender,async s=>{s&&a.value.gender&&F()}),V(()=>a.value.group_id,async s=>{s&&a.value.gender&&F()});const F=async()=>{A.fetchCenters({zamat_id:a.value.zamat_id,group_id:a.value.group_id,gender:a.value.gender})};X(q);const G=()=>{a.value.students.push({registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:""})},O=s=>{a.value.students.splice(s,1)},R=()=>{a.value={exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:""}],payment_method:"Online",total_amount:0}},P=async()=>{var s,l;U.value=!0,x.value="",w.value="";try{a.value.total_amount=z.value*(((l=(s=a==null?void 0:a.value)==null?void 0:s.students)==null?void 0:l.length)||0);const p=await N.createApplication(a.value);localStorage.setItem("applicationId",p.id),localStorage.setItem("instituteId",p.institute_id),w.value="আপনার আবেদন সফলভাবে জমা হয়েছে।",R(),I.push({name:"SuccessMessage"})}catch{x.value="আবেদন জমা দিতে ব্যর্থ হয়েছে।"}finally{U.value=!1}},T=s=>{x.value=s},z=$(()=>{var p,y,k,S;let s=((p=r==null?void 0:r.fee)==null?void 0:p.amount)||0;const l=ne();return l>((y=d==null?void 0:d.exam)==null?void 0:y.reg_final_date)?(T("আবেদন গ্রহণ বন্ধ রয়েছে"),s=0):(l>((k=d==null?void 0:d.exam)==null?void 0:k.reg_last_date)&&(s+=((S=r==null?void 0:r.fee)==null?void 0:S.late_fee)||0),s)});return(s,l)=>{var y,k,S,E;const p=H("RouterLink");return o(),i("div",de,[e("div",ce,[e("div",ue,[e("div",re,[e("h2",_e,n((k=(y=m(d))==null?void 0:y.exam)==null?void 0:k.name),1),e("div",me,[e("p",pe,[v(" আবেদনের শেষ তারিখ "),e("b",null,n(new Date((S=m(d).exam)==null?void 0:S.reg_last_date).toLocaleDateString("bn-BD")),1),v(" । বিলম্ব ফি সহ আবেদনের চূড়ান্ত তারিখ "),e("b",null,n(new Date((E=m(d).exam)==null?void 0:E.reg_final_date).toLocaleDateString("bn-BD")),1),v(" । ")])]),ve])]),e("form",{onSubmit:J(P,["prevent"]),class:"space-y-4"},[e("div",he,[e("div",null,[fe,u(e("select",{"onUpdate:modelValue":l[0]||(l[0]=t=>a.value.area_id=t),class:"input-1"},[ge,(o(!0),i(h,null,f(m(L).areas,t=>(o(),i("option",{key:t.id,value:t.id},n(t.name),9,be))),128))],512),[[g,a.value.area_id]])]),e("div",null,[xe,u(e("select",{"onUpdate:modelValue":l[1]||(l[1]=t=>a.value.institute_id=t),class:"input-1",disabled:!a.value.area_id},[ke,(o(!0),i(h,null,f(m(M).institutes,t=>(o(),i("option",{key:t.id,value:t.id},n(t.name),9,Se))),128))],8,ye),[[g,a.value.institute_id]])]),e("div",null,[Ve,u(e("select",{"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.zamat_id=t),class:"input-1"},[Ue,(o(!0),i(h,null,f(m(B).departments,t=>(o(),i("optgroup",{label:t.name,key:t.id},[(o(!0),i(h,null,f(t.zamats,_=>(o(),i("option",{key:_.id,value:_.id},n(_.name),9,ze))),128))],8,we))),128))],512),[[g,a.value.zamat_id]])]),e("div",null,[Ce,u(e("select",{"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.group_id=t),class:"input-1",disabled:!a.value.zamat_id},[Ae,(o(!0),i(h,null,f(m(D).groups,t=>(o(),i("option",{key:t.id,value:t.id},n(t.name),9,De))),128))],8,Me),[[g,a.value.group_id]])]),e("div",null,[Fe,u(e("select",{"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.gender=t),class:"input-1"},Ee,512),[[g,a.value.gender]])]),e("div",null,[Ie,u(e("select",{"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.center_id=t),class:"input-1",disabled:!a.value.zamat_id||!a.value.gender},[qe,(o(!0),i(h,null,f(m(A).centers,t=>{var _;return o(),i("option",{key:t.id,value:t==null?void 0:t.institute_id},n((_=t==null?void 0:t.institute)==null?void 0:_.name),9,Ge)}),128))],8,Ne),[[g,a.value.center_id]])])]),e("div",Oe,[Re,(o(!0),i(h,null,f(a.value.students,(t,_)=>(o(),i("div",{key:_},[e("div",Pe,[e("div",Te,[e("div",Ze,n(_+1),1)]),e("div",Xe,[$e,u(e("input",{"onUpdate:modelValue":c=>t.name=c,type:"text",class:"input-1",required:"",placeholder:"বাংলায়"},null,8,He),[[b,t.name]]),u(e("input",{"onUpdate:modelValue":c=>t.name_arabic=c,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Je),[[b,t.name_arabic]])]),e("div",Ke,[Qe,u(e("input",{"onUpdate:modelValue":c=>t.father_name=c,required:"",type:"text",class:"input-1",placeholder:"বাংলায়"},null,8,We),[[b,t.father_name]]),u(e("input",{"onUpdate:modelValue":c=>t.father_name_arabic=c,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Ye),[[b,t.father_name_arabic]])]),e("div",et,[tt,u(e("input",{"onUpdate:modelValue":c=>t.date_of_birth=c,required:"",type:"date",class:"input-1"},null,8,at),[[b,t.date_of_birth]])]),e("div",st,[lt,u(e("input",{"onUpdate:modelValue":c=>t.address=c,type:"text",class:"input-1",placeholder:"গ্রাম, ডাকঘর, থানা, জেলা"},null,8,ot),[[b,t.address]])]),e("div",it,[e("button",{type:"button",onClick:c=>O(_),class:"btn-4 py-2"},ct,8,nt)])])]))),128)),e("div",{class:"flex justify-center"},[e("button",{type:"button",onClick:G,class:"btn-contrast"},[ut,v(" আরেকজন যুক্ত করুন ")])])]),rt,z.value?(o(),i("div",_t,[e("div",mt,[e("div",null," প্রতি শিক্ষার্থীর ফি: "+n(m(r).fee.amount)+" টাকা। বিলম্ব ফি (প্রযোজ্য ক্ষেত্রে): "+n(m(r).fee.late_fee)+" টাকা। ",1),e("div",pt,[v(" শিক্ষার্থীর সংখ্যা:"),e("b",null,n(a.value.students.length),1),v(" X ফি "),e("b",null,n(z.value),1),v(" টাকা = "),e("b",null,n(a.value.students.length*z.value)+" টাকা",1)])]),e("button",{type:"submit",disabled:U.value,class:"btn-2"},n(U.value?"সাবমিট হচ্ছে...":"সাবমিট করুন"),9,vt)])):j("",!0),w.value?(o(),i("div",ht,n(w.value),1)):j("",!0),x.value?(o(),i("div",ft,n(x.value),1)):j("",!0)],32)]),e("div",gt,[K(p,{to:{name:"PublicFunctions"},class:"btn-3"},{default:Q(()=>[v("পিছনে যান")]),_:1})])])}}};export{At as default};
