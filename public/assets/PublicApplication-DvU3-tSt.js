import{B as se,r as V,i as q,C as $,o as ae,c as i,a as t,t as d,b as _,y as m,j as p,v as g,n as le,p as ie,D as U,F as v,e as b,h as y,l as oe,f as ne,w as de,z as re,d as o,G as ue,s as pe}from"./index-By_5JoKt.js";import{u as ce}from"./application-VwsDZP67.js";import{u as me}from"./institute-dEOocGR8.js";import{u as _e}from"./area-dz5hPP_8.js";import{u as ve}from"./zamat-CvWKJwBL.js";import{u as fe}from"./group-FzkW1GN2.js";import{u as be}from"./center-CM444ouZ.js";import{u as ge}from"./fee-BGmShKsS.js";import{u as ye}from"./para-group-Yly1WLsA.js";import{t as xe}from"./date-Cs-xe4uq.js";const he={class:"my-container py-6"},ke={class:"md:p-8 p-4 card-bg space-y-2"},Se={class:"flex gap-4 justify-center items-center"},Ve={class:"flex flex-col items-center space-y-2"},Ue={class:"title-xl"},we={class:"flex flex-wrap gap-2 text-center"},Ce={class:"md:text-base text-sm"},ze={class:"flex justify-center items-center"},De={class:"flex gap-2 justify-center items-center bg-gray-100 p-4 rounded-lg"},$e={class:"text-red-500"},Me={class:"flex justify-center items-center gap-2 text-sm"},je={class:"px-2 py-1 rounded bg-gray-100"},Be={key:0,class:"text-gray-500"},Ae={key:1,class:"text-red-600 font-medium"},qe={class:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-md"},Ee={class:"col-start-1"},Fe=["value"],Ge=["disabled"],Ie=["value"],Le=["label"],Ne=["value"],Oe=["disabled"],Pe=["value"],Te={key:0},Ye=["disabled"],Ke=["value"],Re={class:"space-y-2"},Xe={class:"grid md:grid-cols-12 gap-4 border rounded p-2"},He={class:"flex items-center justify-center"},Je={class:"text-lg font-semibold mb-2 px-3 py-1 bg-gray-100 rounded-full"},Qe={class:"md:col-span-2 grid gap-2"},We=["onUpdate:modelValue"],Ze=["onUpdate:modelValue"],et={class:"md:col-span-2 grid gap-2"},tt=["onUpdate:modelValue"],st=["onUpdate:modelValue"],at={class:"md:col-span-2"},lt={class:"flex relative"},it={key:0,class:"absolute left-2 top-3"},ot=["onUpdate:modelValue","onBlur","onKeyup"],nt=["onChange","onUpdate:modelValue"],dt={class:"md:col-span-2"},rt=["onUpdate:modelValue","disabled"],ut=["value"],pt={class:"md:col-span-2"},ct=["onUpdate:modelValue"],mt={class:"flex justify-end md:justify-center items-start"},_t=["onClick"],vt={class:"flex flex-col items-center gap-1"},ft=["disabled","title"],bt={key:0,class:"text-red-600"},gt={key:0,class:"flex flex-col items-center space-y-2"},yt={class:"flex flex-col items-center"},xt={class:"text-xl text-green-600"},ht=["disabled"],kt={class:"flex justify-center"},St={key:0,class:"text-xl text-green-600"},Vt={key:1,class:"text-xl text-red-600"},Ut={class:"flex mt-4"},h=99,Ft={__name:"PublicApplication",setup(wt){const T=pe(),r=se(),Y=ge(),K=ce(),k=me(),E=be(),I=_e(),L=ve(),F=fe(),G=ye(),M=V(!1),S=V(""),j=V(""),B=V(""),w=V(""),l=V({exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:"",para:""}],payment_method:"Offline",total_amount:0}),C=q(()=>l.value.students.length),z=q(()=>C.value<h),R=q(()=>h-C.value),X=async()=>{var a;k.institutes=[],F.groups=[],E.centers=[],Y.fee={},await r.fetchLastExam(),l.value.exam_id=(a=r==null?void 0:r.exam)==null?void 0:a.id,await I.fetchAreas(),await L.fetchZamats()};$(()=>l.value.area_id,async a=>{a&&await k.fetchInstitutes({area_id:a,per_page:"all"})}),$(()=>l.value.zamat_id,async a=>{a?(l.value.group_id="",await F.fetchGroups(a),await G.fetchParaGroups({zamat_id:a})):G.paraGroups=[]}),$(()=>l.value.zamat_id,async a=>{a&&N()}),$(()=>l.value.group_id,async a=>{a&&N()}),$(B,()=>{w.value=""});const N=async()=>{E.fetchCenters({zamat_id:l.value.zamat_id,group_id:l.value.group_id,gender:l.value.gender})};ae(X);const H=()=>{if(!z.value){S.value=`সর্বোচ্চ ${h} জন পর্যন্ত পরীক্ষার্থী যোগ করা যাবে।`;return}l.value.students.push({registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""})},J=a=>{confirm("ডিলিট নিশ্চিত করুন")&&l.value.students.splice(a,1)},Q=()=>{l.value={exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:"",para:""}],payment_method:"Offline",total_amount:0}},W=async()=>{var a,e;M.value=!0,S.value="",j.value="";try{if(C.value===0)throw new Error("কমপক্ষে ১ জন পরীক্ষার্থী যোগ করুন।");if(C.value>h)throw new Error(`সর্বোচ্চ ${h} জন পর্যন্ত পরীক্ষার্থী যোগ করা যাবে।`);l.value.total_amount=A.value*(((e=(a=l==null?void 0:l.value)==null?void 0:a.students)==null?void 0:e.length)||0);const u=await K.createApplication(l.value);localStorage.setItem("applicationId",u.id),localStorage.setItem("instituteCode",u.institute.institute_code),j.value="আপনার নিবন্ধন সফলভাবে জমা হয়েছে।",Q(),T.push({name:"SuccessMessage"})}catch(u){S.value=(u==null?void 0:u.message)||"নিবন্ধন জমা দিতে ব্যর্থ হয়েছে।"}finally{M.value=!1}},Z=a=>{S.value=a},A=q(()=>{var u,f,x,D;let a=parseInt(((u=r==null?void 0:r.exam)==null?void 0:u.registration_fee)||0);const e=xe();return e>((f=r==null?void 0:r.exam)==null?void 0:f.reg_final_date)?(Z("নিবন্ধন গ্রহণ বন্ধ রয়েছে"),a=0):(e>((x=r==null?void 0:r.exam)==null?void 0:x.reg_last_date)&&(a+=parseInt(((D=r==null?void 0:r.exam)==null?void 0:D.late_fee)||0)),a)}),ee=async()=>{l.value.area_id="",l.value.institute_id="",k.institutes=[],w.value="";const a=await k.findInstituteByCode(B.value);a?(k.institutes[0]=a,l.value.area_id=a.area_id,l.value.institute_id=a.id):w.value="খুঁজে পাওয়া যায় নি!"},O=a=>{if(/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/.test(a.input_dob)){const[u,f,x]=a.input_dob.split("/");a.date_of_birth=`${x}-${f}-${u}`}else a.date_of_birth="",a.input_dob=""},te=a=>{if(a.date_of_birth&&/^\d{4}-\d{2}-\d{2}$/.test(a.date_of_birth)){const[e,u,f]=a.date_of_birth.split("-");a.input_dob=`${f}/${u}/${e}`}else a.input_dob=""};return(a,e)=>{var f,x,D,P;const u=re("RouterLink");return o(),i("div",he,[t("div",ke,[t("div",Se,[t("div",Ve,[t("h2",Ue,d((x=(f=_(r))==null?void 0:f.exam)==null?void 0:x.name),1),t("div",we,[t("p",Ce,[e[9]||(e[9]=m(" নিবন্ধনের শেষ তারিখ ")),t("b",null,d(new Date((D=_(r).exam)==null?void 0:D.reg_last_date).toLocaleDateString("bn-BD")),1),e[10]||(e[10]=m(" । বিলম্ব ফি সহ নিবন্ধনের চূড়ান্ত তারিখ ")),t("b",null,d(new Date((P=_(r).exam)==null?void 0:P.reg_final_date).toLocaleDateString("bn-BD")),1),e[11]||(e[11]=m(" । "))])]),e[12]||(e[12]=t("div",{class:"px-6 bg-sky-700 rounded-full pt-1"},[t("h2",{class:"title-lg text-white"},"নিবন্ধন পত্র")],-1))])]),t("div",ze,[t("div",De,[p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>B.value=s),type:"search",class:le(["input-1 text-center",{"border-red-500":!!w.value}]),placeholder:"ইলহাক নাম্বার"},null,2),[[g,B.value]]),t("div",$e,d(w.value),1),t("button",{onClick:ee,type:"button",class:"btn-2"},e[13]||(e[13]=[t("i",{class:"fas fa-search"},null,-1),m(" খুঁজুন ")]))])]),t("div",Me,[t("span",je,[e[14]||(e[14]=m(" মোট পরীক্ষার্থী: ")),t("b",null,d(C.value),1),e[15]||(e[15]=m(" / ")),t("b",null,d(h))]),z.value?(o(),i("span",Be," আরও "+d(R.value)+" জন যোগ করা যাবে ",1)):(o(),i("span",Ae," সর্বোচ্চ সীমা পূর্ণ হয়েছে "))]),t("form",{onSubmit:ie(W,["prevent"]),class:"space-y-4"},[t("div",qe,[t("div",Ee,[e[17]||(e[17]=t("label",{class:"block text-gray-700"},"অঞ্চল নির্বাচন করুন",-1)),p(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.area_id=s),class:"input-1",required:""},[e[16]||(e[16]=t("option",{value:"",disabled:""},"Select Area",-1)),(o(!0),i(v,null,b(_(I).areas,s=>(o(),i("option",{key:s.id,value:s.id},d(s.name),9,Fe))),128))],512),[[U,l.value.area_id]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-gray-700"},"মাদরাসা নির্বাচন করুন",-1)),p(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.institute_id=s),class:"input-1",disabled:!l.value.area_id,required:""},[e[18]||(e[18]=t("option",{value:"",disabled:""},"Select Institute",-1)),(o(!0),i(v,null,b(_(k).institutes,s=>(o(),i("option",{key:s.id,value:s.id},d(s.institute_code)+" - "+d(s.name),9,Ie))),128))],8,Ge),[[U,l.value.institute_id]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-gray-700"},"মারহালা নির্বাচন করুন",-1)),p(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.zamat_id=s),class:"input-1",required:""},[e[20]||(e[20]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(o(!0),i(v,null,b(_(L).departments,s=>(o(),i("optgroup",{label:s.name,key:s.id},[(o(!0),i(v,null,b(s.zamats,c=>(o(),i("option",{key:c.id,value:c.id},d(c.name),9,Ne))),128))],8,Le))),128))],512),[[U,l.value.zamat_id]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-gray-700"},"গ্রুপ নির্বাচন করুন (যদি থাকে)",-1)),p(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.group_id=s),class:"input-1",disabled:!l.value.zamat_id},[e[23]||(e[23]=t("option",{value:"",disabled:""},"Select Group",-1)),(o(!0),i(v,null,b(_(F).groups,s=>(o(),i("option",{key:s.id,value:s.id},[m(d(s.name)+" (",1),(o(!0),i(v,null,b(s.areas,(c,n)=>(o(),i(v,{key:c.id},[n?(o(),i("span",Te,", ")):y("",!0),t("span",null,d(c.name),1)],64))),128)),e[22]||(e[22]=m(") "))],8,Pe))),128))],8,Oe),[[U,l.value.group_id]])]),y("",!0),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-gray-700"},"কেন্দ্র নির্বাচন করুন",-1)),p(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.center_id=s),class:"input-1",disabled:!l.value.zamat_id,required:""},[e[27]||(e[27]=t("option",{value:"",disabled:""},"Select Center",-1)),(o(!0),i(v,null,b(_(E).centers,s=>{var c;return o(),i("option",{key:s.id,value:s==null?void 0:s.institute_id},d((c=s==null?void 0:s.institute)==null?void 0:c.name),9,Ke)}),128))],8,Ye),[[U,l.value.center_id]])])]),t("div",Re,[e[38]||(e[38]=oe('<div class="flex justify-center"><h4 class="title-lg">পরীক্ষার্থীদের তথ্য</h4></div><div class="hidden md:grid md:grid-cols-12 bg-gray-100 py-2 px-2 text-center divide-x-2 font-medium"><div class="text-center">ক্র</div><div class="col-span-2 text-center">পরীক্ষার্থীর নাম</div><div class="col-span-2">পিতার নাম</div><div class="col-span-2"> জন্ম তারিখ <br><span class="text-xs">(জন্ম নিবন্ধন অনুসারে)</span></div><div class="col-span-2"> পারার বিবরণ <br><span class="text-xs">(হিফজের ক্ষেত্রে)</span></div><div class="col-span-2"> ঠিকানা <br><span class="text-xs">(গ্রাম, ডাকঘর, থানা, জেলা)</span></div><div>ডিলিট</div></div>',2)),(o(!0),i(v,null,b(l.value.students,(s,c)=>(o(),i("div",{key:c},[t("div",Xe,[t("div",He,[t("div",Je,d(c+1),1)]),t("div",Qe,[e[29]||(e[29]=t("div",{class:"md:hidden flex font-medium"},"পরীক্ষার্থীর নাম:",-1)),p(t("input",{"onUpdate:modelValue":n=>s.name=n,type:"text",class:"input-1",required:"",placeholder:"বাংলায়"},null,8,We),[[g,s.name]]),p(t("input",{"onUpdate:modelValue":n=>s.name_arabic=n,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Ze),[[g,s.name_arabic]])]),t("div",et,[e[30]||(e[30]=t("div",{class:"md:hidden flex font-medium"},"পিতার নাম:",-1)),p(t("input",{"onUpdate:modelValue":n=>s.father_name=n,required:"",type:"text",class:"input-1",placeholder:"বাংলায়"},null,8,tt),[[g,s.father_name]]),p(t("input",{"onUpdate:modelValue":n=>s.father_name_arabic=n,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,st),[[g,s.father_name_arabic]])]),t("div",at,[e[32]||(e[32]=t("p",{class:"md:hidden flex font-medium"},"জন্ম তারিখ (জন্ম নিবন্ধন অনুসারে)",-1)),t("div",lt,[s.date_of_birth?(o(),i("div",it,e[31]||(e[31]=[t("i",{class:"fa fa-check-circle text-green-500"},null,-1)]))):y("",!0),p(t("input",{"onUpdate:modelValue":n=>s.input_dob=n,required:"",type:"text",placeholder:"DD/MM/YYYY",class:"input-1 border-r-0 rounded-r-none text-center",onBlur:n=>O(s),onKeyup:ue(n=>O(s),["enter"])},null,40,ot),[[g,s.input_dob]]),p(t("input",{onChange:n=>te(s),"onUpdate:modelValue":n=>s.date_of_birth=n,required:"",type:"date",class:"input-1 w-10 px-2 rounded-l-none"},null,40,nt),[[g,s.date_of_birth]])])]),t("div",dt,[e[34]||(e[34]=t("p",{class:"md:hidden flex font-medium"},"পারার বিববরণ (হিফজের ক্ষেত্রে)",-1)),p(t("select",{"onUpdate:modelValue":n=>s.para=n,class:"input-1",disabled:!l.value.zamat_id},[e[33]||(e[33]=t("option",{value:"",disabled:""},"পারা নির্বাচন করুন",-1)),(o(!0),i(v,null,b(_(G).paraGroups,n=>(o(),i("option",{key:n.id,value:n.id},d(n.name),9,ut))),128))],8,rt),[[U,s.para]])]),t("div",pt,[e[35]||(e[35]=t("p",{class:"md:hidden flex font-medium"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)",-1)),p(t("input",{"onUpdate:modelValue":n=>s.address=n,type:"text",class:"input-1",placeholder:"গ্রাম, ডাকঘর, থানা, জেলা"},null,8,ct),[[g,s.address]])]),t("div",mt,[t("button",{type:"button",onClick:n=>J(c),class:"btn-4 py-2"},e[36]||(e[36]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,_t)])])]))),128)),t("div",vt,[t("button",{type:"button",onClick:H,class:"btn-contrast",disabled:!z.value,title:z.value?"আরেকজন যুক্ত করুন":"সর্বোচ্চ সীমা পূর্ণ"},e[37]||(e[37]=[t("i",{class:"fas fa-plus"},null,-1),m(" আরেকজন যুক্ত করুন ")]),8,ft),z.value?y("",!0):(o(),i("small",bt," সর্বোচ্চ "+d(h)+" জন পর্যন্ত যোগ করা যাবে। "))])]),e[45]||(e[45]=t("hr",{class:"my-4"},null,-1)),A.value?(o(),i("div",gt,[t("div",yt,[t("div",null," প্রতি পরীক্ষার্থীর ফি: "+d(_(r).exam.registration_fee)+" টাকা। বিলম্ব ফি (প্রযোজ্য ক্ষেত্রে): "+d(_(r).exam.late_fee)+" টাকা। ",1),t("div",xt,[e[39]||(e[39]=m(" পরীক্ষার্থীর সংখ্যা:")),t("b",null,d(l.value.students.length),1),e[40]||(e[40]=m(" X ")),t("b",null,d(A.value),1),e[41]||(e[41]=m(" টাকা = ")),t("b",null,d(l.value.students.length*A.value)+" টাকা",1)])]),y("",!0),t("button",{type:"submit",disabled:M.value,class:"btn-2"},d(M.value?"সাবমিট হচ্ছে...":"সাবমিট করুন"),9,ht)])):y("",!0),t("div",kt,[j.value?(o(),i("div",St,d(j.value),1)):y("",!0),S.value?(o(),i("div",Vt,d(S.value),1)):y("",!0)])],32)]),t("div",Ut,[ne(u,{to:{name:"PublicFunctions"},class:"btn-3"},{default:de(()=>e[46]||(e[46]=[m("পিছনে যান")])),_:1})])])}}};export{Ft as default};
