import{B as Q,r as k,C as w,o as W,i as Z,c as o,a as t,t as r,b as m,y as _,j as u,v as y,n as ee,p as te,D as V,F as v,e as b,h as x,l as se,f as ae,w as le,z as ie,d as n,G as oe,s as ne}from"./index-CSv3p2Td.js";import{u as de}from"./application-CGTil7N1.js";import{u as re}from"./institute-DVSrI-IG.js";import{u as ue}from"./area-Cq3FHIgW.js";import{u as pe}from"./zamat-0BSYJFMo.js";import{u as ce}from"./group-BAF9-iSs.js";import{u as me}from"./center-CytKhyRJ.js";import{u as _e}from"./fee-DGS9-_M9.js";import{u as ve}from"./para-group-BXtWhZ-Q.js";import{t as fe}from"./date-Cs-xe4uq.js";const be={class:"my-container py-6"},ye={class:"md:p-8 p-4 card-bg space-y-2"},ge={class:"flex gap-4 justify-center items-center"},xe={class:"flex flex-col items-center space-y-2"},he={class:"title-xl"},ke={class:"flex flex-wrap gap-2 text-center"},Ve={class:"md:text-base text-sm"},Se={class:"flex justify-center items-center"},Ue={class:"flex gap-2 justify-center items-center bg-gray-100 p-4 rounded-lg"},Ce={class:"text-red-500"},we={class:"grid md:grid-cols-2 gap-4 bg-gray-100 p-4 rounded-md"},ze={class:"col-start-1"},De=["value"],$e=["disabled"],Me=["value"],je=["label"],Be=["value"],qe=["disabled"],Ae=["value"],Fe={key:0},Ge=["disabled"],Ie=["value"],Le={class:"space-y-2"},Ee={class:"grid md:grid-cols-12 gap-4 border rounded p-2"},Ne={class:"flex items-center justify-center"},Oe={class:"text-lg font-semibold mb-2 px-3 py-1 bg-gray-100 rounded-full"},Pe={class:"md:col-span-2 grid gap-2"},Ye=["onUpdate:modelValue"],Ke=["onUpdate:modelValue"],Re={class:"md:col-span-2 grid gap-2"},Te=["onUpdate:modelValue"],Xe=["onUpdate:modelValue"],He={class:"md:col-span-2"},Je={class:"flex relative"},Qe={key:0,class:"absolute left-2 top-3"},We=["onUpdate:modelValue","onBlur","onKeyup"],Ze=["onChange","onUpdate:modelValue"],et={class:"md:col-span-2"},tt=["onUpdate:modelValue","disabled"],st=["value"],at={class:"md:col-span-2"},lt=["onUpdate:modelValue"],it={class:"flex justify-end md:justify-center items-start"},ot=["onClick"],nt={key:0,class:"flex flex-col items-center space-y-2"},dt={class:"flex flex-col items-center"},rt={class:"text-xl text-green-600"},ut=["disabled"],pt={class:"flex justify-center"},ct={key:0,class:"text-xl text-green-600"},mt={key:1,class:"text-xl text-red-600"},_t={class:"flex mt-4"},Ct={__name:"PublicApplication",setup(vt){const E=ne(),d=Q(),N=_e(),O=de(),h=re(),j=me(),A=ue(),F=pe(),B=ce(),q=ve(),z=k(!1),S=k(""),D=k(""),$=k(""),U=k(""),l=k({exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:"",para:""}],payment_method:"Offline",total_amount:0}),P=async()=>{var a;h.institutes=[],B.groups=[],j.centers=[],N.fee={},await d.fetchLastExam(),l.value.exam_id=(a=d==null?void 0:d.exam)==null?void 0:a.id,await A.fetchAreas(),await F.fetchZamats()};w(()=>l.value.area_id,async a=>{a&&await h.fetchInstitutes({area_id:a,per_page:"all"})}),w(()=>l.value.zamat_id,async a=>{a?(l.value.group_id="",await B.fetchGroups(a),await q.fetchParaGroups({zamat_id:a})):q.paraGroups=[]}),w(()=>l.value.zamat_id,async a=>{a&&G()}),w(()=>l.value.group_id,async a=>{a&&G()}),w($,()=>{U.value=""});const G=async()=>{j.fetchCenters({zamat_id:l.value.zamat_id,group_id:l.value.group_id,gender:l.value.gender})};W(P);const Y=()=>{l.value.students.push({registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",para:"",address:""})},K=a=>{confirm("ডিলিট নিশ্চিত করুন")&&l.value.students.splice(a,1)},R=()=>{l.value={exam_id:"",zamat_id:"",institute_id:"",area_id:"",group_id:"",gender:"",center_id:"",students:[{registration:"",name:"",name_arabic:"",father_name:"",father_name_arabic:"",date_of_birth:"",address:"",para:""}],payment_method:"Offline",total_amount:0}},T=async()=>{var a,e;z.value=!0,S.value="",D.value="";try{l.value.total_amount=M.value*(((e=(a=l==null?void 0:l.value)==null?void 0:a.students)==null?void 0:e.length)||0);const c=await O.createApplication(l.value);localStorage.setItem("applicationId",c.id),localStorage.setItem("instituteCode",c.institute.institute_code),D.value="আপনার নিবন্ধন সফলভাবে জমা হয়েছে।",R(),E.push({name:"SuccessMessage"})}catch{S.value="নিবন্ধন জমা দিতে ব্যর্থ হয়েছে।"}finally{z.value=!1}},X=a=>{S.value=a},M=Z(()=>{var c,f,g,C;let a=parseInt(((c=d==null?void 0:d.exam)==null?void 0:c.registration_fee)||0);const e=fe();return e>((f=d==null?void 0:d.exam)==null?void 0:f.reg_final_date)?(X("নিবন্ধন গ্রহণ বন্ধ রয়েছে"),a=0):(e>((g=d==null?void 0:d.exam)==null?void 0:g.reg_last_date)&&(a+=parseInt(((C=d==null?void 0:d.exam)==null?void 0:C.late_fee)||0)),a)}),H=async()=>{l.value.area_id="",l.value.institute_id="",h.institutes=[],U.value="";const a=await h.findInstituteByCode($.value);a?(h.institutes[0]=a,l.value.area_id=a.area_id,l.value.institute_id=a.id):U.value="খুঁজে পাওয়া যায় নি!"},I=a=>{if(/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/.test(a.input_dob)){const[c,f,g]=a.input_dob.split("/");a.date_of_birth=`${g}-${f}-${c}`}else a.date_of_birth="",a.input_dob=""},J=a=>{if(a.date_of_birth&&/^\d{4}-\d{2}-\d{2}$/.test(a.date_of_birth)){const[e,c,f]=a.date_of_birth.split("-");a.input_dob=`${f}/${c}/${e}`}else a.input_dob=""};return(a,e)=>{var f,g,C,L;const c=ie("RouterLink");return n(),o("div",be,[t("div",ye,[t("div",ge,[t("div",xe,[t("h2",he,r((g=(f=m(d))==null?void 0:f.exam)==null?void 0:g.name),1),t("div",ke,[t("p",Ve,[e[9]||(e[9]=_(" নিবন্ধনের শেষ তারিখ ")),t("b",null,r(new Date((C=m(d).exam)==null?void 0:C.reg_last_date).toLocaleDateString("bn-BD")),1),e[10]||(e[10]=_(" । বিলম্ব ফি সহ নিবন্ধনের চূড়ান্ত তারিখ ")),t("b",null,r(new Date((L=m(d).exam)==null?void 0:L.reg_final_date).toLocaleDateString("bn-BD")),1),e[11]||(e[11]=_(" । "))])]),e[12]||(e[12]=t("div",{class:"px-6 bg-sky-700 rounded-full pt-1"},[t("h2",{class:"title-lg text-white"},"নিবন্ধন পত্র")],-1))])]),t("div",Se,[t("div",Ue,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>$.value=s),type:"search",class:ee(["input-1 text-center",{"border-red-500":!!U.value}]),placeholder:"ইলহাক নাম্বার"},null,2),[[y,$.value]]),t("div",Ce,r(U.value),1),t("button",{onClick:H,type:"button",class:"btn-2"},e[13]||(e[13]=[t("i",{class:"fas fa-search"},null,-1),_(" খুঁজুন ")]))])]),t("form",{onSubmit:te(T,["prevent"]),class:"space-y-4"},[t("div",we,[t("div",ze,[e[15]||(e[15]=t("label",{class:"block text-gray-700"},"অঞ্চল নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.area_id=s),class:"input-1",required:""},[e[14]||(e[14]=t("option",{value:"",disabled:""},"Select Area",-1)),(n(!0),o(v,null,b(m(A).areas,s=>(n(),o("option",{key:s.id,value:s.id},r(s.name),9,De))),128))],512),[[V,l.value.area_id]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-gray-700"},"মাদরাসা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.institute_id=s),class:"input-1",disabled:!l.value.area_id,required:""},[e[16]||(e[16]=t("option",{value:"",disabled:""},"Select Institute",-1)),(n(!0),o(v,null,b(m(h).institutes,s=>(n(),o("option",{key:s.id,value:s.id},r(s.institute_code)+" - "+r(s.name),9,Me))),128))],8,$e),[[V,l.value.institute_id]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-gray-700"},"মারহালা নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.zamat_id=s),class:"input-1",required:""},[e[18]||(e[18]=t("option",{value:"",disabled:""},"Select Marhala",-1)),(n(!0),o(v,null,b(m(F).departments,s=>(n(),o("optgroup",{label:s.name,key:s.id},[(n(!0),o(v,null,b(s.zamats,p=>(n(),o("option",{key:p.id,value:p.id},r(p.name),9,Be))),128))],8,je))),128))],512),[[V,l.value.zamat_id]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-gray-700"},"গ্রুপ নির্বাচন করুন (যদি থাকে)",-1)),u(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.group_id=s),class:"input-1",disabled:!l.value.zamat_id},[e[21]||(e[21]=t("option",{value:"",disabled:""},"Select Group",-1)),(n(!0),o(v,null,b(m(B).groups,s=>(n(),o("option",{key:s.id,value:s.id},[_(r(s.name)+" (",1),(n(!0),o(v,null,b(s.areas,(p,i)=>(n(),o(v,{key:p.id},[i?(n(),o("span",Fe,", ")):x("",!0),t("span",null,r(p.name),1)],64))),128)),e[20]||(e[20]=_(") "))],8,Ae))),128))],8,qe),[[V,l.value.group_id]])]),x("",!0),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-gray-700"},"কেন্দ্র নির্বাচন করুন",-1)),u(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.center_id=s),class:"input-1",disabled:!l.value.zamat_id,required:""},[e[25]||(e[25]=t("option",{value:"",disabled:""},"Select Center",-1)),(n(!0),o(v,null,b(m(j).centers,s=>{var p;return n(),o("option",{key:s.id,value:s==null?void 0:s.institute_id},r((p=s==null?void 0:s.institute)==null?void 0:p.name),9,Ie)}),128))],8,Ge),[[V,l.value.center_id]])])]),t("div",Le,[e[36]||(e[36]=se('<div class="flex justify-center"><h4 class="title-lg">পরীক্ষার্থীদের তথ্য</h4></div><div class="hidden md:grid md:grid-cols-12 bg-gray-100 py-2 px-2 text-center divide-x-2 font-medium"><div class="text-center">ক্র</div><div class="col-span-2 text-center">পরীক্ষার্থীর নাম</div><div class="col-span-2">পিতার নাম</div><div class="col-span-2"> জন্ম তারিখ <br><span class="text-xs">(জন্ম নিবন্ধন অনুসারে)</span></div><div class="col-span-2"> পারার বিবরণ <br><span class="text-xs">(হিফজের ক্ষেত্রে)</span></div><div class="col-span-2"> ঠিকানা <br><span class="text-xs">(গ্রাম, ডাকঘর, থানা, জেলা)</span></div><div>ডিলিট</div></div>',2)),(n(!0),o(v,null,b(l.value.students,(s,p)=>(n(),o("div",{key:p},[t("div",Ee,[t("div",Ne,[t("div",Oe,r(p+1),1)]),t("div",Pe,[e[27]||(e[27]=t("div",{class:"md:hidden flex font-medium"},"পরীক্ষার্থীর নাম:",-1)),u(t("input",{"onUpdate:modelValue":i=>s.name=i,type:"text",class:"input-1",required:"",placeholder:"বাংলায়"},null,8,Ye),[[y,s.name]]),u(t("input",{"onUpdate:modelValue":i=>s.name_arabic=i,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Ke),[[y,s.name_arabic]])]),t("div",Re,[e[28]||(e[28]=t("div",{class:"md:hidden flex font-medium"},"পিতার নাম:",-1)),u(t("input",{"onUpdate:modelValue":i=>s.father_name=i,required:"",type:"text",class:"input-1",placeholder:"বাংলায়"},null,8,Te),[[y,s.father_name]]),u(t("input",{"onUpdate:modelValue":i=>s.father_name_arabic=i,dir:"rtl",type:"text",class:"input-1",placeholder:"العربية"},null,8,Xe),[[y,s.father_name_arabic]])]),t("div",He,[e[30]||(e[30]=t("p",{class:"md:hidden flex font-medium"},"জন্ম তারিখ (জন্ম নিবন্ধন অনুসারে)",-1)),t("div",Je,[s.date_of_birth?(n(),o("div",Qe,e[29]||(e[29]=[t("i",{class:"fa fa-check-circle text-green-500"},null,-1)]))):x("",!0),u(t("input",{"onUpdate:modelValue":i=>s.input_dob=i,required:"",type:"text",placeholder:"DD/MM/YYYY",class:"input-1 border-r-0 rounded-r-none text-center",onBlur:i=>I(s),onKeyup:oe(i=>I(s),["enter"])},null,40,We),[[y,s.input_dob]]),u(t("input",{onChange:i=>J(s),"onUpdate:modelValue":i=>s.date_of_birth=i,required:"",type:"date",class:"input-1 w-10 px-2 rounded-l-none"},null,40,Ze),[[y,s.date_of_birth]])])]),t("div",et,[e[32]||(e[32]=t("p",{class:"md:hidden flex font-medium"},"পারার বিববরণ (হিফজের ক্ষেত্রে)",-1)),u(t("select",{"onUpdate:modelValue":i=>s.para=i,class:"input-1",disabled:!l.value.zamat_id},[e[31]||(e[31]=t("option",{value:"",disabled:""},"পারা নির্বাচন করুন",-1)),(n(!0),o(v,null,b(m(q).paraGroups,i=>(n(),o("option",{key:i.id,value:i.id},r(i.name),9,st))),128))],8,tt),[[V,s.para]])]),t("div",at,[e[33]||(e[33]=t("p",{class:"md:hidden flex font-medium"},"ঠিকানা (গ্রাম, ডাকঘর, থানা, জেলা)",-1)),u(t("input",{"onUpdate:modelValue":i=>s.address=i,type:"text",class:"input-1",placeholder:"গ্রাম, ডাকঘর, থানা, জেলা"},null,8,lt),[[y,s.address]])]),t("div",it,[t("button",{type:"button",onClick:i=>K(p),class:"btn-4 py-2"},e[34]||(e[34]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,ot)])])]))),128)),t("div",{class:"flex justify-center"},[t("button",{type:"button",onClick:Y,class:"btn-contrast"},e[35]||(e[35]=[t("i",{class:"fas fa-plus"},null,-1),_(" আরেকজন যুক্ত করুন ")]))])]),e[43]||(e[43]=t("hr",{class:"my-4"},null,-1)),M.value?(n(),o("div",nt,[t("div",dt,[t("div",null," প্রতি পরীক্ষার্থীর ফি: "+r(m(d).exam.registration_fee)+" টাকা। বিলম্ব ফি (প্রযোজ্য ক্ষেত্রে): "+r(m(d).exam.late_fee)+" টাকা। ",1),t("div",rt,[e[37]||(e[37]=_(" পরীক্ষার্থীর সংখ্যা:")),t("b",null,r(l.value.students.length),1),e[38]||(e[38]=_(" X ")),t("b",null,r(M.value),1),e[39]||(e[39]=_(" টাকা = ")),t("b",null,r(l.value.students.length*M.value)+" টাকা",1)])]),x("",!0),t("button",{type:"submit",disabled:z.value,class:"btn-2"},r(z.value?"সাবমিট হচ্ছে...":"সাবমিট করুন"),9,ut)])):x("",!0),t("div",pt,[D.value?(n(),o("div",ct,r(D.value),1)):x("",!0),S.value?(n(),o("div",mt,r(S.value),1)):x("",!0)])],32)]),t("div",_t,[ae(c,{to:{name:"PublicFunctions"},class:"btn-3"},{default:le(()=>e[44]||(e[44]=[_("পিছনে যান")])),_:1})])])}}};export{Ct as default};
