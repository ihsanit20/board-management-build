import{r as _,o as $,B as E,c as n,a as t,m as d,C as V,F as p,e as m,b as Q,f as L,w as N,l as B,y as M,d as i,t as h,v,D as T,h as j,z as q}from"./index-ClzD5fxD.js";import{u as K}from"./quran-question-BJoWhsxY.js";import{u as F}from"./zamat-C_kT7V8z.js";import{u as R}from"./center-C1Nc80_d.js";const A={class:"my-container space-y-4"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},G=["label"],H=["value"],J=["disabled"],O=["value"],P={class:"space-y-2 w-full"},W={class:"font-bold"},X={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Y=["onUpdate:modelValue"],I={class:"relative"},ee=["onUpdate:modelValue","onKeyup"],te=["onClick"],se=["onUpdate:modelValue"],ae=["onUpdate:modelValue"],oe=["onClick"],re={class:"mt-4 flex gap-4 justify-between"},ce={__name:"QuranQuestionAdd",setup(le){const f=R(),y=F(),C=K(),b=_(!1),S=_("");$(async()=>{try{b.value=!0,await y.fetchZamats()}catch(l){S.value="ডাটা লোড করতে সমস্যা হয়েছে।",console.error(l)}finally{b.value=!1}});const r=_({center_id:"",zamat_id:"",questions:[{id:Date.now(),surah:"",verses:"",text:"",page:""}]});E(()=>r.value.zamat_id,async l=>{if(!l){r.value.center_id="",f.centers=[];return}try{await f.fetchCenters({zamat_id:l})}catch(s){console.error("Error fetching centers:",s),alert("সেন্টার লোড করতে সমস্যা হয়েছে।")}});const U=()=>{r.value.questions.push({id:Date.now(),surah:"",verses:"",text:"",page:""})},z=l=>{r.value.questions.splice(l,1)},D=async()=>{try{await C.createQuestion(r.value),alert("কুরআন প্রশ্ন সফলভাবে যোগ করা হয়েছে!"),r.value={center_id:"",zamat_id:"",questions:[{id:Date.now(),surah:"",verses:"",text:"",page:""}]}}catch(l){console.error("Error adding Quran question:",l)}},g=async(l,s)=>{try{const{surah:u,verses:e}=l;if(!u||!e){alert("সুরা এবং আয়াত নম্বর সঠিকভাবে দিন।");return}const[a,o]=e.split("-").map(Number);if(!a||!o||a>o){alert("আয়াত নম্বর সঠিকভাবে দিন।");return}let x="";for(let c=a;c<=o;c++){const w=await fetch(`https://api.quran.com/api/v4/verses/by_key/${u}:${c}?fields=text_uthmani`);if(!w.ok)throw new Error("কুরআন ডেটা ফেচ করতে সমস্যা হয়েছে।");const k=await w.json();k.verse?x+=`${k.verse.text_uthmani} - `:alert(`সুরা ${u} এবং আয়াত ${c} পাওয়া যায়নি।`)}r.value.questions[s].text=x.trimEnd(" - ")}catch(u){console.error("Error fetching Quran text:",u),alert("কুরআন টেক্সট লোড করতে সমস্যা হয়েছে।")}};return(l,s)=>{const u=M("RouterLink");return i(),n("div",A,[s[9]||(s[9]=t("div",null,[t("h1",{class:"title-lg"},"কুরআন প্রশ্ন যোগ করুন")],-1)),t("form",{onSubmit:B(D,["prevent"]),class:"card-bg md:p-8 p-4"},[t("div",Z,[t("div",null,[d(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>r.value.zamat_id=e),class:"input-1",required:""},[s[2]||(s[2]=t("option",{value:"",disabled:""},"-মারহালা সিলেক্ট করুন-",-1)),(i(!0),n(p,null,m(Q(y).departments,e=>(i(),n("optgroup",{label:e.name,key:e.id},[(i(!0),n(p,null,m(e.zamats,a=>(i(),n("option",{key:a.id,value:a.id},h(a.name),9,H))),128))],8,G))),128))],512),[[V,r.value.zamat_id]])]),t("div",null,[d(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>r.value.center_id=e),class:"input-1",disabled:!r.value.zamat_id,required:""},[s[3]||(s[3]=t("option",{value:"",disabled:""},"-মারকাজ নির্বাচন করুন-",-1)),(i(!0),n(p,null,m(Q(f).centers,e=>{var a;return i(),n("option",{key:e.id,value:e==null?void 0:e.institute_id},h((a=e==null?void 0:e.institute)==null?void 0:a.name),9,O)}),128))],8,J),[[V,r.value.center_id]])])]),s[8]||(s[8]=t("h2",{class:"title-md text-center"},"প্রশ্নসমূহ",-1)),(i(!0),n(p,null,m(r.value.questions,(e,a)=>(i(),n("div",{key:e.id,class:"flex items-center gap-2 border p-4 rounded-md space-y-2 w-full"},[t("div",P,[t("p",W,h(Number(a+1).toLocaleString("bn-BD"))+" নং প্রশ্ন:",1),t("div",X,[t("div",null,[d(t("input",{"onUpdate:modelValue":o=>e.surah=o,type:"number",placeholder:"সুরা নম্বর",class:"input-1",required:""},null,8,Y),[[v,e.surah]])]),t("div",I,[d(t("input",{"onUpdate:modelValue":o=>e.verses=o,type:"text",class:"input-1",placeholder:"আয়াত (উদাহরণ: 1-5)",onKeyup:T(o=>g(e,a),["enter"])},null,40,ee),[[v,e.verses]]),e.verses?(i(),n("button",{key:0,onClick:o=>g(e,a),class:"absolute right-3 top-2.5"},s[4]||(s[4]=[t("i",{class:"fas fa-search"},null,-1)]),8,te)):j("",!0)]),t("div",null,[d(t("input",{"onUpdate:modelValue":o=>e.page=o,type:"number",placeholder:"পৃষ্ঠা নম্বর",class:"input-1",required:""},null,8,se),[[v,e.page]])])]),t("div",null,[d(t("textarea",{"onUpdate:modelValue":o=>e.text=o,placeholder:"কুরআনের টেক্সট",class:"input-1 text-right",required:""},null,8,ae),[[v,e.text]])])]),t("button",{type:"button",onClick:o=>z(a),class:"btn-icon"},s[5]||(s[5]=[t("i",{class:"fas fa-trash-alt text-red-600"},null,-1)]),8,oe)]))),128)),t("div",{class:"flex justify-center"},[t("button",{type:"button",onClick:U,class:"btn-4"},"আরও প্রশ্ন যোগ করুন")]),t("div",re,[L(u,{to:{name:"QuranQuestionList"},type:"submit",class:"btn-contrast"},{default:N(()=>s[6]||(s[6]=[q("পিছনে যান")])),_:1}),s[7]||(s[7]=t("button",{type:"submit",class:"btn-2"},"সংরক্ষণ করুন",-1))])],32)])}}};export{ce as default};
