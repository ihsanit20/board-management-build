import{A as j,r as i,o as E,B as I,i as Z,c as n,a as t,t as l,b as r,m as B,C as K,F as _,e as D,v as T,D as U,z as o,h as p,x as W,j as q,f as A,w as P,p as $,y as G,d as a,L as H}from"./index-pGQr_bJm.js";import{u as J}from"./zamat-D4S9W2o9.js";import{u as O}from"./student-Biw9R0fs.js";import{u as Q}from"./fee-BdRLyLDn.js";const X={class:"my-container"},Y={class:"space-y-2 p-2"},ee={class:"card-bg p-4"},te={class:"title-lg text-center"},se={class:"grid md:grid-cols-3 gap-4"},le=["value"],ae={key:0,class:"flex justify-center items-center text-3xl text-green-600 py-8"},ne={key:1,class:"flex justify-center items-center text-3xl text-red-500 py-8"},oe={key:1,class:"card-bg p-4"},de={class:"title-md"},ie={key:3,class:"space-y-2"},re={key:0,class:"space-y-2"},ue={class:"title-md"},ce=["onClick"],pe={class:"md:col-span-3 md:flex items-center gap-2 space-y-2 md:space-y-0"},me={class:""},ve={class:""},xe={class:"md:col-span-2"},fe={class:"md:col-span-1 md:px-2"},ye={class:"md:col-span-1 md:px-2 md:text-end"},be={class:"md:col-span-1 md:px-2 md:text-end"},_e={key:1,class:"card-bg py-6 items-center"},Le={__name:"StudentWithRoll",setup(ge){const f=j(),y=J(),b=O(),N=Q(),F=$(),g=i(!0),m=i(!1),x=i(""),u=i(""),c=i([]),k=i([]),v=i(null),h=i(!1),{success:S,error:w}=F.query;E(async()=>{try{m.value=!0,await Promise.all([f.fetchLastExam(),y.fetchZamats(),N.fetchFees()])}finally{m.value=!1}}),I(u,()=>{c.value=[],k.value=[]});const R=Z(()=>{var d;return((d=y.zamats.find(e=>e.id===u.value))==null?void 0:d.name)||""}),C=async()=>{if(!u.value||!x.value){alert("মারহালা সিলেক্ট করুন এবং ইলহাক নাম্বার দিয়ে অনুসন্ধান করুন।");return}m.value=!0,h.value=!0;try{await b.fetchStudentsWithRollNumber({instituteCode:x.value,zamatId:u.value}),g.value=!1,v.value=b.institute||null,c.value=b.students,k.value=c.value.map(d=>d.id)}catch(d){console.error("ডাটা ফেচ করতে সমস্যা হচ্ছে:",d)}finally{m.value=!1}};return(d,e)=>{var L,V;const z=G("RouterLink");return a(),n("div",X,[t("div",Y,[t("div",ee,[t("h1",te,l((L=r(f).exam)==null?void 0:L.name)+"-এর পরিক্ষার্থী অনুসন্ধান",1),t("div",se,[t("div",null,[B(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),class:"text-black input-1 px-2 py-1 text-center"},[e[2]||(e[2]=t("option",{value:"",selected:"",disabled:""},"- মারহালা সিলেক্ট করুন -",-1)),(a(!0),n(_,null,D(r(y).zamats,s=>(a(),n("option",{key:s.id,value:s.id},l(s.name),9,le))),128))],512),[[K,u.value]])]),t("div",null,[B(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>x.value=s),type:"text",class:"input-1 w-full text-black px-3 py-1 text-center",placeholder:"ইলহাক নং",onKeyup:U(C,["enter"])},null,544),[[T,x.value]])]),t("div",{class:"w-full"},[t("button",{onClick:C,class:"btn-2 w-full"},e[3]||(e[3]=[t("i",{class:"fas fa-search"},null,-1),o(" অনুসন্ধান ")]))])])]),g.value?(a(),n(_,{key:0},[r(S)?(a(),n("div",ae,l(r(S)),1)):p("",!0),r(w)?(a(),n("div",ne,l(r(w)),1)):p("",!0)],64)):p("",!0),v.value?(a(),n("div",oe,[t("h2",de,l(v.value.name),1),t("p",null,[e[4]||(e[4]=t("b",null,"ইলহাক:",-1)),o(" "+l(v.value.institute_code),1)]),t("p",null,[e[5]||(e[5]=t("b",null,"ফোন:",-1)),o(" "+l(v.value.phone),1)]),t("p",null,[e[6]||(e[6]=t("b",null,"মারহালা:",-1)),o(" "+l(R.value),1)])])):p("",!0),m.value?(a(),W(H,{key:2})):(a(),n("div",ie,[c.value.length?(a(),n("div",re,[t("h4",ue," পরীক্ষার্থী তালিকা: যারা "+l((V=r(f).exam)==null?void 0:V.name)+"-র ফি জমা দিয়েছে ",1),e[13]||(e[13]=q('<div class="bg-gray-400 text-white md:grid md:grid-cols-8 p-4 hidden rounded-md"><p class="md:col-span-3 px-2">পরীক্ষার্থীর নাম</p><p class="md:col-span-2 px-2">পিতার নাম</p><p class="md:col-span-1 px-2">জন্ম তারিখ</p><p class="md:col-span-1 px-2 md:text-end">রেজি. নং</p><p class="md:col-span-1 px-2 md:text-end">রোল নং</p></div>',1)),(a(!0),n(_,null,D(c.value,(s,M)=>(a(),n("div",{key:s.id,onClick:ke=>d.toggleSelection(s.id),class:"card-bg grid relative md:grid-cols-8 p-4"},[t("div",pe,[t("p",me,[e[7]||(e[7]=t("b",{class:"inline-block md:hidden"},"ক্র:",-1)),o(" "+l((M+1).toLocaleString("bn-BD"))+". ",1)]),t("p",ve,[e[8]||(e[8]=t("b",{class:"inline-block md:hidden"},"নাম:",-1)),o(" "+l(s.name),1)])]),t("p",xe,[e[9]||(e[9]=t("b",{class:"inline-block md:hidden"},"পিতা:",-1)),o(" "+l(s.father_name),1)]),t("p",fe,[e[10]||(e[10]=t("b",{class:"inline-block md:hidden"},"জন্ম তারিখ:",-1)),o(" "+l(new Date(s.date_of_birth).toLocaleDateString("bn-BD")),1)]),t("p",ye,[e[11]||(e[11]=t("b",{class:"inline-block md:hidden"},"রেজি. নং:",-1)),o(" "+l(s.registration_number),1)]),t("p",be,[e[12]||(e[12]=t("b",{class:"inline-block md:hidden"},"রেজি. নং:",-1)),o(" "+l(s.roll_number),1)])],8,ce))),128))])):p("",!0),h.value&&!c.value.length?(a(),n("div",_e,[e[15]||(e[15]=t("p",{class:"text-center text-red-500"},"ফি জমার কোন তথ্য পাওয়া যায়নি",-1)),A(z,{to:{name:"CollectFee"},class:"btn-link"},{default:P(()=>e[14]||(e[14]=[o("ফি জমা দিতে ক্লিক করুন")])),_:1})])):p("",!0)]))])])}}};export{Le as default};
