import{N as r,O as n}from"./index-CyA6YVnO.js";const c=r("application",{state:()=>({applications:[],zamatCounts:[],userCounts:[],application:null,loading:!1,error:null,showStatusModal:!1,totalApplications:0,pendingApplications:0,paidApplications:0,totalStudents:0,pagination:{current_page:1,last_page:1,per_page:15,total:0}}),actions:{async fetchApplications(s={}){var i,a;this.loading=!0;try{const t=await n.get("/applications",{params:s});this.applications=t.data.data||[],this.pagination={current_page:t.data.current_page||1,last_page:t.data.last_page||1,per_page:t.data.per_page||15,total:t.data.total||0},console.log("Pagination:",this.pagination)}catch(t){this.error=((a=(i=t.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to fetch applications",this.applications=[]}finally{this.loading=!1}},async fetchApplicationsPrint(s={}){var i,a;this.loading=!0;try{const t=await n.get("/applications/print",{params:s});this.applications=t.data,console.log(this.applications)}catch(t){this.error=((a=(i=t.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to fetch applications"}finally{this.loading=!1}},async fetchApplication(s,i={}){var a,t;this.loading=!0;try{const e=await n.get(`/applications/${s}`,{params:i});this.application=e.data}catch(e){this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to fetch application"}finally{this.loading=!1}},async fetchPublicApplication(s,i){var a,t;this.loading=!0,this.application=null;try{const e=await n.get("/applications/public-show",{params:{application_id:s,institute_code:i}});this.application=e.data}catch(e){this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to fetch public application"}finally{this.loading=!1}},async createApplication(s){var i,a;this.loading=!0;try{const t=await n.post("/applications",s);return this.applications.push(t.data.application),this.application=t.data.application,t.data.application}catch(t){throw this.error=((a=(i=t.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to create application",t}finally{this.loading=!1}},async updateApplication(s,i){var a,t;this.loading=!0;try{const e=await n.put(`/applications/${s}`,i),o=this.applications.findIndex(p=>p.id===s);o!==-1&&(this.applications[o]=e.data)}catch(e){this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to update application"}finally{this.loading=!1}},async deleteApplication(s){var i,a;this.loading=!0;try{await n.delete(`/applications/${s}`),this.applications=this.applications.filter(t=>t.id!==s)}catch(t){this.error=((a=(i=t.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to delete application"}finally{this.loading=!1}},async updatePaymentStatus(s,i){var a,t;this.loading=!0;try{const e=await n.put(`/applications/${s}/update-payment-status`,{payment_status:i}),o=this.applications.findIndex(p=>p.id===s);o!==-1&&(this.applications[o].payment_status=e.data.payment_status)}catch(e){this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to update payment status"}finally{this.loading=!1}},async bkashCreatePayment(s,i={}){var a,t;try{return(await n.post(`/applications/${s}/bkash-create-payment`,i)).data}catch(e){this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to create bkash payment"}},async bkashExecutePayment(s,i={}){var a,t;this.loading=!0;try{return await n.post(`/applications/${s}/bkash-execute-payment`,i)}catch(e){this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to execute bkash payment"}finally{this.loading=!1}},findApplicationById(s){return this.applications.find(i=>parseInt(i.id)===parseInt(s))},async fetchApplicationCounts(){var s,i;this.loading=!0;try{const a=await n.get("/application-counts");this.totalApplications=a.data.totalApplications,this.pendingApplications=a.data.pendingApplications,this.paidApplications=a.data.paidApplications,this.totalStudents=a.data.totalStudents}catch(a){this.error=((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to fetch application counts"}finally{this.loading=!1}},async fetchZamatWiseCounts(){var s,i;this.loading=!0,this.error=null;try{const a=await n.get("/applications/zamat-wise-counts");this.zamatCounts=a.data}catch(a){this.error=((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to fetch zamat-wise application counts"}finally{this.loading=!1}},async fetchUserWiseCounts(){var s,i;this.loading=!0;try{const a=await n.get("/applications/user-wise-counts");this.userCounts=a.data}catch(a){this.error=((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to fetch user-wise counts"}finally{this.loading=!1}},async updateRegistrationPart(s,i){var a,t;this.loading=!0;try{const e=await n.put(`/applications/${s}/update-registration`,i);return this.application=e.data.application,e.data.application}catch(e){throw this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to update registration information",e}finally{this.loading=!1}},async updateStudentsPart(s,i){var a,t;this.loading=!0;try{const e=await n.put(`/applications/${s}/update-students`,i);return this.application=e.data.application,e.data.application}catch(e){throw this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to update students information",e}finally{this.loading=!1}}}});export{c as u};
